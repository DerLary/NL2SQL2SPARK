{
    "llm": "google",
    "sparksql_query": "SELECT CAST((SUM(IF(c.Segment = 'SME' AND ym.Date LIKE '2013%', ym.Consumption, 0)) - SUM(IF(c.Segment = 'SME' AND ym.Date LIKE '2012%', ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = 'SME' AND ym.Date LIKE '2012%', ym.Consumption, 0)), 0) AS FLOAT) AS SME_Percentage_Increase, CAST((SUM(IF(c.Segment = 'LAM' AND ym.Date LIKE '2013%', ym.Consumption, 0)) - SUM(IF(c.Segment = 'LAM' AND ym.Date LIKE '2012%', ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = 'LAM' AND ym.Date LIKE '2012%', ym.Consumption, 0)), 0) AS FLOAT) AS LAM_Percentage_Increase, CAST((SUM(IF(c.Segment = 'KAM' AND ym.Date LIKE '2013%', ym.Consumption, 0)) - SUM(IF(c.Segment = 'KAM' AND ym.Date LIKE '2012%', ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = 'KAM' AND ym.Date LIKE '2012%', ym.Consumption, 0)), 0) AS FLOAT) AS KAM_Percentage_Increase FROM customers AS c JOIN yearmonth AS ym ON c.CustomerID = ym.CustomerID;",
    "query_id": 1482,
    "iteration": 1,
    "difficulty": "challenging",
    "execution_status": "VALID",
    "query_result": [
        [
            "545.4019165039062",
            "681.5824584960938",
            "708.1124267578125"
        ]
    ],
    "spark_error": null,
    "total_time": 58.15431094169617,
    "spark_time": 0.9052817821502686,
    "translation_time": 57.2490291595459,
    "llm_requests": 9,
    "chain_of_thought": [
        "Action: list_tables_sql_db\nAction Input: {}",
        "Observation: content='customers, gasstations, products, sqlite_sequence, transactions_1k, yearmonth' name='list_tables_sql_db' tool_call_id='07935d9b-ac3d-4506-bc9f-d47325704d90'",
        "Action: schema_sql_db\nAction Input: {'table_names': 'customers,yearmonth'}",
        "Observation: content='' name='schema_sql_db' tool_call_id='19920404-3eb6-46c6-9e29-3d9c070f9068'",
        "Action: schema_sql_db\nAction Input: {'table_names': 'customers'}",
        "Observation: content='CREATE TABLE customers (CustomerID int, Segment string, Currency string);' name='schema_sql_db' tool_call_id='d9c5dece-27e0-4796-b9f1-713c9b7f9e6e'",
        "Action: schema_sql_db\nAction Input: {'table_names': 'yearmonth'}",
        "Observation: content='CREATE TABLE yearmonth (CustomerID int, Date string, Consumption double);' name='schema_sql_db' tool_call_id='8825e1c7-63b9-46b0-91a8-27b7cad38961'",
        "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT CAST((SUM(IF(c.Segment = 'SME' AND ym.Date LIKE '2013%', ym.Consumption, 0)) - SUM(IF(c.Segment = 'SME' AND ym.Date LIKE '2012%', ym.Consumption, 0))) * 100.0 / SUM(IF(c.Segment = 'SME' AND ym.Date LIKE '2012%', ym.Consumption, 0)) AS FLOAT) AS SME_Percentage_Increase, CAST((SUM(IF(c.Segment = 'LAM' AND ym.Date LIKE '2013%', ym.Consumption, 0)) - SUM(IF(c.Segment = 'LAM' AND ym.Date LIKE '2012%', ym.Consumption, 0))) * 100.0 / SUM(IF(c.Segment = 'LAM' AND ym.Date LIKE '2012%', ym.Consumption, 0)) AS FLOAT) AS LAM_Percentage_Increase, CAST((SUM(IF(c.Segment = 'KAM' AND ym.Date LIKE '2013%', ym.Consumption, 0)) - SUM(IF(c.Segment = 'KAM' AND ym.Date LIKE '2012%', ym.Consumption, 0))) * 100.0 / SUM(IF(c.Segment = 'KAM' AND ym.Date LIKE '2012%', ym.Consumption, 0)) AS FLOAT) AS KAM_Percentage_Increase FROM customers AS c JOIN yearmonth AS ym ON c.CustomerID = ym.CustomerID;\"}",
        "Observation: content=\"The original query has a potential data type mismatch in predicates and a common logical flaw (division by zero) that should be addressed for robustness.\\n\\n1.  **Data type mismatch in predicates**: The predicate `ym.Date LIKE '2013%'` assumes `ym.Date` is a string type. If `ym.Date` is a `DATE` or `TIMESTAMP` type, using `LIKE` is a data type mismatch, even if Spark SQL might implicitly cast it to a string. The more robust and explicit way to filter by year for `DATE`/`TIMESTAMP` columns is to use the `YEAR()` function.\\n2.  **Division by Zero**: The query calculates a percentage increase. If the denominator (consumption in 2012 for a specific segment) is zero, the query will result in a division by zero error. This is a common mistake in such calculations. Using `NULLIF(denominator, 0)` can prevent this error by returning `NULL` instead of an error when the denominator is zero.\\n\\nLet's rewrite the query to address these points.\\n\\n```sql\\nSELECT\\n    CAST((SUM(IF(c.Segment = 'SME' AND YEAR(ym.Date) = 2013, ym.Consumption, 0)) - SUM(IF(c.Segment = 'SME' AND YEAR(ym.Date) = 2012, ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = 'SME' AND YEAR(ym.Date) = 2012, ym.Consumption, 0)), 0) AS FLOAT) AS SME_Percentage_Increase,\\n    CAST((SUM(IF(c.Segment = 'LAM' AND YEAR(ym.Date) = 2013, ym.Consumption, 0)) - SUM(IF(c.Segment = 'LAM' AND YEAR(ym.Date) = 2012, ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = 'LAM' AND YEAR(ym.Date) = 2012, ym.Consumption, 0)), 0) AS FLOAT) AS LAM_Percentage_Increase,\\n    CAST((SUM(IF(c.Segment = 'KAM' AND YEAR(ym.Date) = 2013, ym.Consumption, 0)) - SUM(IF(c.Segment = 'KAM' AND YEAR(ym.Date) = 2012, ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = 'KAM' AND YEAR(ym.Date) = 2012, ym.Consumption, 0)), 0) AS FLOAT) AS KAM_Percentage_Increase\\nFROM\\n    customers AS c\\nJOIN\\n    yearmonth AS ym ON c.CustomerID = ym.CustomerID;\\n```\" name='query_checker_sql_db' tool_call_id='81f8aed7-7bf6-43bf-a9c1-39d3af6eef7f'",
        "Action: query_checker_sql_db\nAction Input: {'query': \"SELECT CAST((SUM(IF(c.Segment = 'SME' AND ym.Date LIKE '2013%', ym.Consumption, 0)) - SUM(IF(c.Segment = 'SME' AND ym.Date LIKE '2012%', ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = 'SME' AND ym.Date LIKE '2012%', ym.Consumption, 0)), 0) AS FLOAT) AS SME_Percentage_Increase, CAST((SUM(IF(c.Segment = 'LAM' AND ym.Date LIKE '2013%', ym.Consumption, 0)) - SUM(IF(c.Segment = 'LAM' AND ym.Date LIKE '2012%', ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = 'LAM' AND ym.Date LIKE '2012%', ym.Consumption, 0)), 0) AS FLOAT) AS LAM_Percentage_Increase, CAST((SUM(IF(c.Segment = 'KAM' AND ym.Date LIKE '2013%', ym.Consumption, 0)) - SUM(IF(c.Segment = 'KAM' AND ym.Date LIKE '2012%', ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = 'KAM' AND ym.Date LIKE '2012%', ym.Consumption, 0)), 0) AS FLOAT) AS KAM_Percentage_Increase FROM customers AS c JOIN yearmonth AS ym ON c.CustomerID = ym.CustomerID;\"}",
        "Observation: content='The original query has a potential data type mismatch in its predicates regarding the `ym.Date` column. If `ym.Date` is a `DATE` or `TIMESTAMP` type, using `LIKE \\'YYYY%\\'` implicitly casts the date to a string, which can be less efficient or robust than using a dedicated date function. A more explicit and recommended approach for filtering by year on a `DATE` or `TIMESTAMP` column is to use the `YEAR()` function.\\n\\nAdditionally, the instruction \"Use ` for the in-query strings\" is non-standard. In SQL, single quotes (`\\'`) are used for string literals, while backticks (`` ` ``) are used for quoting identifiers (table names, column names) that might be reserved keywords or contain special characters. The original query correctly uses single quotes for string literals. Assuming this instruction meant \"properly quote identifiers if necessary\" or \"properly quote string literals with single quotes\", the original query\\'s use of single quotes for string literals is correct. I will not change the string literal quoting.\\n\\nThe corrected query replaces `ym.Date LIKE \\'YYYY%\\'` with `YEAR(ym.Date) = YYYY` for better handling of date/timestamp types.\\n\\n```sql\\nSELECT\\n    CAST((SUM(IF(c.Segment = \\'SME\\' AND YEAR(ym.Date) = 2013, ym.Consumption, 0)) - SUM(IF(c.Segment = \\'SME\\' AND YEAR(ym.Date) = 2012, ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = \\'SME\\' AND YEAR(ym.Date) = 2012, ym.Consumption, 0)), 0) AS FLOAT) AS SME_Percentage_Increase,\\n    CAST((SUM(IF(c.Segment = \\'LAM\\' AND YEAR(ym.Date) = 2013, ym.Consumption, 0)) - SUM(IF(c.Segment = \\'LAM\\' AND YEAR(ym.Date) = 2012, ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = \\'LAM\\' AND YEAR(ym.Date) = 2012, ym.Consumption, 0)), 0) AS FLOAT) AS LAM_Percentage_Increase,\\n    CAST((SUM(IF(c.Segment = \\'KAM\\' AND YEAR(ym.Date) = 2013, ym.Consumption, 0)) - SUM(IF(c.Segment = \\'KAM\\' AND YEAR(ym.Date) = 2012, ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = \\'KAM\\' AND YEAR(ym.Date) = 2012, ym.Consumption, 0)), 0) AS FLOAT) AS KAM_Percentage_Increase\\nFROM\\n    customers AS c\\nJOIN\\n    yearmonth AS ym ON c.CustomerID = ym.CustomerID;\\n```' name='query_checker_sql_db' tool_call_id='03a8b6df-2ddc-4060-87f8-978784709121'",
        "Action: query_sql_db\nAction Input: {'query': \"SELECT CAST((SUM(IF(c.Segment = 'SME' AND ym.Date LIKE '2013%', ym.Consumption, 0)) - SUM(IF(c.Segment = 'SME' AND ym.Date LIKE '2012%', ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = 'SME' AND ym.Date LIKE '2012%', ym.Consumption, 0)), 0) AS FLOAT) AS SME_Percentage_Increase, CAST((SUM(IF(c.Segment = 'LAM' AND ym.Date LIKE '2013%', ym.Consumption, 0)) - SUM(IF(c.Segment = 'LAM' AND ym.Date LIKE '2012%', ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = 'LAM' AND ym.Date LIKE '2012%', ym.Consumption, 0)), 0) AS FLOAT) AS LAM_Percentage_Increase, CAST((SUM(IF(c.Segment = 'KAM' AND ym.Date LIKE '2013%', ym.Consumption, 0)) - SUM(IF(c.Segment = 'KAM' AND ym.Date LIKE '2012%', ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = 'KAM' AND ym.Date LIKE '2012%', ym.Consumption, 0)), 0) AS FLOAT) AS KAM_Percentage_Increase FROM customers AS c JOIN yearmonth AS ym ON c.CustomerID = ym.CustomerID;\"}"
    ],
    "input_tokens": 10014,
    "output_tokens": 12141,
    "cloudflare_neurons": null,
    "prompt": "System: You are an agent designed to interact with Spark SQL.\nGiven an input question, create a syntactically correct Spark SQL query to run, then look at the results of the query and return the answer.\nDon't limit the result size.\nYou can order the results by a relevant column to return the most interesting examples in the database.\nNever query for all the columns from a specific table, only ask for the relevant columns given the question.\nYou have access to tools for interacting with the database.\nOnly use the below tools. Only use the information returned by the below tools to construct your final answer.\nYou MUST double check your query before executing it. If you get an error while executing a query, rewrite the query and try again.\n\nDO NOT make any DML statements (INSERT, UPDATE, DELETE, DROP etc.) to the database.\n\nIf the question does not seem related to the database, just return \"I don't know\" as the answer.\n\nHuman: Compute the percentage increase of the three segments SME, LAM and KAM in consumption between 2012 and 2013? Increase or Decrease = consumption for 2013 - consumption for 2012; Percentage of Increase = (Increase or Decrease / consumption for 2012) * 100%; The first 4 strings of the Date values in the yearmonth table can represent year. Return exactly one row with three columns: percentage increase for SME, for LAM, and for KAM (in this order). Use customers joined with yearmonth on CustomerID; Do not use subqueries or CTEs. Use one single SELECT with three conditional aggregations using SUM(IF(...)) and Date LIKE '2012%' / '2013%'. Return only the three percentage columns in the order SME, LAM, KAM. Do not use backticks. Cast the percentage as float.\n\n\nAI: [{'name': 'list_tables_sql_db', 'args': {}, 'id': '07935d9b-ac3d-4506-bc9f-d47325704d90', 'type': 'tool_call'}]\nTool: customers, gasstations, products, sqlite_sequence, transactions_1k, yearmonth\nAI: [{'name': 'schema_sql_db', 'args': {'table_names': 'customers,yearmonth'}, 'id': '19920404-3eb6-46c6-9e29-3d9c070f9068', 'type': 'tool_call'}]\nTool: \nAI: [{'name': 'schema_sql_db', 'args': {'table_names': 'customers'}, 'id': 'd9c5dece-27e0-4796-b9f1-713c9b7f9e6e', 'type': 'tool_call'}]\nTool: CREATE TABLE customers (CustomerID int, Segment string, Currency string);\nAI: [{'name': 'schema_sql_db', 'args': {'table_names': 'yearmonth'}, 'id': '8825e1c7-63b9-46b0-91a8-27b7cad38961', 'type': 'tool_call'}]\nTool: CREATE TABLE yearmonth (CustomerID int, Date string, Consumption double);\nAI: [{'name': 'query_checker_sql_db', 'args': {'query': \"SELECT CAST((SUM(IF(c.Segment = 'SME' AND ym.Date LIKE '2013%', ym.Consumption, 0)) - SUM(IF(c.Segment = 'SME' AND ym.Date LIKE '2012%', ym.Consumption, 0))) * 100.0 / SUM(IF(c.Segment = 'SME' AND ym.Date LIKE '2012%', ym.Consumption, 0)) AS FLOAT) AS SME_Percentage_Increase, CAST((SUM(IF(c.Segment = 'LAM' AND ym.Date LIKE '2013%', ym.Consumption, 0)) - SUM(IF(c.Segment = 'LAM' AND ym.Date LIKE '2012%', ym.Consumption, 0))) * 100.0 / SUM(IF(c.Segment = 'LAM' AND ym.Date LIKE '2012%', ym.Consumption, 0)) AS FLOAT) AS LAM_Percentage_Increase, CAST((SUM(IF(c.Segment = 'KAM' AND ym.Date LIKE '2013%', ym.Consumption, 0)) - SUM(IF(c.Segment = 'KAM' AND ym.Date LIKE '2012%', ym.Consumption, 0))) * 100.0 / SUM(IF(c.Segment = 'KAM' AND ym.Date LIKE '2012%', ym.Consumption, 0)) AS FLOAT) AS KAM_Percentage_Increase FROM customers AS c JOIN yearmonth AS ym ON c.CustomerID = ym.CustomerID;\"}, 'id': '81f8aed7-7bf6-43bf-a9c1-39d3af6eef7f', 'type': 'tool_call'}]\nTool: The original query has a potential data type mismatch in predicates and a common logical flaw (division by zero) that should be addressed for robustness.\n\n1.  **Data type mismatch in predicates**: The predicate `ym.Date LIKE '2013%'` assumes `ym.Date` is a string type. If `ym.Date` is a `DATE` or `TIMESTAMP` type, using `LIKE` is a data type mismatch, even if Spark SQL might implicitly cast it to a string. The more robust and explicit way to filter by year for `DATE`/`TIMESTAMP` columns is to use the `YEAR()` function.\n2.  **Division by Zero**: The query calculates a percentage increase. If the denominator (consumption in 2012 for a specific segment) is zero, the query will result in a division by zero error. This is a common mistake in such calculations. Using `NULLIF(denominator, 0)` can prevent this error by returning `NULL` instead of an error when the denominator is zero.\n\nLet's rewrite the query to address these points.\n\n```sql\nSELECT\n    CAST((SUM(IF(c.Segment = 'SME' AND YEAR(ym.Date) = 2013, ym.Consumption, 0)) - SUM(IF(c.Segment = 'SME' AND YEAR(ym.Date) = 2012, ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = 'SME' AND YEAR(ym.Date) = 2012, ym.Consumption, 0)), 0) AS FLOAT) AS SME_Percentage_Increase,\n    CAST((SUM(IF(c.Segment = 'LAM' AND YEAR(ym.Date) = 2013, ym.Consumption, 0)) - SUM(IF(c.Segment = 'LAM' AND YEAR(ym.Date) = 2012, ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = 'LAM' AND YEAR(ym.Date) = 2012, ym.Consumption, 0)), 0) AS FLOAT) AS LAM_Percentage_Increase,\n    CAST((SUM(IF(c.Segment = 'KAM' AND YEAR(ym.Date) = 2013, ym.Consumption, 0)) - SUM(IF(c.Segment = 'KAM' AND YEAR(ym.Date) = 2012, ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = 'KAM' AND YEAR(ym.Date) = 2012, ym.Consumption, 0)), 0) AS FLOAT) AS KAM_Percentage_Increase\nFROM\n    customers AS c\nJOIN\n    yearmonth AS ym ON c.CustomerID = ym.CustomerID;\n```\nAI: [{'name': 'query_checker_sql_db', 'args': {'query': \"SELECT CAST((SUM(IF(c.Segment = 'SME' AND ym.Date LIKE '2013%', ym.Consumption, 0)) - SUM(IF(c.Segment = 'SME' AND ym.Date LIKE '2012%', ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = 'SME' AND ym.Date LIKE '2012%', ym.Consumption, 0)), 0) AS FLOAT) AS SME_Percentage_Increase, CAST((SUM(IF(c.Segment = 'LAM' AND ym.Date LIKE '2013%', ym.Consumption, 0)) - SUM(IF(c.Segment = 'LAM' AND ym.Date LIKE '2012%', ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = 'LAM' AND ym.Date LIKE '2012%', ym.Consumption, 0)), 0) AS FLOAT) AS LAM_Percentage_Increase, CAST((SUM(IF(c.Segment = 'KAM' AND ym.Date LIKE '2013%', ym.Consumption, 0)) - SUM(IF(c.Segment = 'KAM' AND ym.Date LIKE '2012%', ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = 'KAM' AND ym.Date LIKE '2012%', ym.Consumption, 0)), 0) AS FLOAT) AS KAM_Percentage_Increase FROM customers AS c JOIN yearmonth AS ym ON c.CustomerID = ym.CustomerID;\"}, 'id': '03a8b6df-2ddc-4060-87f8-978784709121', 'type': 'tool_call'}]\nTool: The original query has a potential data type mismatch in its predicates regarding the `ym.Date` column. If `ym.Date` is a `DATE` or `TIMESTAMP` type, using `LIKE 'YYYY%'` implicitly casts the date to a string, which can be less efficient or robust than using a dedicated date function. A more explicit and recommended approach for filtering by year on a `DATE` or `TIMESTAMP` column is to use the `YEAR()` function.\n\nAdditionally, the instruction \"Use ` for the in-query strings\" is non-standard. In SQL, single quotes (`'`) are used for string literals, while backticks (`` ` ``) are used for quoting identifiers (table names, column names) that might be reserved keywords or contain special characters. The original query correctly uses single quotes for string literals. Assuming this instruction meant \"properly quote identifiers if necessary\" or \"properly quote string literals with single quotes\", the original query's use of single quotes for string literals is correct. I will not change the string literal quoting.\n\nThe corrected query replaces `ym.Date LIKE 'YYYY%'` with `YEAR(ym.Date) = YYYY` for better handling of date/timestamp types.\n\n```sql\nSELECT\n    CAST((SUM(IF(c.Segment = 'SME' AND YEAR(ym.Date) = 2013, ym.Consumption, 0)) - SUM(IF(c.Segment = 'SME' AND YEAR(ym.Date) = 2012, ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = 'SME' AND YEAR(ym.Date) = 2012, ym.Consumption, 0)), 0) AS FLOAT) AS SME_Percentage_Increase,\n    CAST((SUM(IF(c.Segment = 'LAM' AND YEAR(ym.Date) = 2013, ym.Consumption, 0)) - SUM(IF(c.Segment = 'LAM' AND YEAR(ym.Date) = 2012, ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = 'LAM' AND YEAR(ym.Date) = 2012, ym.Consumption, 0)), 0) AS FLOAT) AS LAM_Percentage_Increase,\n    CAST((SUM(IF(c.Segment = 'KAM' AND YEAR(ym.Date) = 2013, ym.Consumption, 0)) - SUM(IF(c.Segment = 'KAM' AND YEAR(ym.Date) = 2012, ym.Consumption, 0))) * 100.0 / NULLIF(SUM(IF(c.Segment = 'KAM' AND YEAR(ym.Date) = 2012, ym.Consumption, 0)), 0) AS FLOAT) AS KAM_Percentage_Increase\nFROM\n    customers AS c\nJOIN\n    yearmonth AS ym ON c.CustomerID = ym.CustomerID;\n```",
    "final_answer": "",
    "used_hil_query": "Compute the percentage increase of the three segments SME, LAM and KAM in consumption between 2012 and 2013? Increase or Decrease = consumption for 2013 - consumption for 2012; Percentage of Increase = (Increase or Decrease / consumption for 2012) * 100%; The first 4 strings of the Date values in the yearmonth table can represent year. Return exactly one row with three columns: percentage increase for SME, for LAM, and for KAM (in this order). Use customers joined with yearmonth on CustomerID; Do not use subqueries or CTEs. Use one single SELECT with three conditional aggregations using SUM(IF(...)) and Date LIKE '2012%' / '2013%'. Return only the three percentage columns in the order SME, LAM, KAM. Do not use backticks. Cast the percentage as float.",
    "golden_query": "SELECT CAST((SUM(IF(T1.Segment = 'SME' AND T2.Date LIKE '2013%', T2.Consumption, 0)) - SUM(IF(T1.Segment = 'SME' AND T2.Date LIKE '2012%', T2.Consumption, 0))) AS FLOAT) * 100 / SUM(IF(T1.Segment = 'SME' AND T2.Date LIKE '2012%', T2.Consumption, 0)), CAST(SUM(IF(T1.Segment = 'LAM' AND T2.Date LIKE '2013%', T2.Consumption, 0)) - SUM(IF(T1.Segment = 'LAM' AND T2.Date LIKE '2012%', T2.Consumption, 0)) AS FLOAT) * 100 / SUM(IF(T1.Segment = 'LAM' AND T2.Date LIKE '2012%', T2.Consumption, 0)), CAST(SUM(IF(T1.Segment = 'KAM' AND T2.Date LIKE '2013%', T2.Consumption, 0)) - SUM(IF(T1.Segment = 'KAM' AND T2.Date LIKE '2012%', T2.Consumption, 0)) AS FLOAT) * 100 / SUM(IF(T1.Segment = 'KAM' AND T2.Date LIKE '2012%', T2.Consumption, 0)) FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID",
    "ground_truth": [
        {
            "((CAST((sum((IF(((Segment = SME) AND Date LIKE 2013%), Consumption, 0))) - sum((IF(((Segment = SME) AND Date LIKE 2012%), Consumption, 0)))) AS FLOAT) * 100) / sum((IF(((Segment = SME) AND Date LIKE 2012%), Consumption, 0))))": 545.4018808857362,
            "((CAST((sum((IF(((Segment = LAM) AND Date LIKE 2013%), Consumption, 0))) - sum((IF(((Segment = LAM) AND Date LIKE 2012%), Consumption, 0)))) AS FLOAT) * 100) / sum((IF(((Segment = LAM) AND Date LIKE 2012%), Consumption, 0))))": 681.5824507359694,
            "((CAST((sum((IF(((Segment = KAM) AND Date LIKE 2013%), Consumption, 0))) - sum((IF(((Segment = KAM) AND Date LIKE 2012%), Consumption, 0)))) AS FLOAT) * 100) / sum((IF(((Segment = KAM) AND Date LIKE 2012%), Consumption, 0))))": 708.1124296835188
        }
    ],
    "jaccard_index": 0.0,
    "exact_match": 0,
    "jaccard_index_new": 0.0
}