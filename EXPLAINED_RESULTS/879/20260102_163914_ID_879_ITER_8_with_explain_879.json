{
    "query_id": 879,
    "difficulty": "moderate",
    "is_initial": true,
    "nl_query": "For the driver who set the fastest lap speed, what is his nationality? the fastest lap speed refers to (MAX) fastestLapSpeed;",
    "golden_query": "SELECT T1.nationality FROM drivers AS T1 INNER JOIN results AS T2 ON T2.driverId = T1.driverId ORDER BY T2.fastestLapSpeed DESC LIMIT 1",
    "sparksql_query": "SELECT T2.nationality FROM results AS T1 INNER JOIN drivers AS T2 ON T1.driverId = T2.driverId ORDER BY CAST(T1.fastestLapSpeed AS DOUBLE) DESC LIMIT 1",
    "jaccard_index": 0.0,
    "exact_match": 0,
    "ground_truth": [
        {
            "nationality": "Italian"
        }
    ],
    "query_result": [
        [
            "Brazilian"
        ]
    ],
    "execution_plans": {
        "golden_query": "\nExecution Plan for: Golden Query ID 879...\n================================================================================\n\n1. Logical plan:\n----------------------------------------\n'GlobalLimit 1\n+- 'LocalLimit 1\n   +- 'Sort ['T2.fastestLapSpeed DESC NULLS LAST], true\n      +- 'Project ['T1.nationality]\n         +- 'Join Inner, ('T2.driverId = 'T1.driverId)\n            :- 'SubqueryAlias T1\n            :  +- 'UnresolvedRelation [drivers], [], false\n            +- 'SubqueryAlias T2\n               +- 'UnresolvedRelation [results], [], false\n\n\n2. Optimized logical plan (After Catalyst AFAIK):\n----------------------------------------\nGlobalLimit 1\n+- LocalLimit 1\n   +- Project [nationality#13355]\n      +- Sort [fastestLapSpeed#13426 DESC NULLS LAST], true\n         +- Project [nationality#13355, fastestLapSpeed#13426]\n            +- Join Inner, (driverId#13412 = driverId#13348)\n               :- Project [driverId#13348, nationality#13355]\n               :  +- Filter isnotnull(driverId#13348)\n               :     +- Relation [driverId#13348,driverRef#13349,number#13350,code#13351,forename#13352,surname#13353,dob#13354,nationality#13355,url#13356] JDBCRelation((SELECT \"driverId\", \"driverRef\", \"number\", \"code\", \"forename\", \"surname\", CAST(\"dob\" AS TEXT) AS \"dob\", \"nationality\", \"url\" FROM \"drivers\") AS \"drivers\") [numPartitions=1]\n               +- Project [driverId#13412, fastestLapSpeed#13426]\n                  +- Filter isnotnull(driverId#13412)\n                     +- Relation [resultId#13410,raceId#13411,driverId#13412,constructorId#13413,number#13414,grid#13415,position#13416,positionText#13417,positionOrder#13418,points#13419,laps#13420,time#13421,milliseconds#13422,fastestLap#13423,rank#13424,fastestLapTime#13425,fastestLapSpeed#13426,statusId#13427] JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1]\n\n\n3. Physical plan:\n----------------------------------------\nAdaptiveSparkPlan isFinalPlan=false\n+- TakeOrderedAndProject(limit=1, orderBy=[fastestLapSpeed#13426 DESC NULLS LAST], output=[nationality#13355])\n  +- Project [nationality#13355, fastestLapSpeed#13426]\n      +- SortMergeJoin [driverId#13348], [driverId#13412], Inner\n        :- Sort [driverId#13348 ASC NULLS FIRST], false, 0\n        :  +- Exchange hashpartitioning(driverId#13348, 200), ENSURE_REQUIREMENTS, [plan_id=31604]\n        :     +- Scan JDBCRelation((SELECT \"driverId\", \"driverRef\", \"number\", \"code\", \"forename\", \"surname\", CAST(\"dob\" AS TEXT) AS \"dob\", \"nationality\", \"url\" FROM \"drivers\") AS \"drivers\") [numPartitions=1] [driverId#13348,nationality#13355] PushedFilters: [*IsNotNull(driverId)], ReadSchema: struct<driverId:int,nationality:string>\n        +- Sort [driverId#13412 ASC NULLS FIRST], false, 0\n            +- Exchange hashpartitioning(driverId#13412, 200), ENSURE_REQUIREMENTS, [plan_id=31605]\n              +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [driverId#13412,fastestLapSpeed#13426] PushedFilters: [*IsNotNull(driverId)], ReadSchema: struct<driverId:int,fastestLapSpeed:string>\n\n4. Explain output:\n----------------------------------------\n\nPhysical Plan ==:\n-----------------\n  AdaptiveSparkPlan isFinalPlan=false\n  +- TakeOrderedAndProject(limit=1, orderBy=[fastestLapSpeed#13426 DESC NULLS LAST], output=[nationality#13355])\n  +- Project [nationality#13355, fastestLapSpeed#13426]\n  +- SortMergeJoin [driverId#13348], [driverId#13412], Inner\n  :- Sort [driverId#13348 ASC NULLS FIRST], false, 0\n  :  +- Exchange hashpartitioning(driverId#13348, 200), ENSURE_REQUIREMENTS, [plan_id=31634]\n  :     +- Scan JDBCRelation((SELECT \"driverId\", \"driverRef\", \"number\", \"code\", \"forename\", \"surname\", CAST(\"dob\" AS TEXT) AS \"dob\", \"nationality\", \"url\" FROM \"drivers\") AS \"drivers\") [numPartitions=1] [driverId#13348,nationality#13355] PushedFilters: [*IsNotNull(driverId)], ReadSchema: struct<driverId:int,nationality:string>\n  +- Sort [driverId#13412 ASC NULLS FIRST], false, 0\n  +- Exchange hashpartitioning(driverId#13412, 200), ENSURE_REQUIREMENTS, [plan_id=31635]\n  +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [driverId#13412,fastestLapSpeed#13426] PushedFilters: [*IsNotNull(driverId)], ReadSchema: struct<driverId:int,fastestLapSpeed:string>\n================================================================================",
        "model_query": "\nExecution Plan for: Model Query ID 879...\n================================================================================\n\n1. Logical plan:\n----------------------------------------\n'GlobalLimit 1\n+- 'LocalLimit 1\n   +- 'Sort [cast('T1.fastestLapSpeed as double) DESC NULLS LAST], true\n      +- 'Project ['T2.nationality]\n         +- 'Join Inner, ('T1.driverId = 'T2.driverId)\n            :- 'SubqueryAlias T1\n            :  +- 'UnresolvedRelation [results], [], false\n            +- 'SubqueryAlias T2\n               +- 'UnresolvedRelation [drivers], [], false\n\n\n2. Optimized logical plan (After Catalyst AFAIK):\n----------------------------------------\nGlobalLimit 1\n+- LocalLimit 1\n   +- Project [nationality#13355]\n      +- Sort [cast(fastestLapSpeed#13426 as double) DESC NULLS LAST], true\n         +- Project [nationality#13355, fastestLapSpeed#13426]\n            +- Join Inner, (driverId#13412 = driverId#13348)\n               :- Project [driverId#13412, fastestLapSpeed#13426]\n               :  +- Filter isnotnull(driverId#13412)\n               :     +- Relation [resultId#13410,raceId#13411,driverId#13412,constructorId#13413,number#13414,grid#13415,position#13416,positionText#13417,positionOrder#13418,points#13419,laps#13420,time#13421,milliseconds#13422,fastestLap#13423,rank#13424,fastestLapTime#13425,fastestLapSpeed#13426,statusId#13427] JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1]\n               +- Project [driverId#13348, nationality#13355]\n                  +- Filter isnotnull(driverId#13348)\n                     +- Relation [driverId#13348,driverRef#13349,number#13350,code#13351,forename#13352,surname#13353,dob#13354,nationality#13355,url#13356] JDBCRelation((SELECT \"driverId\", \"driverRef\", \"number\", \"code\", \"forename\", \"surname\", CAST(\"dob\" AS TEXT) AS \"dob\", \"nationality\", \"url\" FROM \"drivers\") AS \"drivers\") [numPartitions=1]\n\n\n3. Physical plan:\n----------------------------------------\nAdaptiveSparkPlan isFinalPlan=false\n+- TakeOrderedAndProject(limit=1, orderBy=[cast(fastestLapSpeed#13426 as double) DESC NULLS LAST], output=[nationality#13355])\n  +- Project [nationality#13355, fastestLapSpeed#13426]\n      +- SortMergeJoin [driverId#13412], [driverId#13348], Inner\n        :- Sort [driverId#13412 ASC NULLS FIRST], false, 0\n        :  +- Exchange hashpartitioning(driverId#13412, 200), ENSURE_REQUIREMENTS, [plan_id=31664]\n        :     +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [driverId#13412,fastestLapSpeed#13426] PushedFilters: [*IsNotNull(driverId)], ReadSchema: struct<driverId:int,fastestLapSpeed:string>\n        +- Sort [driverId#13348 ASC NULLS FIRST], false, 0\n            +- Exchange hashpartitioning(driverId#13348, 200), ENSURE_REQUIREMENTS, [plan_id=31665]\n              +- Scan JDBCRelation((SELECT \"driverId\", \"driverRef\", \"number\", \"code\", \"forename\", \"surname\", CAST(\"dob\" AS TEXT) AS \"dob\", \"nationality\", \"url\" FROM \"drivers\") AS \"drivers\") [numPartitions=1] [driverId#13348,nationality#13355] PushedFilters: [*IsNotNull(driverId)], ReadSchema: struct<driverId:int,nationality:string>\n\n4. Explain output:\n----------------------------------------\n\nPhysical Plan ==:\n-----------------\n  AdaptiveSparkPlan isFinalPlan=false\n  +- TakeOrderedAndProject(limit=1, orderBy=[cast(fastestLapSpeed#13426 as double) DESC NULLS LAST], output=[nationality#13355])\n  +- Project [nationality#13355, fastestLapSpeed#13426]\n  +- SortMergeJoin [driverId#13412], [driverId#13348], Inner\n  :- Sort [driverId#13412 ASC NULLS FIRST], false, 0\n  :  +- Exchange hashpartitioning(driverId#13412, 200), ENSURE_REQUIREMENTS, [plan_id=31694]\n  :     +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [driverId#13412,fastestLapSpeed#13426] PushedFilters: [*IsNotNull(driverId)], ReadSchema: struct<driverId:int,fastestLapSpeed:string>\n  +- Sort [driverId#13348 ASC NULLS FIRST], false, 0\n  +- Exchange hashpartitioning(driverId#13348, 200), ENSURE_REQUIREMENTS, [plan_id=31695]\n  +- Scan JDBCRelation((SELECT \"driverId\", \"driverRef\", \"number\", \"code\", \"forename\", \"surname\", CAST(\"dob\" AS TEXT) AS \"dob\", \"nationality\", \"url\" FROM \"drivers\") AS \"drivers\") [numPartitions=1] [driverId#13348,nationality#13355] PushedFilters: [*IsNotNull(driverId)], ReadSchema: struct<driverId:int,nationality:string>\n================================================================================"
    },
    "result_file_path": "/home/lars/Privat/RWTH/Auslandssemester/#KURSE/Safe Distributed Systems/Exercises/Practical_Exercise/NL2SQL2SPARK/RAW_RESULTS/benchmark_results_20260102_google_fbc1edf3/879/20260102_163914_ID_879_ITER_8_c6f3a415.json",
    "explainer_metrics": {
        "golden_query": {
            "shuffle_count": {
                "Exchange\\s+hashpartitioning\\(": 2,
                "Exchange\\s+rangepartitioning\\(": 0,
                "Exchange\\s+SinglePartition": 0,
                "ShuffleExchange": 0,
                "TOTAL": 2
            },
            "has_broadcast_join": false,
            "has_predicate_pushdown": true,
            "pushed_filters": [
                {
                    "scan_line": ":     +- Scan JDBCRelation((SELECT \"driverId\", \"driverRef\", \"number\", \"code\", \"forename\", \"surname\", CAST(\"dob\" AS TEXT) AS \"dob\", \"nationality\", \"url\" FROM \"drivers\") AS \"drivers\") [numPartitions=1] [driverId#13348,nationality#13355] PushedFilters: [*IsNotNull(driverId)], ReadSchema: struct<driverId:int,nationality:string>",
                    "filters": [
                        "*IsNotNull(driverId)"
                    ]
                },
                {
                    "scan_line": "+- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [driverId#13412,fastestLapSpeed#13426] PushedFilters: [*IsNotNull(driverId)], ReadSchema: struct<driverId:int,fastestLapSpeed:string>",
                    "filters": [
                        "*IsNotNull(driverId)"
                    ]
                },
                {
                    "scan_line": ":     +- Scan JDBCRelation((SELECT \"driverId\", \"driverRef\", \"number\", \"code\", \"forename\", \"surname\", CAST(\"dob\" AS TEXT) AS \"dob\", \"nationality\", \"url\" FROM \"drivers\") AS \"drivers\") [numPartitions=1] [driverId#13348,nationality#13355] PushedFilters: [*IsNotNull(driverId)], ReadSchema: struct<driverId:int,nationality:string>",
                    "filters": [
                        "*IsNotNull(driverId)"
                    ]
                },
                {
                    "scan_line": "+- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [driverId#13412,fastestLapSpeed#13426] PushedFilters: [*IsNotNull(driverId)], ReadSchema: struct<driverId:int,fastestLapSpeed:string>",
                    "filters": [
                        "*IsNotNull(driverId)"
                    ]
                }
            ],
            "filter_count_before_optimization": 0,
            "filter_count_after_optimization": 2
        },
        "model_query": {
            "shuffle_count": {
                "Exchange\\s+hashpartitioning\\(": 2,
                "Exchange\\s+rangepartitioning\\(": 0,
                "Exchange\\s+SinglePartition": 0,
                "ShuffleExchange": 0,
                "TOTAL": 2
            },
            "has_broadcast_join": false,
            "has_predicate_pushdown": true,
            "pushed_filters": [
                {
                    "scan_line": ":     +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [driverId#13412,fastestLapSpeed#13426] PushedFilters: [*IsNotNull(driverId)], ReadSchema: struct<driverId:int,fastestLapSpeed:string>",
                    "filters": [
                        "*IsNotNull(driverId)"
                    ]
                },
                {
                    "scan_line": "+- Scan JDBCRelation((SELECT \"driverId\", \"driverRef\", \"number\", \"code\", \"forename\", \"surname\", CAST(\"dob\" AS TEXT) AS \"dob\", \"nationality\", \"url\" FROM \"drivers\") AS \"drivers\") [numPartitions=1] [driverId#13348,nationality#13355] PushedFilters: [*IsNotNull(driverId)], ReadSchema: struct<driverId:int,nationality:string>",
                    "filters": [
                        "*IsNotNull(driverId)"
                    ]
                },
                {
                    "scan_line": ":     +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [driverId#13412,fastestLapSpeed#13426] PushedFilters: [*IsNotNull(driverId)], ReadSchema: struct<driverId:int,fastestLapSpeed:string>",
                    "filters": [
                        "*IsNotNull(driverId)"
                    ]
                },
                {
                    "scan_line": "+- Scan JDBCRelation((SELECT \"driverId\", \"driverRef\", \"number\", \"code\", \"forename\", \"surname\", CAST(\"dob\" AS TEXT) AS \"dob\", \"nationality\", \"url\" FROM \"drivers\") AS \"drivers\") [numPartitions=1] [driverId#13348,nationality#13355] PushedFilters: [*IsNotNull(driverId)], ReadSchema: struct<driverId:int,nationality:string>",
                    "filters": [
                        "*IsNotNull(driverId)"
                    ]
                }
            ],
            "filter_count_before_optimization": 0,
            "filter_count_after_optimization": 2
        },
        "plan_equivalence": {
            "golden_vs_model_physical_equivalent": false
        }
    }
}