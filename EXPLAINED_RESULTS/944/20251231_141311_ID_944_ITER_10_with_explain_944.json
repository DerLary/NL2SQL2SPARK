{
    "query_id": 944,
    "difficulty": "challenging",
    "is_initial": true,
    "nl_query": "How much faster in percentage is the champion than the driver who finished the race last in the 2008 Australian Grand Prix? how much faster in percentage = divide(subtract(incremental time, champion time), last_driver time) * 100; last driver finished time = incremental time + champion time; only champion's finished time is represented by 'HH:MM:SS.mmm'; finished the game refers to time is not null",
    "golden_query": "WITH time_in_seconds AS (SELECT T1.positionOrder, CASE WHEN T1.positionOrder = 1 THEN (CAST(SUBSTRING(T1.time, 1, 1) AS FLOAT) * 3600) + (CAST(SUBSTRING(T1.time, 3, 2) AS FLOAT) * 60) + CAST(SUBSTRING(T1.time, 6) AS FLOAT) ELSE CAST(SUBSTRING(T1.time, 2) AS FLOAT) END AS time_seconds FROM results AS T1 INNER JOIN races AS T2 ON T1.raceId = T2.raceId WHERE T2.name = 'Australian Grand Prix' AND NOT T1.time IS NULL AND T2.year = 2008), champion_time AS (SELECT time_seconds FROM time_in_seconds WHERE positionOrder = 1), last_driver_incremental AS (SELECT time_seconds FROM time_in_seconds WHERE positionOrder = (SELECT MAX(positionOrder) FROM time_in_seconds)) SELECT (CAST((SELECT time_seconds FROM last_driver_incremental) AS FLOAT) * 100) / (SELECT time_seconds + (SELECT time_seconds FROM last_driver_incremental) FROM champion_time)",
    "sparksql_query": "SELECT (CAST(MAX(CASE WHEN T2.time IS NOT NULL THEN T2.milliseconds END) AS DOUBLE) - CAST(MAX(CASE WHEN T2.position = 1 THEN T2.milliseconds END) AS DOUBLE)) / CAST(MAX(CASE WHEN T2.time IS NOT NULL THEN T2.milliseconds END) AS DOUBLE) * 100 FROM races AS T1 INNER JOIN results AS T2 ON T1.raceId = T2.raceId WHERE T1.year = 2008 AND T1.name = 'Australian Grand Prix'",
    "jaccard_index": 0.0,
    "exact_match": 0,
    "ground_truth": [
        {
            "((CAST(scalarsubquery() AS FLOAT) * 100) / scalarsubquery())": 0.31555732173208506
        }
    ],
    "query_result": [
        [
            "0.31555732286030097"
        ]
    ],
    "execution_plans": {
        "golden_query": "\nExecution Plan for: Golden Query ID 944...\n================================================================================\n\n1. Logical plan:\n----------------------------------------\nCTE [time_in_seconds, champion_time, last_driver_incremental]\n:  :- 'SubqueryAlias time_in_seconds\n:  :  +- 'Project ['T1.positionOrder, CASE WHEN ('T1.positionOrder = 1) THEN (((cast('SUBSTRING('T1.time, 1, 1) as float) * 3600) + (cast('SUBSTRING('T1.time, 3, 2) as float) * 60)) + cast('SUBSTRING('T1.time, 6) as float)) ELSE cast('SUBSTRING('T1.time, 2) as float) END AS time_seconds#23095]\n:  :     +- 'Filter ((('T2.name = Australian Grand Prix) AND NOT isnull('T1.time)) AND ('T2.year = 2008))\n:  :        +- 'Join Inner, ('T1.raceId = 'T2.raceId)\n:  :           :- 'SubqueryAlias T1\n:  :           :  +- 'UnresolvedRelation [results], [], false\n:  :           +- 'SubqueryAlias T2\n:  :              +- 'UnresolvedRelation [races], [], false\n:  :- 'SubqueryAlias champion_time\n:  :  +- 'Project ['time_seconds]\n:  :     +- 'Filter ('positionOrder = 1)\n:  :        +- 'UnresolvedRelation [time_in_seconds], [], false\n:  +- 'SubqueryAlias last_driver_incremental\n:     +- 'Project ['time_seconds]\n:        +- 'Filter ('positionOrder = scalar-subquery#23096 [])\n:           :  +- 'Project [unresolvedalias('MAX('positionOrder))]\n:           :     +- 'UnresolvedRelation [time_in_seconds], [], false\n:           +- 'UnresolvedRelation [time_in_seconds], [], false\n+- 'Project [unresolvedalias(((cast(scalar-subquery#23092 [] as float) * 100) / scalar-subquery#23094 []))]\n   :  :- 'Project ['time_seconds]\n   :  :  +- 'UnresolvedRelation [last_driver_incremental], [], false\n   :  +- 'Project [unresolvedalias(('time_seconds + scalar-subquery#23093 []))]\n   :     :  +- 'Project ['time_seconds]\n   :     :     +- 'UnresolvedRelation [last_driver_incremental], [], false\n   :     +- 'UnresolvedRelation [champion_time], [], false\n   +- OneRowRelation\n\n\n2. Optimized logical plan (After Catalyst AFAIK):\n----------------------------------------\nProject [((cast(cast(scalar-subquery#23092 [] as float) as double) * 100.0) / scalar-subquery#23094 []) AS ((CAST(scalarsubquery() AS FLOAT) * 100) / scalarsubquery())#23107]\n:  :- Project [CASE WHEN (positionOrder#23455 = 1) THEN (((cast(cast(substring(time#23458, 1, 1) as float) as double) * 3600.0) + (cast(cast(substring(time#23458, 3, 2) as float) as double) * 60.0)) + cast(cast(substring(time#23458, 6, 2147483647) as float) as double)) ELSE cast(cast(substring(time#23458, 2, 2147483647) as float) as double) END AS time_seconds#23105]\n:  :  +- Join Inner, (raceId#23448 = raceId#23465)\n:  :     :- Project [raceId#23448, positionOrder#23455, time#23458]\n:  :     :  +- Filter ((isnotnull(positionOrder#23455) AND (isnotnull(time#23458) AND (positionOrder#23455 = scalar-subquery#23096 []))) AND isnotnull(raceId#23448))\n:  :     :     :  +- Aggregate [max(positionOrder#23398) AS max(positionOrder)#23419]\n:  :     :     :     +- Project [positionOrder#23398]\n:  :     :     :        +- Join Inner, (raceId#23391 = raceId#23408)\n:  :     :     :           :- Project [raceId#23391, positionOrder#23398]\n:  :     :     :           :  +- Filter (isnotnull(time#23401) AND isnotnull(raceId#23391))\n:  :     :     :           :     +- Relation [resultId#23390,raceId#23391,driverId#23392,constructorId#23393,number#23394,grid#23395,position#23396,positionText#23397,positionOrder#23398,points#23399,laps#23400,time#23401,milliseconds#23402,fastestLap#23403,rank#23404,fastestLapTime#23405,fastestLapSpeed#23406,statusId#23407] JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1]\n:  :     :     :           +- Project [raceId#23408]\n:  :     :     :              +- Filter (((isnotnull(name#23412) AND isnotnull(year#23409)) AND ((name#23412 = Australian Grand Prix) AND (year#23409 = 2008))) AND isnotnull(raceId#23408))\n:  :     :     :                 +- Relation [raceId#23408,year#23409,round#23410,circuitId#23411,name#23412,date#23413,time#23414,url#23415] JDBCRelation((SELECT \"raceId\", \"year\", \"round\", \"circuitId\", \"name\", CAST(\"date\" AS TEXT) AS \"date\", \"time\", \"url\" FROM \"races\") AS \"races\") [numPartitions=1]\n:  :     :     +- Relation [resultId#23447,raceId#23448,driverId#23449,constructorId#23450,number#23451,grid#23452,position#23453,positionText#23454,positionOrder#23455,points#23456,laps#23457,time#23458,milliseconds#23459,fastestLap#23460,rank#23461,fastestLapTime#23462,fastestLapSpeed#23463,statusId#23464] JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1]\n:  :     +- Project [raceId#23465]\n:  :        +- Filter (((isnotnull(name#23469) AND isnotnull(year#23466)) AND ((name#23469 = Australian Grand Prix) AND (year#23466 = 2008))) AND isnotnull(raceId#23465))\n:  :           +- Relation [raceId#23465,year#23466,round#23467,circuitId#23468,name#23469,date#23470,time#23471,url#23472] JDBCRelation((SELECT \"raceId\", \"year\", \"round\", \"circuitId\", \"name\", CAST(\"date\" AS TEXT) AS \"date\", \"time\", \"url\" FROM \"races\") AS \"races\") [numPartitions=1]\n:  +- Project [(CASE WHEN (positionOrder#23428 = 1) THEN (((cast(cast(substring(time#23431, 1, 1) as float) as double) * 3600.0) + (cast(cast(substring(time#23431, 3, 2) as float) as double) * 60.0)) + cast(cast(substring(time#23431, 6, 2147483647) as float) as double)) ELSE cast(cast(substring(time#23431, 2, 2147483647) as float) as double) END + scalar-subquery#23093 []) AS (time_seconds + scalarsubquery())#23106]\n:     :  +- Project [CASE WHEN (positionOrder#23455 = 1) THEN (((cast(cast(substring(time#23458, 1, 1) as float) as double) * 3600.0) + (cast(cast(substring(time#23458, 3, 2) as float) as double) * 60.0)) + cast(cast(substring(time#23458, 6, 2147483647) as float) as double)) ELSE cast(cast(substring(time#23458, 2, 2147483647) as float) as double) END AS time_seconds#23105]\n:     :     +- Join Inner, (raceId#23448 = raceId#23465)\n:     :        :- Project [raceId#23448, positionOrder#23455, time#23458]\n:     :        :  +- Filter ((isnotnull(positionOrder#23455) AND (isnotnull(time#23458) AND (positionOrder#23455 = scalar-subquery#23096 []))) AND isnotnull(raceId#23448))\n:     :        :     :  +- Aggregate [max(positionOrder#23398) AS max(positionOrder)#23419]\n:     :        :     :     +- Project [positionOrder#23398]\n:     :        :     :        +- Join Inner, (raceId#23391 = raceId#23408)\n:     :        :     :           :- Project [raceId#23391, positionOrder#23398]\n:     :        :     :           :  +- Filter (isnotnull(time#23401) AND isnotnull(raceId#23391))\n:     :        :     :           :     +- Relation [resultId#23390,raceId#23391,driverId#23392,constructorId#23393,number#23394,grid#23395,position#23396,positionText#23397,positionOrder#23398,points#23399,laps#23400,time#23401,milliseconds#23402,fastestLap#23403,rank#23404,fastestLapTime#23405,fastestLapSpeed#23406,statusId#23407] JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1]\n:     :        :     :           +- Project [raceId#23408]\n:     :        :     :              +- Filter (((isnotnull(name#23412) AND isnotnull(year#23409)) AND ((name#23412 = Australian Grand Prix) AND (year#23409 = 2008))) AND isnotnull(raceId#23408))\n:     :        :     :                 +- Relation [raceId#23408,year#23409,round#23410,circuitId#23411,name#23412,date#23413,time#23414,url#23415] JDBCRelation((SELECT \"raceId\", \"year\", \"round\", \"circuitId\", \"name\", CAST(\"date\" AS TEXT) AS \"date\", \"time\", \"url\" FROM \"races\") AS \"races\") [numPartitions=1]\n:     :        :     +- Relation [resultId#23447,raceId#23448,driverId#23449,constructorId#23450,number#23451,grid#23452,position#23453,positionText#23454,positionOrder#23455,points#23456,laps#23457,time#23458,milliseconds#23459,fastestLap#23460,rank#23461,fastestLapTime#23462,fastestLapSpeed#23463,statusId#23464] JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1]\n:     :        +- Project [raceId#23465]\n:     :           +- Filter (((isnotnull(name#23469) AND isnotnull(year#23466)) AND ((name#23469 = Australian Grand Prix) AND (year#23466 = 2008))) AND isnotnull(raceId#23465))\n:     :              +- Relation [raceId#23465,year#23466,round#23467,circuitId#23468,name#23469,date#23470,time#23471,url#23472] JDBCRelation((SELECT \"raceId\", \"year\", \"round\", \"circuitId\", \"name\", CAST(\"date\" AS TEXT) AS \"date\", \"time\", \"url\" FROM \"races\") AS \"races\") [numPartitions=1]\n:     +- Join Inner, (raceId#23421 = raceId#23438)\n:        :- Project [raceId#23421, positionOrder#23428, time#23431]\n:        :  +- Filter ((isnotnull(positionOrder#23428) AND (isnotnull(time#23431) AND (positionOrder#23428 = 1))) AND isnotnull(raceId#23421))\n:        :     +- Relation [resultId#23420,raceId#23421,driverId#23422,constructorId#23423,number#23424,grid#23425,position#23426,positionText#23427,positionOrder#23428,points#23429,laps#23430,time#23431,milliseconds#23432,fastestLap#23433,rank#23434,fastestLapTime#23435,fastestLapSpeed#23436,statusId#23437] JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1]\n:        +- Project [raceId#23438]\n:           +- Filter (((isnotnull(name#23442) AND isnotnull(year#23439)) AND ((name#23442 = Australian Grand Prix) AND (year#23439 = 2008))) AND isnotnull(raceId#23438))\n:              +- Relation [raceId#23438,year#23439,round#23440,circuitId#23441,name#23442,date#23443,time#23444,url#23445] JDBCRelation((SELECT \"raceId\", \"year\", \"round\", \"circuitId\", \"name\", CAST(\"date\" AS TEXT) AS \"date\", \"time\", \"url\" FROM \"races\") AS \"races\") [numPartitions=1]\n+- OneRowRelation\n\n\n3. Physical plan:\n----------------------------------------\nAdaptiveSparkPlan isFinalPlan=false\n+- Project [((cast(cast(Subquery subquery#23092, [id=#40415] as float) as double) * 100.0) / Subquery subquery#23094, [id=#40416]) AS ((CAST(scalarsubquery() AS FLOAT) * 100) / scalarsubquery())#23107]\n  :  :- Subquery subquery#23092, [id=#40415]\n  :  :  +- AdaptiveSparkPlan isFinalPlan=false\n  :  :     +- Project [CASE WHEN (positionOrder#23455 = 1) THEN (((cast(cast(substring(time#23458, 1, 1) as float) as double) * 3600.0) + (cast(cast(substring(time#23458, 3, 2) as float) as double) * 60.0)) + cast(cast(substring(time#23458, 6, 2147483647) as float) as double)) ELSE cast(cast(substring(time#23458, 2, 2147483647) as float) as double) END AS time_seconds#23105]\n  :  :        +- SortMergeJoin [raceId#23448], [raceId#23465], Inner\n  :  :           :- Sort [raceId#23448 ASC NULLS FIRST], false, 0\n  :  :           :  +- Exchange hashpartitioning(raceId#23448, 200), ENSURE_REQUIREMENTS, [plan_id=40298]\n  :  :           :     +- Filter (positionOrder#23455 = Subquery subquery#23096, [id=#40290])\n  :  :           :        :  +- Subquery subquery#23096, [id=#40290]\n  :  :           :        :     +- AdaptiveSparkPlan isFinalPlan=false\n  :  :           :        :        +- HashAggregate(keys=[], functions=[max(positionOrder#23398)], output=[max(positionOrder)#23419])\n  :  :           :        :           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=40288]\n  :  :           :        :              +- HashAggregate(keys=[], functions=[partial_max(positionOrder#23398)], output=[max#23507])\n  :  :           :        :                 +- Project [positionOrder#23398]\n  :  :           :        :                    +- SortMergeJoin [raceId#23391], [raceId#23408], Inner\n  :  :           :        :                       :- Sort [raceId#23391 ASC NULLS FIRST], false, 0\n  :  :           :        :                       :  +- Exchange hashpartitioning(raceId#23391, 200), ENSURE_REQUIREMENTS, [plan_id=40280]\n  :  :           :        :                       :     +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23391,positionOrder#23398] PushedFilters: [*IsNotNull(time), *IsNotNull(raceId)], ReadSchema: struct<raceId:int,positionOrder:int>\n  :  :           :        :                       +- Sort [raceId#23408 ASC NULLS FIRST], false, 0\n  :  :           :        :                          +- Exchange hashpartitioning(raceId#23408, 200), ENSURE_REQUIREMENTS, [plan_id=40281]\n  :  :           :        :                             +- Scan JDBCRelation((SELECT \"raceId\", \"year\", \"round\", \"circuitId\", \"name\", CAST(\"date\" AS TEXT) AS \"date\", \"time\", \"url\" FROM \"races\") AS \"races\") [numPartitions=1] [raceId#23408] PushedFilters: [*EqualTo(year,2008), *IsNotNull(year), *EqualTo(name,Australian Grand Prix), *IsNotNull(name), *..., ReadSchema: struct<raceId:int>\n  :  :           :        +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23448,positionOrder#23455,time#23458] PushedFilters: [*IsNotNull(positionOrder), *IsNotNull(time), *IsNotNull(raceId)], ReadSchema: struct<raceId:int,positionOrder:int,time:string>\n  :  :           +- Sort [raceId#23465 ASC NULLS FIRST], false, 0\n  :  :              +- Exchange hashpartitioning(raceId#23465, 200), ENSURE_REQUIREMENTS, [plan_id=40299]\n  :  :                 +- Scan JDBCRelation((SELECT \"raceId\", \"year\", \"round\", \"circuitId\", \"name\", CAST(\"date\" AS TEXT) AS \"date\", \"time\", \"url\" FROM \"races\") AS \"races\") [numPartitions=1] [raceId#23465] PushedFilters: [*EqualTo(year,2008), *IsNotNull(year), *EqualTo(name,Australian Grand Prix), *IsNotNull(name), *..., ReadSchema: struct<raceId:int>\n  :  +- Subquery subquery#23094, [id=#40416]\n  :     +- AdaptiveSparkPlan isFinalPlan=false\n  :        +- Project [(CASE WHEN (positionOrder#23428 = 1) THEN (((cast(cast(substring(time#23431, 1, 1) as float) as double) * 3600.0) + (cast(cast(substring(time#23431, 3, 2) as float) as double) * 60.0)) + cast(cast(substring(time#23431, 6, 2147483647) as float) as double)) ELSE cast(cast(substring(time#23431, 2, 2147483647) as float) as double) END + Subquery subquery#23093, [id=#40377]) AS (time_seconds + scalarsubquery())#23106]\n  :           :  +- Subquery subquery#23093, [id=#40377]\n  :           :     +- AdaptiveSparkPlan isFinalPlan=false\n  :           :        +- Project [CASE WHEN (positionOrder#23455 = 1) THEN (((cast(cast(substring(time#23458, 1, 1) as float) as double) * 3600.0) + (cast(cast(substring(time#23458, 3, 2) as float) as double) * 60.0)) + cast(cast(substring(time#23458, 6, 2147483647) as float) as double)) ELSE cast(cast(substring(time#23458, 2, 2147483647) as float) as double) END AS time_seconds#23105]\n  :           :           +- SortMergeJoin [raceId#23448], [raceId#23465], Inner\n  :           :              :- Sort [raceId#23448 ASC NULLS FIRST], false, 0\n  :           :              :  +- Exchange hashpartitioning(raceId#23448, 200), ENSURE_REQUIREMENTS, [plan_id=40371]\n  :           :              :     +- Filter (positionOrder#23455 = Subquery subquery#23096, [id=#40363])\n  :           :              :        :  +- Subquery subquery#23096, [id=#40363]\n  :           :              :        :     +- AdaptiveSparkPlan isFinalPlan=false\n  :           :              :        :        +- HashAggregate(keys=[], functions=[max(positionOrder#23398)], output=[max(positionOrder)#23419])\n  :           :              :        :           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=40361]\n  :           :              :        :              +- HashAggregate(keys=[], functions=[partial_max(positionOrder#23398)], output=[max#23507])\n  :           :              :        :                 +- Project [positionOrder#23398]\n  :           :              :        :                    +- SortMergeJoin [raceId#23391], [raceId#23408], Inner\n  :           :              :        :                       :- Sort [raceId#23391 ASC NULLS FIRST], false, 0\n  :           :              :        :                       :  +- Exchange hashpartitioning(raceId#23391, 200), ENSURE_REQUIREMENTS, [plan_id=40353]\n  :           :              :        :                       :     +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23391,positionOrder#23398] PushedFilters: [*IsNotNull(time), *IsNotNull(raceId)], ReadSchema: struct<raceId:int,positionOrder:int>\n  :           :              :        :                       +- Sort [raceId#23408 ASC NULLS FIRST], false, 0\n  :           :              :        :                          +- Exchange hashpartitioning(raceId#23408, 200), ENSURE_REQUIREMENTS, [plan_id=40354]\n  :           :              :        :                             +- Scan JDBCRelation((SELECT \"raceId\", \"year\", \"round\", \"circuitId\", \"name\", CAST(\"date\" AS TEXT) AS \"date\", \"time\", \"url\" FROM \"races\") AS \"races\") [numPartitions=1] [raceId#23408] PushedFilters: [*EqualTo(year,2008), *IsNotNull(year), *EqualTo(name,Australian Grand Prix), *IsNotNull(name), *..., ReadSchema: struct<raceId:int>\n  :           :              :        +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23448,positionOrder#23455,time#23458] PushedFilters: [*IsNotNull(positionOrder), *IsNotNull(time), *IsNotNull(raceId)], ReadSchema: struct<raceId:int,positionOrder:int,time:string>\n  :           :              +- Sort [raceId#23465 ASC NULLS FIRST], false, 0\n  :           :                 +- Exchange hashpartitioning(raceId#23465, 200), ENSURE_REQUIREMENTS, [plan_id=40372]\n  :           :                    +- Scan JDBCRelation((SELECT \"raceId\", \"year\", \"round\", \"circuitId\", \"name\", CAST(\"date\" AS TEXT) AS \"date\", \"time\", \"url\" FROM \"races\") AS \"races\") [numPartitions=1] [raceId#23465] PushedFilters: [*EqualTo(year,2008), *IsNotNull(year), *EqualTo(name,Australian Grand Prix), *IsNotNull(name), *..., ReadSchema: struct<raceId:int>\n  :           +- SortMergeJoin [raceId#23421], [raceId#23438], Inner\n  :              :- Sort [raceId#23421 ASC NULLS FIRST], false, 0\n  :              :  +- Exchange hashpartitioning(raceId#23421, 200), ENSURE_REQUIREMENTS, [plan_id=40383]\n  :              :     +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23421,positionOrder#23428,time#23431] PushedFilters: [*IsNotNull(positionOrder), *IsNotNull(time), *EqualTo(positionOrder,1), *IsNotNull(raceId)], ReadSchema: struct<raceId:int,positionOrder:int,time:string>\n  :              +- Sort [raceId#23438 ASC NULLS FIRST], false, 0\n  :                 +- Exchange hashpartitioning(raceId#23438, 200), ENSURE_REQUIREMENTS, [plan_id=40384]\n  :                    +- Scan JDBCRelation((SELECT \"raceId\", \"year\", \"round\", \"circuitId\", \"name\", CAST(\"date\" AS TEXT) AS \"date\", \"time\", \"url\" FROM \"races\") AS \"races\") [numPartitions=1] [raceId#23438] PushedFilters: [*EqualTo(year,2008), *IsNotNull(year), *EqualTo(name,Australian Grand Prix), *IsNotNull(name), *..., ReadSchema: struct<raceId:int>\n  +- Scan OneRowRelation[]\n\n4. Explain output:\n----------------------------------------\n\nPhysical Plan ==:\n-----------------\n  AdaptiveSparkPlan isFinalPlan=false\n  +- Project [((cast(cast(Subquery subquery#23514, [id=#40636] as float) as double) * 100.0) / Subquery subquery#23516, [id=#40637]) AS ((CAST(scalarsubquery() AS FLOAT) * 100) / scalarsubquery())#23533]\n  :  :- Subquery subquery#23514, [id=#40636]\n  :  :  +- AdaptiveSparkPlan isFinalPlan=false\n  :  :     +- Project [CASE WHEN (positionOrder#23881 = 1) THEN (((cast(cast(substring(time#23884, 1, 1) as float) as double) * 3600.0) + (cast(cast(substring(time#23884, 3, 2) as float) as double) * 60.0)) + cast(cast(substring(time#23884, 6, 2147483647) as float) as double)) ELSE cast(cast(substring(time#23884, 2, 2147483647) as float) as double) END AS time_seconds#23531]\n  :  :        +- SortMergeJoin [raceId#23874], [raceId#23891], Inner\n  :  :           :- Sort [raceId#23874 ASC NULLS FIRST], false, 0\n  :  :           :  +- Exchange hashpartitioning(raceId#23874, 200), ENSURE_REQUIREMENTS, [plan_id=40519]\n  :  :           :     +- Filter (positionOrder#23881 = Subquery subquery#23518, [id=#40511])\n  :  :           :        :  +- Subquery subquery#23518, [id=#40511]\n  :  :           :        :     +- AdaptiveSparkPlan isFinalPlan=false\n  :  :           :        :        +- HashAggregate(keys=[], functions=[max(positionOrder#23824)])\n  :  :           :        :           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=40509]\n  :  :           :        :              +- HashAggregate(keys=[], functions=[partial_max(positionOrder#23824)])\n  :  :           :        :                 +- Project [positionOrder#23824]\n  :  :           :        :                    +- SortMergeJoin [raceId#23817], [raceId#23834], Inner\n  :  :           :        :                       :- Sort [raceId#23817 ASC NULLS FIRST], false, 0\n  :  :           :        :                       :  +- Exchange hashpartitioning(raceId#23817, 200), ENSURE_REQUIREMENTS, [plan_id=40501]\n  :  :           :        :                       :     +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23817,positionOrder#23824] PushedFilters: [*IsNotNull(time), *IsNotNull(raceId)], ReadSchema: struct<raceId:int,positionOrder:int>\n  :  :           :        :                       +- Sort [raceId#23834 ASC NULLS FIRST], false, 0\n  :  :           :        :                          +- Exchange hashpartitioning(raceId#23834, 200), ENSURE_REQUIREMENTS, [plan_id=40502]\n  :  :           :        :                             +- Scan JDBCRelation((SELECT \"raceId\", \"year\", \"round\", \"circuitId\", \"name\", CAST(\"date\" AS TEXT) AS \"date\", \"time\", \"url\" FROM \"races\") AS \"races\") [numPartitions=1] [raceId#23834] PushedFilters: [*EqualTo(year,2008), *IsNotNull(year), *EqualTo(name,Australian Grand Prix), *IsNotNull(name), *..., ReadSchema: struct<raceId:int>\n  :  :           :        +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23874,positionOrder#23881,time#23884] PushedFilters: [*IsNotNull(positionOrder), *IsNotNull(time), *IsNotNull(raceId)], ReadSchema: struct<raceId:int,positionOrder:int,time:string>\n  :  :           +- Sort [raceId#23891 ASC NULLS FIRST], false, 0\n  :  :              +- Exchange hashpartitioning(raceId#23891, 200), ENSURE_REQUIREMENTS, [plan_id=40520]\n  :  :                 +- Scan JDBCRelation((SELECT \"raceId\", \"year\", \"round\", \"circuitId\", \"name\", CAST(\"date\" AS TEXT) AS \"date\", \"time\", \"url\" FROM \"races\") AS \"races\") [numPartitions=1] [raceId#23891] PushedFilters: [*EqualTo(year,2008), *IsNotNull(year), *EqualTo(name,Australian Grand Prix), *IsNotNull(name), *..., ReadSchema: struct<raceId:int>\n  :  +- Subquery subquery#23516, [id=#40637]\n  :     +- AdaptiveSparkPlan isFinalPlan=false\n  :        +- Project [(CASE WHEN (positionOrder#23854 = 1) THEN (((cast(cast(substring(time#23857, 1, 1) as float) as double) * 3600.0) + (cast(cast(substring(time#23857, 3, 2) as float) as double) * 60.0)) + cast(cast(substring(time#23857, 6, 2147483647) as float) as double)) ELSE cast(cast(substring(time#23857, 2, 2147483647) as float) as double) END + Subquery subquery#23515, [id=#40598]) AS (time_seconds + scalarsubquery())#23532]\n  :           :  +- Subquery subquery#23515, [id=#40598]\n  :           :     +- AdaptiveSparkPlan isFinalPlan=false\n  :           :        +- Project [CASE WHEN (positionOrder#23881 = 1) THEN (((cast(cast(substring(time#23884, 1, 1) as float) as double) * 3600.0) + (cast(cast(substring(time#23884, 3, 2) as float) as double) * 60.0)) + cast(cast(substring(time#23884, 6, 2147483647) as float) as double)) ELSE cast(cast(substring(time#23884, 2, 2147483647) as float) as double) END AS time_seconds#23531]\n  :           :           +- SortMergeJoin [raceId#23874], [raceId#23891], Inner\n  :           :              :- Sort [raceId#23874 ASC NULLS FIRST], false, 0\n  :           :              :  +- Exchange hashpartitioning(raceId#23874, 200), ENSURE_REQUIREMENTS, [plan_id=40592]\n  :           :              :     +- Filter (positionOrder#23881 = Subquery subquery#23518, [id=#40584])\n  :           :              :        :  +- Subquery subquery#23518, [id=#40584]\n  :           :              :        :     +- AdaptiveSparkPlan isFinalPlan=false\n  :           :              :        :        +- HashAggregate(keys=[], functions=[max(positionOrder#23824)])\n  :           :              :        :           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=40582]\n  :           :              :        :              +- HashAggregate(keys=[], functions=[partial_max(positionOrder#23824)])\n  :           :              :        :                 +- Project [positionOrder#23824]\n  :           :              :        :                    +- SortMergeJoin [raceId#23817], [raceId#23834], Inner\n  :           :              :        :                       :- Sort [raceId#23817 ASC NULLS FIRST], false, 0\n  :           :              :        :                       :  +- Exchange hashpartitioning(raceId#23817, 200), ENSURE_REQUIREMENTS, [plan_id=40574]\n  :           :              :        :                       :     +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23817,positionOrder#23824] PushedFilters: [*IsNotNull(time), *IsNotNull(raceId)], ReadSchema: struct<raceId:int,positionOrder:int>\n  :           :              :        :                       +- Sort [raceId#23834 ASC NULLS FIRST], false, 0\n  :           :              :        :                          +- Exchange hashpartitioning(raceId#23834, 200), ENSURE_REQUIREMENTS, [plan_id=40575]\n  :           :              :        :                             +- Scan JDBCRelation((SELECT \"raceId\", \"year\", \"round\", \"circuitId\", \"name\", CAST(\"date\" AS TEXT) AS \"date\", \"time\", \"url\" FROM \"races\") AS \"races\") [numPartitions=1] [raceId#23834] PushedFilters: [*EqualTo(year,2008), *IsNotNull(year), *EqualTo(name,Australian Grand Prix), *IsNotNull(name), *..., ReadSchema: struct<raceId:int>\n  :           :              :        +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23874,positionOrder#23881,time#23884] PushedFilters: [*IsNotNull(positionOrder), *IsNotNull(time), *IsNotNull(raceId)], ReadSchema: struct<raceId:int,positionOrder:int,time:string>\n  :           :              +- Sort [raceId#23891 ASC NULLS FIRST], false, 0\n  :           :                 +- Exchange hashpartitioning(raceId#23891, 200), ENSURE_REQUIREMENTS, [plan_id=40593]\n  :           :                    +- Scan JDBCRelation((SELECT \"raceId\", \"year\", \"round\", \"circuitId\", \"name\", CAST(\"date\" AS TEXT) AS \"date\", \"time\", \"url\" FROM \"races\") AS \"races\") [numPartitions=1] [raceId#23891] PushedFilters: [*EqualTo(year,2008), *IsNotNull(year), *EqualTo(name,Australian Grand Prix), *IsNotNull(name), *..., ReadSchema: struct<raceId:int>\n  :           +- SortMergeJoin [raceId#23847], [raceId#23864], Inner\n  :              :- Sort [raceId#23847 ASC NULLS FIRST], false, 0\n  :              :  +- Exchange hashpartitioning(raceId#23847, 200), ENSURE_REQUIREMENTS, [plan_id=40604]\n  :              :     +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23847,positionOrder#23854,time#23857] PushedFilters: [*IsNotNull(positionOrder), *IsNotNull(time), *EqualTo(positionOrder,1), *IsNotNull(raceId)], ReadSchema: struct<raceId:int,positionOrder:int,time:string>\n  :              +- Sort [raceId#23864 ASC NULLS FIRST], false, 0\n  :                 +- Exchange hashpartitioning(raceId#23864, 200), ENSURE_REQUIREMENTS, [plan_id=40605]\n  :                    +- Scan JDBCRelation((SELECT \"raceId\", \"year\", \"round\", \"circuitId\", \"name\", CAST(\"date\" AS TEXT) AS \"date\", \"time\", \"url\" FROM \"races\") AS \"races\") [numPartitions=1] [raceId#23864] PushedFilters: [*EqualTo(year,2008), *IsNotNull(year), *EqualTo(name,Australian Grand Prix), *IsNotNull(name), *..., ReadSchema: struct<raceId:int>\n  +- Scan OneRowRelation[]\n================================================================================",
        "model_query": "\nExecution Plan for: Model Query ID 944...\n================================================================================\n\n1. Logical plan:\n----------------------------------------\n'Project [unresolvedalias((((cast('MAX(CASE WHEN isnotnull('T2.time) THEN 'T2.milliseconds END) as double) - cast('MAX(CASE WHEN ('T2.position = 1) THEN 'T2.milliseconds END) as double)) / cast('MAX(CASE WHEN isnotnull('T2.time) THEN 'T2.milliseconds END) as double)) * 100))]\n+- 'Filter (('T1.year = 2008) AND ('T1.name = Australian Grand Prix))\n   +- 'Join Inner, ('T1.raceId = 'T2.raceId)\n      :- 'SubqueryAlias T1\n      :  +- 'UnresolvedRelation [races], [], false\n      +- 'SubqueryAlias T2\n         +- 'UnresolvedRelation [results], [], false\n\n\n2. Optimized logical plan (After Catalyst AFAIK):\n----------------------------------------\nAggregate [(((cast(max(CASE WHEN isnotnull(time#23085) THEN milliseconds#23086 END) as double) - cast(max(CASE WHEN (position#23080 = 1) THEN milliseconds#23086 END) as double)) / cast(max(CASE WHEN isnotnull(time#23085) THEN milliseconds#23086 END) as double)) * 100.0) AS (((CAST(max(CASE WHEN (time IS NOT NULL) THEN milliseconds END) AS DOUBLE) - CAST(max(CASE WHEN (position = 1) THEN milliseconds END) AS DOUBLE)) / CAST(max(CASE WHEN (time IS NOT NULL) THEN milliseconds END) AS DOUBLE)) * 100)#23943]\n+- Project [position#23080, time#23085, milliseconds#23086]\n   +- Join Inner, (raceId#23023 = raceId#23075)\n      :- Project [raceId#23023]\n      :  +- Filter (((isnotnull(year#23024) AND isnotnull(name#23027)) AND ((year#23024 = 2008) AND (name#23027 = Australian Grand Prix))) AND isnotnull(raceId#23023))\n      :     +- Relation [raceId#23023,year#23024,round#23025,circuitId#23026,name#23027,date#23028,time#23029,url#23030] JDBCRelation((SELECT \"raceId\", \"year\", \"round\", \"circuitId\", \"name\", CAST(\"date\" AS TEXT) AS \"date\", \"time\", \"url\" FROM \"races\") AS \"races\") [numPartitions=1]\n      +- Project [raceId#23075, position#23080, time#23085, milliseconds#23086]\n         +- Filter isnotnull(raceId#23075)\n            +- Relation [resultId#23074,raceId#23075,driverId#23076,constructorId#23077,number#23078,grid#23079,position#23080,positionText#23081,positionOrder#23082,points#23083,laps#23084,time#23085,milliseconds#23086,fastestLap#23087,rank#23088,fastestLapTime#23089,fastestLapSpeed#23090,statusId#23091] JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1]\n\n\n3. Physical plan:\n----------------------------------------\nAdaptiveSparkPlan isFinalPlan=false\n+- HashAggregate(keys=[], functions=[max(CASE WHEN isnotnull(time#23085) THEN milliseconds#23086 END), max(CASE WHEN (position#23080 = 1) THEN milliseconds#23086 END)], output=[(((CAST(max(CASE WHEN (time IS NOT NULL) THEN milliseconds END) AS DOUBLE) - CAST(max(CASE WHEN (position = 1) THEN milliseconds END) AS DOUBLE)) / CAST(max(CASE WHEN (time IS NOT NULL) THEN milliseconds END) AS DOUBLE)) * 100)#23943])\n  +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=40716]\n      +- HashAggregate(keys=[], functions=[partial_max(CASE WHEN isnotnull(time#23085) THEN milliseconds#23086 END), partial_max(CASE WHEN (position#23080 = 1) THEN milliseconds#23086 END)], output=[max#23946, max#23947])\n        +- Project [position#23080, time#23085, milliseconds#23086]\n            +- SortMergeJoin [raceId#23023], [raceId#23075], Inner\n              :- Sort [raceId#23023 ASC NULLS FIRST], false, 0\n              :  +- Exchange hashpartitioning(raceId#23023, 200), ENSURE_REQUIREMENTS, [plan_id=40708]\n              :     +- Scan JDBCRelation((SELECT \"raceId\", \"year\", \"round\", \"circuitId\", \"name\", CAST(\"date\" AS TEXT) AS \"date\", \"time\", \"url\" FROM \"races\") AS \"races\") [numPartitions=1] [raceId#23023] PushedFilters: [*EqualTo(year,2008), *IsNotNull(year), *EqualTo(name,Australian Grand Prix), *IsNotNull(name), *..., ReadSchema: struct<raceId:int>\n              +- Sort [raceId#23075 ASC NULLS FIRST], false, 0\n                  +- Exchange hashpartitioning(raceId#23075, 200), ENSURE_REQUIREMENTS, [plan_id=40709]\n                    +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23075,position#23080,time#23085,milliseconds#23086] PushedFilters: [*IsNotNull(raceId)], ReadSchema: struct<raceId:int,position:int,time:string,milliseconds:int>\n\n4. Explain output:\n----------------------------------------\n\nPhysical Plan ==:\n-----------------\n  AdaptiveSparkPlan isFinalPlan=false\n  +- HashAggregate(keys=[], functions=[max(CASE WHEN isnotnull(time#23085) THEN milliseconds#23086 END), max(CASE WHEN (position#23080 = 1) THEN milliseconds#23086 END)])\n  +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=40759]\n  +- HashAggregate(keys=[], functions=[partial_max(CASE WHEN isnotnull(time#23085) THEN milliseconds#23086 END), partial_max(CASE WHEN (position#23080 = 1) THEN milliseconds#23086 END)])\n  +- Project [position#23080, time#23085, milliseconds#23086]\n  +- SortMergeJoin [raceId#23023], [raceId#23075], Inner\n  :- Sort [raceId#23023 ASC NULLS FIRST], false, 0\n  :  +- Exchange hashpartitioning(raceId#23023, 200), ENSURE_REQUIREMENTS, [plan_id=40751]\n  :     +- Scan JDBCRelation((SELECT \"raceId\", \"year\", \"round\", \"circuitId\", \"name\", CAST(\"date\" AS TEXT) AS \"date\", \"time\", \"url\" FROM \"races\") AS \"races\") [numPartitions=1] [raceId#23023] PushedFilters: [*EqualTo(year,2008), *IsNotNull(year), *EqualTo(name,Australian Grand Prix), *IsNotNull(name), *..., ReadSchema: struct<raceId:int>\n  +- Sort [raceId#23075 ASC NULLS FIRST], false, 0\n  +- Exchange hashpartitioning(raceId#23075, 200), ENSURE_REQUIREMENTS, [plan_id=40752]\n  +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23075,position#23080,time#23085,milliseconds#23086] PushedFilters: [*IsNotNull(raceId)], ReadSchema: struct<raceId:int,position:int,time:string,milliseconds:int>\n================================================================================"
    },
    "result_file_path": "/home/lars/Privat/RWTH/Auslandssemester/#KURSE/Safe Distributed Systems/Exercises/Practical_Exercise/NL2SQL2SPARK/RAW_RESULTS/benchmark_results_20251231_google_0d79378d/944/20251231_141311_ID_944_ITER_10_dbc39024.json",
    "explainer_metrics": {
        "golden_query": {
            "shuffle_count": {
                "Exchange\\s+hashpartitioning\\(": 10,
                "Exchange\\s+rangepartitioning\\(": 0,
                "Exchange\\s+SinglePartition": 2,
                "ShuffleExchange": 0,
                "TOTAL": 12
            },
            "has_broadcast_join": false,
            "has_predicate_pushdown": true,
            "pushed_filters": [
                {
                    "scan_line": ":  :           :        :                       :     +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23391,positionOrder#23398] PushedFilters: [*IsNotNull(time), *IsNotNull(raceId)], ReadSchema: struct<raceId:int,positionOrder:int>",
                    "filters": [
                        "*IsNotNull(time)",
                        "*IsNotNull(raceId)"
                    ]
                },
                {
                    "scan_line": ":  :           :        +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23448,positionOrder#23455,time#23458] PushedFilters: [*IsNotNull(positionOrder), *IsNotNull(time), *IsNotNull(raceId)], ReadSchema: struct<raceId:int,positionOrder:int,time:string>",
                    "filters": [
                        "*IsNotNull(positionOrder)",
                        "*IsNotNull(time)",
                        "*IsNotNull(raceId)"
                    ]
                },
                {
                    "scan_line": ":           :              :        :                       :     +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23391,positionOrder#23398] PushedFilters: [*IsNotNull(time), *IsNotNull(raceId)], ReadSchema: struct<raceId:int,positionOrder:int>",
                    "filters": [
                        "*IsNotNull(time)",
                        "*IsNotNull(raceId)"
                    ]
                },
                {
                    "scan_line": ":           :              :        +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23448,positionOrder#23455,time#23458] PushedFilters: [*IsNotNull(positionOrder), *IsNotNull(time), *IsNotNull(raceId)], ReadSchema: struct<raceId:int,positionOrder:int,time:string>",
                    "filters": [
                        "*IsNotNull(positionOrder)",
                        "*IsNotNull(time)",
                        "*IsNotNull(raceId)"
                    ]
                },
                {
                    "scan_line": ":              :     +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23421,positionOrder#23428,time#23431] PushedFilters: [*IsNotNull(positionOrder), *IsNotNull(time), *EqualTo(positionOrder,1), *IsNotNull(raceId)], ReadSchema: struct<raceId:int,positionOrder:int,time:string>",
                    "filters": [
                        "*IsNotNull(positionOrder)",
                        "*IsNotNull(time)",
                        "*EqualTo(positionOrder",
                        "1)",
                        "*IsNotNull(raceId)"
                    ]
                },
                {
                    "scan_line": ":  :           :        :                       :     +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23817,positionOrder#23824] PushedFilters: [*IsNotNull(time), *IsNotNull(raceId)], ReadSchema: struct<raceId:int,positionOrder:int>",
                    "filters": [
                        "*IsNotNull(time)",
                        "*IsNotNull(raceId)"
                    ]
                },
                {
                    "scan_line": ":  :           :        +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23874,positionOrder#23881,time#23884] PushedFilters: [*IsNotNull(positionOrder), *IsNotNull(time), *IsNotNull(raceId)], ReadSchema: struct<raceId:int,positionOrder:int,time:string>",
                    "filters": [
                        "*IsNotNull(positionOrder)",
                        "*IsNotNull(time)",
                        "*IsNotNull(raceId)"
                    ]
                },
                {
                    "scan_line": ":           :              :        :                       :     +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23817,positionOrder#23824] PushedFilters: [*IsNotNull(time), *IsNotNull(raceId)], ReadSchema: struct<raceId:int,positionOrder:int>",
                    "filters": [
                        "*IsNotNull(time)",
                        "*IsNotNull(raceId)"
                    ]
                },
                {
                    "scan_line": ":           :              :        +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23874,positionOrder#23881,time#23884] PushedFilters: [*IsNotNull(positionOrder), *IsNotNull(time), *IsNotNull(raceId)], ReadSchema: struct<raceId:int,positionOrder:int,time:string>",
                    "filters": [
                        "*IsNotNull(positionOrder)",
                        "*IsNotNull(time)",
                        "*IsNotNull(raceId)"
                    ]
                },
                {
                    "scan_line": ":              :     +- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23847,positionOrder#23854,time#23857] PushedFilters: [*IsNotNull(positionOrder), *IsNotNull(time), *EqualTo(positionOrder,1), *IsNotNull(raceId)], ReadSchema: struct<raceId:int,positionOrder:int,time:string>",
                    "filters": [
                        "*IsNotNull(positionOrder)",
                        "*IsNotNull(time)",
                        "*EqualTo(positionOrder",
                        "1)",
                        "*IsNotNull(raceId)"
                    ]
                }
            ],
            "filter_count_before_optimization": 0,
            "filter_count_after_optimization": 10
        },
        "model_query": {
            "shuffle_count": {
                "Exchange\\s+hashpartitioning\\(": 2,
                "Exchange\\s+rangepartitioning\\(": 0,
                "Exchange\\s+SinglePartition": 1,
                "ShuffleExchange": 0,
                "TOTAL": 3
            },
            "has_broadcast_join": false,
            "has_predicate_pushdown": true,
            "pushed_filters": [
                {
                    "scan_line": "+- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23075,position#23080,time#23085,milliseconds#23086] PushedFilters: [*IsNotNull(raceId)], ReadSchema: struct<raceId:int,position:int,time:string,milliseconds:int>",
                    "filters": [
                        "*IsNotNull(raceId)"
                    ]
                },
                {
                    "scan_line": "+- Scan JDBCRelation((SELECT \"resultId\", \"raceId\", \"driverId\", \"constructorId\", \"number\", \"grid\", \"position\", \"positionText\", \"positionOrder\", \"points\", \"laps\", \"time\", \"milliseconds\", \"fastestLap\", \"rank\", \"fastestLapTime\", \"fastestLapSpeed\", \"statusId\" FROM \"results\") AS \"results\") [numPartitions=1] [raceId#23075,position#23080,time#23085,milliseconds#23086] PushedFilters: [*IsNotNull(raceId)], ReadSchema: struct<raceId:int,position:int,time:string,milliseconds:int>",
                    "filters": [
                        "*IsNotNull(raceId)"
                    ]
                }
            ],
            "filter_count_before_optimization": 0,
            "filter_count_after_optimization": 2
        },
        "plan_equivalence": {
            "golden_vs_model_physical_equivalent": false
        }
    }
}