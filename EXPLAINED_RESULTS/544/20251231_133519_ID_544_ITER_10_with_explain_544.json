{
    "query_id": 544,
    "difficulty": "moderate",
    "is_initial": true,
    "nl_query": "What is the display name of the user who last edited the post \"Examples for teaching: Correlation does not mean causation\"? \"Examples for teaching: Correlation does not mean causation\" is the Title of post; user who last edited refers to LastEditorUserId",
    "golden_query": "SELECT T2.DisplayName FROM posts AS T1 INNER JOIN users AS T2 ON T1.LastEditorUserId = T2.Id WHERE T1.Title = 'Examples for teaching: Correlation does not mean causation'",
    "sparksql_query": "SELECT `T2`.`DisplayName` FROM `posts` AS `T1` JOIN `users` AS `T2` ON `T1`.`LastEditorUserId` = `T2`.`Id` WHERE `T1`.`Title` = 'Examples for teaching: Correlation does not mean causation'",
    "jaccard_index": 1.0,
    "exact_match": 0,
    "ground_truth": [
        {
            "DisplayName": "Abhilash"
        }
    ],
    "query_result": [
        [
            "Abhilash"
        ]
    ],
    "execution_plans": {
        "golden_query": "\nExecution Plan for: Golden Query ID 544...\n================================================================================\n\n1. Logical plan:\n----------------------------------------\n'Project ['T2.DisplayName]\n+- 'Filter ('T1.Title = Examples for teaching: Correlation does not mean causation)\n   +- 'Join Inner, ('T1.LastEditorUserId = 'T2.Id)\n      :- 'SubqueryAlias T1\n      :  +- 'UnresolvedRelation [posts], [], false\n      +- 'SubqueryAlias T2\n         +- 'UnresolvedRelation [users], [], false\n\n\n2. Optimized logical plan (After Catalyst AFAIK):\n----------------------------------------\nProject [DisplayName#7914]\n+- Join Inner, (LastEditorUserId#7899 = Id#7911)\n   :- Project [LastEditorUserId#7899]\n   :  +- Filter ((isnotnull(Title#7894) AND (Title#7894 = Examples for teaching: Correlation does not mean causation)) AND isnotnull(LastEditorUserId#7899))\n   :     +- Relation [Id#7885,PostTypeId#7886,AcceptedAnswerId#7887,CreaionDate#7888,Score#7889,ViewCount#7890,Body#7891,OwnerUserId#7892,LasActivityDate#7893,Title#7894,Tags#7895,AnswerCount#7896,CommentCount#7897,FavoriteCount#7898,LastEditorUserId#7899,LastEditDate#7900,CommunityOwnedDate#7901,ParentId#7902,ClosedDate#7903,OwnerDisplayName#7904,LastEditorDisplayName#7905] JDBCRelation((SELECT \"Id\", \"PostTypeId\", \"AcceptedAnswerId\", CAST(\"CreaionDate\" AS TEXT) AS \"CreaionDate\", \"Score\", \"ViewCount\", \"Body\", \"OwnerUserId\", CAST(\"LasActivityDate\" AS TEXT) AS \"LasActivityDate\", \"Title\", \"Tags\", \"AnswerCount\", \"CommentCount\", \"FavoriteCount\", \"LastEditorUserId\", CAST(\"LastEditDate\" AS TEXT) AS \"LastEditDate\", CAST(\"CommunityOwnedDate\" AS TEXT) AS \"CommunityOwnedDate\", \"ParentId\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"OwnerDisplayName\", \"LastEditorDisplayName\" FROM \"posts\") AS \"posts\") [numPartitions=1]\n   +- Project [Id#7911, DisplayName#7914]\n      +- Filter isnotnull(Id#7911)\n         +- Relation [Id#7911,Reputation#7912,CreationDate#7913,DisplayName#7914,LastAccessDate#7915,WebsiteUrl#7916,Location#7917,AboutMe#7918,Views#7919,UpVotes#7920,DownVotes#7921,AccountId#7922,Age#7923,ProfileImageUrl#7924] JDBCRelation((SELECT \"Id\", \"Reputation\", CAST(\"CreationDate\" AS TEXT) AS \"CreationDate\", \"DisplayName\", CAST(\"LastAccessDate\" AS TEXT) AS \"LastAccessDate\", \"WebsiteUrl\", \"Location\", \"AboutMe\", \"Views\", \"UpVotes\", \"DownVotes\", \"AccountId\", \"Age\", \"ProfileImageUrl\" FROM \"users\") AS \"users\") [numPartitions=1]\n\n\n3. Physical plan:\n----------------------------------------\nAdaptiveSparkPlan isFinalPlan=false\n+- Project [DisplayName#7914]\n  +- SortMergeJoin [LastEditorUserId#7899], [Id#7911], Inner\n      :- Sort [LastEditorUserId#7899 ASC NULLS FIRST], false, 0\n      :  +- Exchange hashpartitioning(LastEditorUserId#7899, 200), ENSURE_REQUIREMENTS, [plan_id=18563]\n      :     +- Scan JDBCRelation((SELECT \"Id\", \"PostTypeId\", \"AcceptedAnswerId\", CAST(\"CreaionDate\" AS TEXT) AS \"CreaionDate\", \"Score\", \"ViewCount\", \"Body\", \"OwnerUserId\", CAST(\"LasActivityDate\" AS TEXT) AS \"LasActivityDate\", \"Title\", \"Tags\", \"AnswerCount\", \"CommentCount\", \"FavoriteCount\", \"LastEditorUserId\", CAST(\"LastEditDate\" AS TEXT) AS \"LastEditDate\", CAST(\"CommunityOwnedDate\" AS TEXT) AS \"CommunityOwnedDate\", \"ParentId\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"OwnerDisplayName\", \"LastEditorDisplayName\" FROM \"posts\") AS \"posts\") [numPartitions=1] [LastEditorUserId#7899] PushedFilters: [*IsNotNull(Title), *EqualTo(Title,Examples for teaching: Correlation does not mean causation), *..., ReadSchema: struct<LastEditorUserId:int>\n      +- Sort [Id#7911 ASC NULLS FIRST], false, 0\n        +- Exchange hashpartitioning(Id#7911, 200), ENSURE_REQUIREMENTS, [plan_id=18564]\n            +- Scan JDBCRelation((SELECT \"Id\", \"Reputation\", CAST(\"CreationDate\" AS TEXT) AS \"CreationDate\", \"DisplayName\", CAST(\"LastAccessDate\" AS TEXT) AS \"LastAccessDate\", \"WebsiteUrl\", \"Location\", \"AboutMe\", \"Views\", \"UpVotes\", \"DownVotes\", \"AccountId\", \"Age\", \"ProfileImageUrl\" FROM \"users\") AS \"users\") [numPartitions=1] [Id#7911,DisplayName#7914] PushedFilters: [*IsNotNull(Id)], ReadSchema: struct<Id:int,DisplayName:string>\n\n4. Explain output:\n----------------------------------------\n\nPhysical Plan ==:\n-----------------\n  AdaptiveSparkPlan isFinalPlan=false\n  +- Project [DisplayName#7914]\n  +- SortMergeJoin [LastEditorUserId#7899], [Id#7911], Inner\n  :- Sort [LastEditorUserId#7899 ASC NULLS FIRST], false, 0\n  :  +- Exchange hashpartitioning(LastEditorUserId#7899, 200), ENSURE_REQUIREMENTS, [plan_id=18593]\n  :     +- Scan JDBCRelation((SELECT \"Id\", \"PostTypeId\", \"AcceptedAnswerId\", CAST(\"CreaionDate\" AS TEXT) AS \"CreaionDate\", \"Score\", \"ViewCount\", \"Body\", \"OwnerUserId\", CAST(\"LasActivityDate\" AS TEXT) AS \"LasActivityDate\", \"Title\", \"Tags\", \"AnswerCount\", \"CommentCount\", \"FavoriteCount\", \"LastEditorUserId\", CAST(\"LastEditDate\" AS TEXT) AS \"LastEditDate\", CAST(\"CommunityOwnedDate\" AS TEXT) AS \"CommunityOwnedDate\", \"ParentId\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"OwnerDisplayName\", \"LastEditorDisplayName\" FROM \"posts\") AS \"posts\") [numPartitions=1] [LastEditorUserId#7899] PushedFilters: [*IsNotNull(Title), *EqualTo(Title,Examples for teaching: Correlation does not mean causation), *..., ReadSchema: struct<LastEditorUserId:int>\n  +- Sort [Id#7911 ASC NULLS FIRST], false, 0\n  +- Exchange hashpartitioning(Id#7911, 200), ENSURE_REQUIREMENTS, [plan_id=18594]\n  +- Scan JDBCRelation((SELECT \"Id\", \"Reputation\", CAST(\"CreationDate\" AS TEXT) AS \"CreationDate\", \"DisplayName\", CAST(\"LastAccessDate\" AS TEXT) AS \"LastAccessDate\", \"WebsiteUrl\", \"Location\", \"AboutMe\", \"Views\", \"UpVotes\", \"DownVotes\", \"AccountId\", \"Age\", \"ProfileImageUrl\" FROM \"users\") AS \"users\") [numPartitions=1] [Id#7911,DisplayName#7914] PushedFilters: [*IsNotNull(Id)], ReadSchema: struct<Id:int,DisplayName:string>\n================================================================================",
        "model_query": "\nExecution Plan for: Model Query ID 544...\n================================================================================\n\n1. Logical plan:\n----------------------------------------\n'Project ['T2.DisplayName]\n+- 'Filter ('T1.Title = Examples for teaching: Correlation does not mean causation)\n   +- 'Join Inner, ('T1.LastEditorUserId = 'T2.Id)\n      :- 'SubqueryAlias T1\n      :  +- 'UnresolvedRelation [posts], [], false\n      +- 'SubqueryAlias T2\n         +- 'UnresolvedRelation [users], [], false\n\n\n2. Optimized logical plan (After Catalyst AFAIK):\n----------------------------------------\nProject [DisplayName#7914]\n+- Join Inner, (LastEditorUserId#7899 = Id#7911)\n   :- Project [LastEditorUserId#7899]\n   :  +- Filter ((isnotnull(Title#7894) AND (Title#7894 = Examples for teaching: Correlation does not mean causation)) AND isnotnull(LastEditorUserId#7899))\n   :     +- Relation [Id#7885,PostTypeId#7886,AcceptedAnswerId#7887,CreaionDate#7888,Score#7889,ViewCount#7890,Body#7891,OwnerUserId#7892,LasActivityDate#7893,Title#7894,Tags#7895,AnswerCount#7896,CommentCount#7897,FavoriteCount#7898,LastEditorUserId#7899,LastEditDate#7900,CommunityOwnedDate#7901,ParentId#7902,ClosedDate#7903,OwnerDisplayName#7904,LastEditorDisplayName#7905] JDBCRelation((SELECT \"Id\", \"PostTypeId\", \"AcceptedAnswerId\", CAST(\"CreaionDate\" AS TEXT) AS \"CreaionDate\", \"Score\", \"ViewCount\", \"Body\", \"OwnerUserId\", CAST(\"LasActivityDate\" AS TEXT) AS \"LasActivityDate\", \"Title\", \"Tags\", \"AnswerCount\", \"CommentCount\", \"FavoriteCount\", \"LastEditorUserId\", CAST(\"LastEditDate\" AS TEXT) AS \"LastEditDate\", CAST(\"CommunityOwnedDate\" AS TEXT) AS \"CommunityOwnedDate\", \"ParentId\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"OwnerDisplayName\", \"LastEditorDisplayName\" FROM \"posts\") AS \"posts\") [numPartitions=1]\n   +- Project [Id#7911, DisplayName#7914]\n      +- Filter isnotnull(Id#7911)\n         +- Relation [Id#7911,Reputation#7912,CreationDate#7913,DisplayName#7914,LastAccessDate#7915,WebsiteUrl#7916,Location#7917,AboutMe#7918,Views#7919,UpVotes#7920,DownVotes#7921,AccountId#7922,Age#7923,ProfileImageUrl#7924] JDBCRelation((SELECT \"Id\", \"Reputation\", CAST(\"CreationDate\" AS TEXT) AS \"CreationDate\", \"DisplayName\", CAST(\"LastAccessDate\" AS TEXT) AS \"LastAccessDate\", \"WebsiteUrl\", \"Location\", \"AboutMe\", \"Views\", \"UpVotes\", \"DownVotes\", \"AccountId\", \"Age\", \"ProfileImageUrl\" FROM \"users\") AS \"users\") [numPartitions=1]\n\n\n3. Physical plan:\n----------------------------------------\nAdaptiveSparkPlan isFinalPlan=false\n+- Project [DisplayName#7914]\n  +- SortMergeJoin [LastEditorUserId#7899], [Id#7911], Inner\n      :- Sort [LastEditorUserId#7899 ASC NULLS FIRST], false, 0\n      :  +- Exchange hashpartitioning(LastEditorUserId#7899, 200), ENSURE_REQUIREMENTS, [plan_id=18623]\n      :     +- Scan JDBCRelation((SELECT \"Id\", \"PostTypeId\", \"AcceptedAnswerId\", CAST(\"CreaionDate\" AS TEXT) AS \"CreaionDate\", \"Score\", \"ViewCount\", \"Body\", \"OwnerUserId\", CAST(\"LasActivityDate\" AS TEXT) AS \"LasActivityDate\", \"Title\", \"Tags\", \"AnswerCount\", \"CommentCount\", \"FavoriteCount\", \"LastEditorUserId\", CAST(\"LastEditDate\" AS TEXT) AS \"LastEditDate\", CAST(\"CommunityOwnedDate\" AS TEXT) AS \"CommunityOwnedDate\", \"ParentId\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"OwnerDisplayName\", \"LastEditorDisplayName\" FROM \"posts\") AS \"posts\") [numPartitions=1] [LastEditorUserId#7899] PushedFilters: [*IsNotNull(Title), *EqualTo(Title,Examples for teaching: Correlation does not mean causation), *..., ReadSchema: struct<LastEditorUserId:int>\n      +- Sort [Id#7911 ASC NULLS FIRST], false, 0\n        +- Exchange hashpartitioning(Id#7911, 200), ENSURE_REQUIREMENTS, [plan_id=18624]\n            +- Scan JDBCRelation((SELECT \"Id\", \"Reputation\", CAST(\"CreationDate\" AS TEXT) AS \"CreationDate\", \"DisplayName\", CAST(\"LastAccessDate\" AS TEXT) AS \"LastAccessDate\", \"WebsiteUrl\", \"Location\", \"AboutMe\", \"Views\", \"UpVotes\", \"DownVotes\", \"AccountId\", \"Age\", \"ProfileImageUrl\" FROM \"users\") AS \"users\") [numPartitions=1] [Id#7911,DisplayName#7914] PushedFilters: [*IsNotNull(Id)], ReadSchema: struct<Id:int,DisplayName:string>\n\n4. Explain output:\n----------------------------------------\n\nPhysical Plan ==:\n-----------------\n  AdaptiveSparkPlan isFinalPlan=false\n  +- Project [DisplayName#7914]\n  +- SortMergeJoin [LastEditorUserId#7899], [Id#7911], Inner\n  :- Sort [LastEditorUserId#7899 ASC NULLS FIRST], false, 0\n  :  +- Exchange hashpartitioning(LastEditorUserId#7899, 200), ENSURE_REQUIREMENTS, [plan_id=18653]\n  :     +- Scan JDBCRelation((SELECT \"Id\", \"PostTypeId\", \"AcceptedAnswerId\", CAST(\"CreaionDate\" AS TEXT) AS \"CreaionDate\", \"Score\", \"ViewCount\", \"Body\", \"OwnerUserId\", CAST(\"LasActivityDate\" AS TEXT) AS \"LasActivityDate\", \"Title\", \"Tags\", \"AnswerCount\", \"CommentCount\", \"FavoriteCount\", \"LastEditorUserId\", CAST(\"LastEditDate\" AS TEXT) AS \"LastEditDate\", CAST(\"CommunityOwnedDate\" AS TEXT) AS \"CommunityOwnedDate\", \"ParentId\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"OwnerDisplayName\", \"LastEditorDisplayName\" FROM \"posts\") AS \"posts\") [numPartitions=1] [LastEditorUserId#7899] PushedFilters: [*IsNotNull(Title), *EqualTo(Title,Examples for teaching: Correlation does not mean causation), *..., ReadSchema: struct<LastEditorUserId:int>\n  +- Sort [Id#7911 ASC NULLS FIRST], false, 0\n  +- Exchange hashpartitioning(Id#7911, 200), ENSURE_REQUIREMENTS, [plan_id=18654]\n  +- Scan JDBCRelation((SELECT \"Id\", \"Reputation\", CAST(\"CreationDate\" AS TEXT) AS \"CreationDate\", \"DisplayName\", CAST(\"LastAccessDate\" AS TEXT) AS \"LastAccessDate\", \"WebsiteUrl\", \"Location\", \"AboutMe\", \"Views\", \"UpVotes\", \"DownVotes\", \"AccountId\", \"Age\", \"ProfileImageUrl\" FROM \"users\") AS \"users\") [numPartitions=1] [Id#7911,DisplayName#7914] PushedFilters: [*IsNotNull(Id)], ReadSchema: struct<Id:int,DisplayName:string>\n================================================================================"
    },
    "result_file_path": "/home/lars/Privat/RWTH/Auslandssemester/#KURSE/Safe Distributed Systems/Exercises/Practical_Exercise/NL2SQL2SPARK/RAW_RESULTS/benchmark_results_20251231_google_0d954987/544/20251231_133519_ID_544_ITER_10_59aca6b0.json",
    "explainer_metrics": {
        "golden_query": {
            "shuffle_count": {
                "Exchange\\s+hashpartitioning\\(": 2,
                "Exchange\\s+rangepartitioning\\(": 0,
                "Exchange\\s+SinglePartition": 0,
                "ShuffleExchange": 0,
                "TOTAL": 2
            },
            "has_broadcast_join": false,
            "has_predicate_pushdown": true,
            "pushed_filters": [
                {
                    "scan_line": "+- Scan JDBCRelation((SELECT \"Id\", \"Reputation\", CAST(\"CreationDate\" AS TEXT) AS \"CreationDate\", \"DisplayName\", CAST(\"LastAccessDate\" AS TEXT) AS \"LastAccessDate\", \"WebsiteUrl\", \"Location\", \"AboutMe\", \"Views\", \"UpVotes\", \"DownVotes\", \"AccountId\", \"Age\", \"ProfileImageUrl\" FROM \"users\") AS \"users\") [numPartitions=1] [Id#7911,DisplayName#7914] PushedFilters: [*IsNotNull(Id)], ReadSchema: struct<Id:int,DisplayName:string>",
                    "filters": [
                        "*IsNotNull(Id)"
                    ]
                },
                {
                    "scan_line": "+- Scan JDBCRelation((SELECT \"Id\", \"Reputation\", CAST(\"CreationDate\" AS TEXT) AS \"CreationDate\", \"DisplayName\", CAST(\"LastAccessDate\" AS TEXT) AS \"LastAccessDate\", \"WebsiteUrl\", \"Location\", \"AboutMe\", \"Views\", \"UpVotes\", \"DownVotes\", \"AccountId\", \"Age\", \"ProfileImageUrl\" FROM \"users\") AS \"users\") [numPartitions=1] [Id#7911,DisplayName#7914] PushedFilters: [*IsNotNull(Id)], ReadSchema: struct<Id:int,DisplayName:string>",
                    "filters": [
                        "*IsNotNull(Id)"
                    ]
                }
            ],
            "filter_count_before_optimization": 0,
            "filter_count_after_optimization": 2
        },
        "model_query": {
            "shuffle_count": {
                "Exchange\\s+hashpartitioning\\(": 2,
                "Exchange\\s+rangepartitioning\\(": 0,
                "Exchange\\s+SinglePartition": 0,
                "ShuffleExchange": 0,
                "TOTAL": 2
            },
            "has_broadcast_join": false,
            "has_predicate_pushdown": true,
            "pushed_filters": [
                {
                    "scan_line": "+- Scan JDBCRelation((SELECT \"Id\", \"Reputation\", CAST(\"CreationDate\" AS TEXT) AS \"CreationDate\", \"DisplayName\", CAST(\"LastAccessDate\" AS TEXT) AS \"LastAccessDate\", \"WebsiteUrl\", \"Location\", \"AboutMe\", \"Views\", \"UpVotes\", \"DownVotes\", \"AccountId\", \"Age\", \"ProfileImageUrl\" FROM \"users\") AS \"users\") [numPartitions=1] [Id#7911,DisplayName#7914] PushedFilters: [*IsNotNull(Id)], ReadSchema: struct<Id:int,DisplayName:string>",
                    "filters": [
                        "*IsNotNull(Id)"
                    ]
                },
                {
                    "scan_line": "+- Scan JDBCRelation((SELECT \"Id\", \"Reputation\", CAST(\"CreationDate\" AS TEXT) AS \"CreationDate\", \"DisplayName\", CAST(\"LastAccessDate\" AS TEXT) AS \"LastAccessDate\", \"WebsiteUrl\", \"Location\", \"AboutMe\", \"Views\", \"UpVotes\", \"DownVotes\", \"AccountId\", \"Age\", \"ProfileImageUrl\" FROM \"users\") AS \"users\") [numPartitions=1] [Id#7911,DisplayName#7914] PushedFilters: [*IsNotNull(Id)], ReadSchema: struct<Id:int,DisplayName:string>",
                    "filters": [
                        "*IsNotNull(Id)"
                    ]
                }
            ],
            "filter_count_before_optimization": 0,
            "filter_count_after_optimization": 2
        },
        "plan_equivalence": {
            "golden_vs_model_physical_equivalent": true
        }
    }
}