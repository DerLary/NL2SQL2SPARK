
Execution Plan for: Model Query ID 83...
================================================================================

1. Logical plan:
----------------------------------------
'Project [unresolvedalias('COUNT(distinct 's.School))]
+- 'Filter ((('s.Magnet = 1) AND ('f.Low Grade = K)) AND (('f.High Grade = 8) AND ('f.NSLP Provision Status = Multiple Provision Types)))
   +- 'Join Inner, ('s.CDSCode = 'f.CDSCode)
      :- 'SubqueryAlias s
      :  +- 'UnresolvedRelation [schools], [], false
      +- 'SubqueryAlias f
         +- 'UnresolvedRelation [frpm], [], false


2. Optimized logical plan (After Catalyst AFAIK):
----------------------------------------
Aggregate [count(distinct School#36237) AS count(DISTINCT School)#36293L]
+- Project [School#36237]
   +- Join Inner, (CDSCode#36231 = CDSCode#36191)
      :- Project [CDSCode#36231, School#36237]
      :  +- Filter ((isnotnull(Magnet#36267) AND (Magnet#36267 = 1)) AND isnotnull(CDSCode#36231))
      :     +- Relation [CDSCode#36231,NCESDist#36232,NCESSchool#36233,StatusType#36234,County#36235,District#36236,School#36237,Street#36238,StreetAbr#36239,City#36240,Zip#36241,State#36242,MailStreet#36243,MailStrAbr#36244,MailCity#36245,MailZip#36246,MailState#36247,Phone#36248,Ext#36249,Website#36250,OpenDate#36251,ClosedDate#36252,Charter#36253,CharterNum#36254,FundingType#36255,... 24 more fields] JDBCRelation((SELECT "CDSCode", "NCESDist", "NCESSchool", "StatusType", "County", "District", "School", "Street", "StreetAbr", "City", "Zip", "State", "MailStreet", "MailStrAbr", "MailCity", "MailZip", "MailState", "Phone", "Ext", "Website", CAST("OpenDate" AS TEXT) AS "OpenDate", CAST("ClosedDate" AS TEXT) AS "ClosedDate", "Charter", "CharterNum", "FundingType", "DOC", "DOCType", "SOC", "SOCType", "EdOpsCode", "EdOpsName", "EILCode", "EILName", "GSoffered", "GSserved", "Virtual", "Magnet", "Latitude", "Longitude", "AdmFName1", "AdmLName1", "AdmEmail1", "AdmFName2", "AdmLName2", "AdmEmail2", "AdmFName3", "AdmLName3", "AdmEmail3", CAST("LastUpdate" AS TEXT) AS "LastUpdate" FROM "schools") AS "schools") [numPartitions=1]
      +- Project [CDSCode#36191]
         +- Filter ((((isnotnull(Low Grade#36207) AND isnotnull(High Grade#36208)) AND isnotnull(NSLP Provision Status#36202)) AND (((Low Grade#36207 = K) AND (High Grade#36208 = 8)) AND (NSLP Provision Status#36202 = Multiple Provision Types))) AND isnotnull(CDSCode#36191))
            +- Relation [CDSCode#36191,Academic Year#36192,County Code#36193,District Code#36194,School Code#36195,County Name#36196,District Name#36197,School Name#36198,District Type#36199,School Type#36200,Educational Option Type#36201,NSLP Provision Status#36202,Charter School (Y/N)#36203,Charter School Number#36204,Charter Funding Type#36205,IRC#36206,Low Grade#36207,High Grade#36208,Enrollment (K-12)#36209,Free Meal Count (K-12)#36210,Percent (%) Eligible Free (K-12)#36211,FRPM Count (K-12)#36212,Percent (%) Eligible FRPM (K-12)#36213,Enrollment (Ages 5-17)#36214,Free Meal Count (Ages 5-17)#36215,... 4 more fields] JDBCRelation((SELECT "CDSCode", "Academic Year", "County Code", "District Code", "School Code", "County Name", "District Name", "School Name", "District Type", "School Type", "Educational Option Type", "NSLP Provision Status", "Charter School (Y/N)", "Charter School Number", "Charter Funding Type", "IRC", "Low Grade", "High Grade", "Enrollment (K-12)", "Free Meal Count (K-12)", "Percent (%) Eligible Free (K-12)", "FRPM Count (K-12)", "Percent (%) Eligible FRPM (K-12)", "Enrollment (Ages 5-17)", "Free Meal Count (Ages 5-17)", "Percent (%) Eligible Free (Ages 5-17)", "FRPM Count (Ages 5-17)", "Percent (%) Eligible FRPM (Ages 5-17)", "2013-14 CALPADS Fall 1 Certification Status" FROM "frpm") AS "frpm") [numPartitions=1]


3. Physical plan:
----------------------------------------
AdaptiveSparkPlan isFinalPlan=false
+- HashAggregate(keys=[], functions=[count(distinct School#36237)], output=[count(DISTINCT School)#36293L])
  +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=59674]
      +- HashAggregate(keys=[], functions=[partial_count(distinct School#36237)], output=[count#36296L])
        +- HashAggregate(keys=[School#36237], functions=[], output=[School#36237])
            +- Exchange hashpartitioning(School#36237, 200), ENSURE_REQUIREMENTS, [plan_id=59670]
              +- HashAggregate(keys=[School#36237], functions=[], output=[School#36237])
                  +- Project [School#36237]
                    +- SortMergeJoin [CDSCode#36231], [CDSCode#36191], Inner
                        :- Sort [CDSCode#36231 ASC NULLS FIRST], false, 0
                        :  +- Exchange hashpartitioning(CDSCode#36231, 200), ENSURE_REQUIREMENTS, [plan_id=59662]
                        :     +- Scan JDBCRelation((SELECT "CDSCode", "NCESDist", "NCESSchool", "StatusType", "County", "District", "School", "Street", "StreetAbr", "City", "Zip", "State", "MailStreet", "MailStrAbr", "MailCity", "MailZip", "MailState", "Phone", "Ext", "Website", CAST("OpenDate" AS TEXT) AS "OpenDate", CAST("ClosedDate" AS TEXT) AS "ClosedDate", "Charter", "CharterNum", "FundingType", "DOC", "DOCType", "SOC", "SOCType", "EdOpsCode", "EdOpsName", "EILCode", "EILName", "GSoffered", "GSserved", "Virtual", "Magnet", "Latitude", "Longitude", "AdmFName1", "AdmLName1", "AdmEmail1", "AdmFName2", "AdmLName2", "AdmEmail2", "AdmFName3", "AdmLName3", "AdmEmail3", CAST("LastUpdate" AS TEXT) AS "LastUpdate" FROM "schools") AS "schools") [numPartitions=1] [CDSCode#36231,School#36237] PushedFilters: [*IsNotNull(Magnet), *EqualTo(Magnet,1), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,School:string>
                        +- Sort [CDSCode#36191 ASC NULLS FIRST], false, 0
                          +- Exchange hashpartitioning(CDSCode#36191, 200), ENSURE_REQUIREMENTS, [plan_id=59663]
                              +- Scan JDBCRelation((SELECT "CDSCode", "Academic Year", "County Code", "District Code", "School Code", "County Name", "District Name", "School Name", "District Type", "School Type", "Educational Option Type", "NSLP Provision Status", "Charter School (Y/N)", "Charter School Number", "Charter Funding Type", "IRC", "Low Grade", "High Grade", "Enrollment (K-12)", "Free Meal Count (K-12)", "Percent (%) Eligible Free (K-12)", "FRPM Count (K-12)", "Percent (%) Eligible FRPM (K-12)", "Enrollment (Ages 5-17)", "Free Meal Count (Ages 5-17)", "Percent (%) Eligible Free (Ages 5-17)", "FRPM Count (Ages 5-17)", "Percent (%) Eligible FRPM (Ages 5-17)", "2013-14 CALPADS Fall 1 Certification Status" FROM "frpm") AS "frpm") [numPartitions=1] [CDSCode#36191] PushedFilters: [*IsNotNull(NSLP Provision Status), *EqualTo(High Grade,8), *IsNotNull(CDSCode), *IsNotNull(Low G..., ReadSchema: struct<CDSCode:string>

4. Explain output:
----------------------------------------

Physical Plan ==:
-----------------
  AdaptiveSparkPlan isFinalPlan=false
  +- HashAggregate(keys=[], functions=[count(distinct School#36237)])
  +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=59731]
  +- HashAggregate(keys=[], functions=[partial_count(distinct School#36237)])
  +- HashAggregate(keys=[School#36237], functions=[])
  +- Exchange hashpartitioning(School#36237, 200), ENSURE_REQUIREMENTS, [plan_id=59727]
  +- HashAggregate(keys=[School#36237], functions=[])
  +- Project [School#36237]
  +- SortMergeJoin [CDSCode#36231], [CDSCode#36191], Inner
  :- Sort [CDSCode#36231 ASC NULLS FIRST], false, 0
  :  +- Exchange hashpartitioning(CDSCode#36231, 200), ENSURE_REQUIREMENTS, [plan_id=59719]
  :     +- Scan JDBCRelation((SELECT "CDSCode", "NCESDist", "NCESSchool", "StatusType", "County", "District", "School", "Street", "StreetAbr", "City", "Zip", "State", "MailStreet", "MailStrAbr", "MailCity", "MailZip", "MailState", "Phone", "Ext", "Website", CAST("OpenDate" AS TEXT) AS "OpenDate", CAST("ClosedDate" AS TEXT) AS "ClosedDate", "Charter", "CharterNum", "FundingType", "DOC", "DOCType", "SOC", "SOCType", "EdOpsCode", "EdOpsName", "EILCode", "EILName", "GSoffered", "GSserved", "Virtual", "Magnet", "Latitude", "Longitude", "AdmFName1", "AdmLName1", "AdmEmail1", "AdmFName2", "AdmLName2", "AdmEmail2", "AdmFName3", "AdmLName3", "AdmEmail3", CAST("LastUpdate" AS TEXT) AS "LastUpdate" FROM "schools") AS "schools") [numPartitions=1] [CDSCode#36231,School#36237] PushedFilters: [*IsNotNull(Magnet), *EqualTo(Magnet,1), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,School:string>
  +- Sort [CDSCode#36191 ASC NULLS FIRST], false, 0
  +- Exchange hashpartitioning(CDSCode#36191, 200), ENSURE_REQUIREMENTS, [plan_id=59720]
  +- Scan JDBCRelation((SELECT "CDSCode", "Academic Year", "County Code", "District Code", "School Code", "County Name", "District Name", "School Name", "District Type", "School Type", "Educational Option Type", "NSLP Provision Status", "Charter School (Y/N)", "Charter School Number", "Charter Funding Type", "IRC", "Low Grade", "High Grade", "Enrollment (K-12)", "Free Meal Count (K-12)", "Percent (%) Eligible Free (K-12)", "FRPM Count (K-12)", "Percent (%) Eligible FRPM (K-12)", "Enrollment (Ages 5-17)", "Free Meal Count (Ages 5-17)", "Percent (%) Eligible Free (Ages 5-17)", "FRPM Count (Ages 5-17)", "Percent (%) Eligible FRPM (Ages 5-17)", "2013-14 CALPADS Fall 1 Certification Status" FROM "frpm") AS "frpm") [numPartitions=1] [CDSCode#36191] PushedFilters: [*IsNotNull(NSLP Provision Status), *EqualTo(High Grade,8), *IsNotNull(CDSCode), *IsNotNull(Low G..., ReadSchema: struct<CDSCode:string>
================================================================================