
Execution Plan for: Golden Query ID 1385...
================================================================================

1. Logical plan:
----------------------------------------
'Project ['T1.first_name, 'T1.last_name]
+- 'Filter ('T2.amount > 40)
   +- 'Join Inner, ('T1.member_id = 'T2.link_to_member)
      :- 'SubqueryAlias T1
      :  +- 'UnresolvedRelation [member], [], false
      +- 'SubqueryAlias T2
         +- 'UnresolvedRelation [income], [], false


2. Optimized logical plan (After Catalyst AFAIK):
----------------------------------------
Project [first_name#12868, last_name#12869]
+- Join Inner, (member_id#12867 = link_to_member#12866)
   :- Project [member_id#12867, first_name#12868, last_name#12869]
   :  +- Filter isnotnull(member_id#12867)
   :     +- Relation [member_id#12867,first_name#12868,last_name#12869,email#12870,position#12871,t_shirt_size#12872,phone#12873,zip#12874,link_to_major#12875] JDBCRelation((SELECT "member_id", "first_name", "last_name", "email", "position", "t_shirt_size", "phone", "zip", "link_to_major" FROM "member") AS "member") [numPartitions=1]
   +- Project [link_to_member#12866]
      +- Filter ((isnotnull(amount#12863) AND (amount#12863 > 40)) AND isnotnull(link_to_member#12866))
         +- Relation [income_id#12861,date_received#12862,amount#12863,source#12864,notes#12865,link_to_member#12866] JDBCRelation((SELECT "income_id", "date_received", "amount", "source", "notes", "link_to_member" FROM "income") AS "income") [numPartitions=1]


3. Physical plan:
----------------------------------------
AdaptiveSparkPlan isFinalPlan=false
+- Project [first_name#12868, last_name#12869]
  +- SortMergeJoin [member_id#12867], [link_to_member#12866], Inner
      :- Sort [member_id#12867 ASC NULLS FIRST], false, 0
      :  +- Exchange hashpartitioning(member_id#12867, 200), ENSURE_REQUIREMENTS, [plan_id=29799]
      :     +- Scan JDBCRelation((SELECT "member_id", "first_name", "last_name", "email", "position", "t_shirt_size", "phone", "zip", "link_to_major" FROM "member") AS "member") [numPartitions=1] [member_id#12867,first_name#12868,last_name#12869] PushedFilters: [*IsNotNull(member_id)], ReadSchema: struct<member_id:string,first_name:string,last_name:string>
      +- Sort [link_to_member#12866 ASC NULLS FIRST], false, 0
        +- Exchange hashpartitioning(link_to_member#12866, 200), ENSURE_REQUIREMENTS, [plan_id=29800]
            +- Scan JDBCRelation((SELECT "income_id", "date_received", "amount", "source", "notes", "link_to_member" FROM "income") AS "income") [numPartitions=1] [link_to_member#12866] PushedFilters: [*IsNotNull(amount), *GreaterThan(amount,40), *IsNotNull(link_to_member)], ReadSchema: struct<link_to_member:string>

4. Explain output:
----------------------------------------

Physical Plan ==:
-----------------
  AdaptiveSparkPlan isFinalPlan=false
  +- Project [first_name#12868, last_name#12869]
  +- SortMergeJoin [member_id#12867], [link_to_member#12866], Inner
  :- Sort [member_id#12867 ASC NULLS FIRST], false, 0
  :  +- Exchange hashpartitioning(member_id#12867, 200), ENSURE_REQUIREMENTS, [plan_id=29829]
  :     +- Scan JDBCRelation((SELECT "member_id", "first_name", "last_name", "email", "position", "t_shirt_size", "phone", "zip", "link_to_major" FROM "member") AS "member") [numPartitions=1] [member_id#12867,first_name#12868,last_name#12869] PushedFilters: [*IsNotNull(member_id)], ReadSchema: struct<member_id:string,first_name:string,last_name:string>
  +- Sort [link_to_member#12866 ASC NULLS FIRST], false, 0
  +- Exchange hashpartitioning(link_to_member#12866, 200), ENSURE_REQUIREMENTS, [plan_id=29830]
  +- Scan JDBCRelation((SELECT "income_id", "date_received", "amount", "source", "notes", "link_to_member" FROM "income") AS "income") [numPartitions=1] [link_to_member#12866] PushedFilters: [*IsNotNull(amount), *GreaterThan(amount,40), *IsNotNull(link_to_member)], ReadSchema: struct<link_to_member:string>
================================================================================