{
    "query_id": 28,
    "difficulty": "challenging",
    "is_initial": true,
    "nl_query": "Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average. Difference between K-12 enrollment and 15-17 enrollment can be computed by `Enrollment (K-12)` - `Enrollment (Ages 5-17)`",
    "golden_query": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')",
    "sparksql_query": "SELECT s.School, s.DOCType FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE s.FundingType = 'Local' AND (f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > ( SELECT AVG(f2.`Enrollment (K-12)` - f2.`Enrollment (Ages 5-17)`) FROM schools AS s2 JOIN frpm AS f2 ON s2.CDSCode = f2.CDSCode WHERE s2.FundingType = 'Local' ) ORDER BY s.School;",
    "jaccard_index": 0.0,
    "exact_match": 0,
    "ground_truth": [
        {
            "School": "Forest Charter",
            "DOC": "00"
        },
        {
            "School": "YES Academy",
            "DOC": "54"
        },
        {
            "School": "The Education Corps",
            "DOC": "00"
        },
        {
            "School": "Denair Charter Academy",
            "DOC": "54"
        },
        {
            "School": "Yuba County Career Preparatory Charter",
            "DOC": "00"
        },
        {
            "School": "Pomelo Community Charter",
            "DOC": "54"
        },
        {
            "School": "Elk Grove Charter",
            "DOC": "54"
        },
        {
            "School": "Taft Charter High",
            "DOC": "54"
        },
        {
            "School": "Delta Charter Online",
            "DOC": "52"
        },
        {
            "School": "San Juan Choices Charter",
            "DOC": "54"
        },
        {
            "School": "Madera County Independent Academy",
            "DOC": "00"
        },
        {
            "School": "Monterey County Home Charter",
            "DOC": "00"
        },
        {
            "School": "Stanislaus Alternative Charter",
            "DOC": "00"
        },
        {
            "School": "Rosemary Elementary",
            "DOC": "52"
        },
        {
            "School": "Pioneer Technical Center",
            "DOC": "00"
        },
        {
            "School": "Butterfield Charter High",
            "DOC": "54"
        },
        {
            "School": "Sylmar Charter High",
            "DOC": "54"
        },
        {
            "School": "Stockton High",
            "DOC": "54"
        },
        {
            "School": "Grover Cleveland Charter High",
            "DOC": "54"
        },
        {
            "School": "Delta Home Charter",
            "DOC": "52"
        },
        {
            "School": "Westwood Charter Elementary",
            "DOC": "54"
        },
        {
            "School": "Calahan Community Charter",
            "DOC": "54"
        },
        {
            "School": "Delta Charter",
            "DOC": "52"
        },
        {
            "School": "Arundel Elementary",
            "DOC": "52"
        },
        {
            "School": "Carpenter Community Charter",
            "DOC": "54"
        },
        {
            "School": "Lynhaven Elementary",
            "DOC": "52"
        },
        {
            "School": "Clovis Online Charter",
            "DOC": "54"
        },
        {
            "School": "Visalia Charter Independent Study",
            "DOC": "54"
        },
        {
            "School": "Chatsworth Charter High",
            "DOC": "54"
        },
        {
            "School": "Pacific Coast Charter",
            "DOC": "54"
        },
        {
            "School": "Mountain Oaks",
            "DOC": "00"
        },
        {
            "School": "Gateway to College Academy",
            "DOC": "56"
        },
        {
            "School": "Wilbur Charter For Enriched Academics",
            "DOC": "54"
        },
        {
            "School": "Grizzly ChalleNGe Charter",
            "DOC": "00"
        },
        {
            "School": "Kings River-Hardwick Elementary",
            "DOC": "52"
        },
        {
            "School": "Riverside Preparatory",
            "DOC": "52"
        },
        {
            "School": "Summit Charter Academy",
            "DOC": "52"
        },
        {
            "School": "George Washington Charter",
            "DOC": "54"
        },
        {
            "School": "Visions In Education",
            "DOC": "54"
        },
        {
            "School": "Castlemont Elementary",
            "DOC": "52"
        },
        {
            "School": "Castle Rock",
            "DOC": "00"
        },
        {
            "School": "Natomas Charter",
            "DOC": "54"
        },
        {
            "School": "Washington Elementary",
            "DOC": "52"
        },
        {
            "School": "YouthBuild Charter School of California",
            "DOC": "00"
        },
        {
            "School": "Soledad Enrichment Action Charter High",
            "DOC": "00"
        },
        {
            "School": "Mattole Valley Charter (#159)",
            "DOC": "54"
        },
        {
            "School": "Kern Workforce 2000 Academy",
            "DOC": "56"
        },
        {
            "School": "Fammatre Elementary",
            "DOC": "52"
        },
        {
            "School": "West Park Charter Academy",
            "DOC": "52"
        },
        {
            "School": "Serrania Avenue Charter For Enriched Studies",
            "DOC": "54"
        },
        {
            "School": "School of Extended Educational Options",
            "DOC": "54"
        },
        {
            "School": "Come Back Kids",
            "DOC": "00"
        },
        {
            "School": "Marlton",
            "DOC": "54"
        },
        {
            "School": "Union Hill Elementary",
            "DOC": "52"
        },
        {
            "School": "Fairmont Charter Elementary",
            "DOC": "54"
        },
        {
            "School": "College Bridge Academy",
            "DOC": "00"
        },
        {
            "School": "Charter Community School Home Study Academy",
            "DOC": "00"
        }
    ],
    "query_result": [],
    "execution_plans": {
        "golden_query": "\nExecution Plan for: Golden Query ID 28...\n================================================================================\n\n1. Logical plan:\n----------------------------------------\n'Project ['T2.School, 'T2.DOC]\n+- 'Filter (('T2.FundingType = Locally funded) AND (('T1.Enrollment (K-12) - 'T1.Enrollment (Ages 5-17)) > scalar-subquery#34123 []))\n   :  +- 'Project [unresolvedalias('AVG(('T3.Enrollment (K-12) - 'T3.Enrollment (Ages 5-17))))]\n   :     +- 'Filter ('T4.FundingType = Locally funded)\n   :        +- 'Join Inner, ('T3.CDSCode = 'T4.CDSCode)\n   :           :- 'SubqueryAlias T3\n   :           :  +- 'UnresolvedRelation [frpm], [], false\n   :           +- 'SubqueryAlias T4\n   :              +- 'UnresolvedRelation [schools], [], false\n   +- 'Join Inner, ('T1.CDSCode = 'T2.CDSCode)\n      :- 'SubqueryAlias T1\n      :  +- 'UnresolvedRelation [frpm], [], false\n      +- 'SubqueryAlias T2\n         +- 'UnresolvedRelation [schools], [], false\n\n\n2. Optimized logical plan (After Catalyst AFAIK):\n----------------------------------------\nProject [School#34080, DOC#34099]\n+- Join Inner, (CDSCode#34034 = CDSCode#34074)\n   :- Project [CDSCode#34034]\n   :  +- Filter (((isnotnull(Enrollment (K-12)#34052) AND isnotnull(Enrollment (Ages 5-17)#34057)) AND ((Enrollment (K-12)#34052 - Enrollment (Ages 5-17)#34057) > scalar-subquery#34123 [])) AND isnotnull(CDSCode#34034))\n   :     :  +- Aggregate [avg((Enrollment (K-12)#34144 - Enrollment (Ages 5-17)#34149)) AS avg((Enrollment (K-12) - Enrollment (Ages 5-17)))#34125]\n   :     :     +- Project [Enrollment (K-12)#34144, Enrollment (Ages 5-17)#34149]\n   :     :        +- Join Inner, (CDSCode#34126 = CDSCode#34155)\n   :     :           :- Project [CDSCode#34126, Enrollment (K-12)#34144, Enrollment (Ages 5-17)#34149]\n   :     :           :  +- Filter isnotnull(CDSCode#34126)\n   :     :           :     +- Relation [CDSCode#34126,Academic Year#34127,County Code#34128,District Code#34129,School Code#34130,County Name#34131,District Name#34132,School Name#34133,District Type#34134,School Type#34135,Educational Option Type#34136,NSLP Provision Status#34137,Charter School (Y/N)#34138,Charter School Number#34139,Charter Funding Type#34140,IRC#34141,Low Grade#34142,High Grade#34143,Enrollment (K-12)#34144,Free Meal Count (K-12)#34145,Percent (%) Eligible Free (K-12)#34146,FRPM Count (K-12)#34147,Percent (%) Eligible FRPM (K-12)#34148,Enrollment (Ages 5-17)#34149,Free Meal Count (Ages 5-17)#34150,... 4 more fields] JDBCRelation((SELECT \"CDSCode\", \"Academic Year\", \"County Code\", \"District Code\", \"School Code\", \"County Name\", \"District Name\", \"School Name\", \"District Type\", \"School Type\", \"Educational Option Type\", \"NSLP Provision Status\", \"Charter School (Y/N)\", \"Charter School Number\", \"Charter Funding Type\", \"IRC\", \"Low Grade\", \"High Grade\", \"Enrollment (K-12)\", \"Free Meal Count (K-12)\", \"Percent (%) Eligible Free (K-12)\", \"FRPM Count (K-12)\", \"Percent (%) Eligible FRPM (K-12)\", \"Enrollment (Ages 5-17)\", \"Free Meal Count (Ages 5-17)\", \"Percent (%) Eligible Free (Ages 5-17)\", \"FRPM Count (Ages 5-17)\", \"Percent (%) Eligible FRPM (Ages 5-17)\", \"2013-14 CALPADS Fall 1 Certification Status\" FROM \"frpm\") AS \"frpm\") [numPartitions=1]\n   :     :           +- Project [CDSCode#34155]\n   :     :              +- Filter ((isnotnull(FundingType#34179) AND (FundingType#34179 = Locally funded)) AND isnotnull(CDSCode#34155))\n   :     :                 +- Relation [CDSCode#34155,NCESDist#34156,NCESSchool#34157,StatusType#34158,County#34159,District#34160,School#34161,Street#34162,StreetAbr#34163,City#34164,Zip#34165,State#34166,MailStreet#34167,MailStrAbr#34168,MailCity#34169,MailZip#34170,MailState#34171,Phone#34172,Ext#34173,Website#34174,OpenDate#34175,ClosedDate#34176,Charter#34177,CharterNum#34178,FundingType#34179,... 24 more fields] JDBCRelation((SELECT \"CDSCode\", \"NCESDist\", \"NCESSchool\", \"StatusType\", \"County\", \"District\", \"School\", \"Street\", \"StreetAbr\", \"City\", \"Zip\", \"State\", \"MailStreet\", \"MailStrAbr\", \"MailCity\", \"MailZip\", \"MailState\", \"Phone\", \"Ext\", \"Website\", CAST(\"OpenDate\" AS TEXT) AS \"OpenDate\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"Charter\", \"CharterNum\", \"FundingType\", \"DOC\", \"DOCType\", \"SOC\", \"SOCType\", \"EdOpsCode\", \"EdOpsName\", \"EILCode\", \"EILName\", \"GSoffered\", \"GSserved\", \"Virtual\", \"Magnet\", \"Latitude\", \"Longitude\", \"AdmFName1\", \"AdmLName1\", \"AdmEmail1\", \"AdmFName2\", \"AdmLName2\", \"AdmEmail2\", \"AdmFName3\", \"AdmLName3\", \"AdmEmail3\", CAST(\"LastUpdate\" AS TEXT) AS \"LastUpdate\" FROM \"schools\") AS \"schools\") [numPartitions=1]\n   :     +- Relation [CDSCode#34034,Academic Year#34035,County Code#34036,District Code#34037,School Code#34038,County Name#34039,District Name#34040,School Name#34041,District Type#34042,School Type#34043,Educational Option Type#34044,NSLP Provision Status#34045,Charter School (Y/N)#34046,Charter School Number#34047,Charter Funding Type#34048,IRC#34049,Low Grade#34050,High Grade#34051,Enrollment (K-12)#34052,Free Meal Count (K-12)#34053,Percent (%) Eligible Free (K-12)#34054,FRPM Count (K-12)#34055,Percent (%) Eligible FRPM (K-12)#34056,Enrollment (Ages 5-17)#34057,Free Meal Count (Ages 5-17)#34058,... 4 more fields] JDBCRelation((SELECT \"CDSCode\", \"Academic Year\", \"County Code\", \"District Code\", \"School Code\", \"County Name\", \"District Name\", \"School Name\", \"District Type\", \"School Type\", \"Educational Option Type\", \"NSLP Provision Status\", \"Charter School (Y/N)\", \"Charter School Number\", \"Charter Funding Type\", \"IRC\", \"Low Grade\", \"High Grade\", \"Enrollment (K-12)\", \"Free Meal Count (K-12)\", \"Percent (%) Eligible Free (K-12)\", \"FRPM Count (K-12)\", \"Percent (%) Eligible FRPM (K-12)\", \"Enrollment (Ages 5-17)\", \"Free Meal Count (Ages 5-17)\", \"Percent (%) Eligible Free (Ages 5-17)\", \"FRPM Count (Ages 5-17)\", \"Percent (%) Eligible FRPM (Ages 5-17)\", \"2013-14 CALPADS Fall 1 Certification Status\" FROM \"frpm\") AS \"frpm\") [numPartitions=1]\n   +- Project [CDSCode#34074, School#34080, DOC#34099]\n      +- Filter ((isnotnull(FundingType#34098) AND (FundingType#34098 = Locally funded)) AND isnotnull(CDSCode#34074))\n         +- Relation [CDSCode#34074,NCESDist#34075,NCESSchool#34076,StatusType#34077,County#34078,District#34079,School#34080,Street#34081,StreetAbr#34082,City#34083,Zip#34084,State#34085,MailStreet#34086,MailStrAbr#34087,MailCity#34088,MailZip#34089,MailState#34090,Phone#34091,Ext#34092,Website#34093,OpenDate#34094,ClosedDate#34095,Charter#34096,CharterNum#34097,FundingType#34098,... 24 more fields] JDBCRelation((SELECT \"CDSCode\", \"NCESDist\", \"NCESSchool\", \"StatusType\", \"County\", \"District\", \"School\", \"Street\", \"StreetAbr\", \"City\", \"Zip\", \"State\", \"MailStreet\", \"MailStrAbr\", \"MailCity\", \"MailZip\", \"MailState\", \"Phone\", \"Ext\", \"Website\", CAST(\"OpenDate\" AS TEXT) AS \"OpenDate\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"Charter\", \"CharterNum\", \"FundingType\", \"DOC\", \"DOCType\", \"SOC\", \"SOCType\", \"EdOpsCode\", \"EdOpsName\", \"EILCode\", \"EILName\", \"GSoffered\", \"GSserved\", \"Virtual\", \"Magnet\", \"Latitude\", \"Longitude\", \"AdmFName1\", \"AdmLName1\", \"AdmEmail1\", \"AdmFName2\", \"AdmLName2\", \"AdmEmail2\", \"AdmFName3\", \"AdmLName3\", \"AdmEmail3\", CAST(\"LastUpdate\" AS TEXT) AS \"LastUpdate\" FROM \"schools\") AS \"schools\") [numPartitions=1]\n\n\n3. Physical plan:\n----------------------------------------\nAdaptiveSparkPlan isFinalPlan=false\n+- Project [School#34080, DOC#34099]\n  +- SortMergeJoin [CDSCode#34034], [CDSCode#34074], Inner\n      :- Sort [CDSCode#34034 ASC NULLS FIRST], false, 0\n      :  +- Exchange hashpartitioning(CDSCode#34034, 200), ENSURE_REQUIREMENTS, [plan_id=57368]\n      :     +- Project [CDSCode#34034]\n      :        +- Filter ((Enrollment (K-12)#34052 - Enrollment (Ages 5-17)#34057) > Subquery subquery#34123, [id=#57359])\n      :           :  +- Subquery subquery#34123, [id=#57359]\n      :           :     +- AdaptiveSparkPlan isFinalPlan=false\n      :           :        +- HashAggregate(keys=[], functions=[avg((Enrollment (K-12)#34144 - Enrollment (Ages 5-17)#34149))], output=[avg((Enrollment (K-12) - Enrollment (Ages 5-17)))#34125])\n      :           :           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=57357]\n      :           :              +- HashAggregate(keys=[], functions=[partial_avg((Enrollment (K-12)#34144 - Enrollment (Ages 5-17)#34149))], output=[sum#34206, count#34207L])\n      :           :                 +- Project [Enrollment (K-12)#34144, Enrollment (Ages 5-17)#34149]\n      :           :                    +- SortMergeJoin [CDSCode#34126], [CDSCode#34155], Inner\n      :           :                       :- Sort [CDSCode#34126 ASC NULLS FIRST], false, 0\n      :           :                       :  +- Exchange hashpartitioning(CDSCode#34126, 200), ENSURE_REQUIREMENTS, [plan_id=57349]\n      :           :                       :     +- Scan JDBCRelation((SELECT \"CDSCode\", \"Academic Year\", \"County Code\", \"District Code\", \"School Code\", \"County Name\", \"District Name\", \"School Name\", \"District Type\", \"School Type\", \"Educational Option Type\", \"NSLP Provision Status\", \"Charter School (Y/N)\", \"Charter School Number\", \"Charter Funding Type\", \"IRC\", \"Low Grade\", \"High Grade\", \"Enrollment (K-12)\", \"Free Meal Count (K-12)\", \"Percent (%) Eligible Free (K-12)\", \"FRPM Count (K-12)\", \"Percent (%) Eligible FRPM (K-12)\", \"Enrollment (Ages 5-17)\", \"Free Meal Count (Ages 5-17)\", \"Percent (%) Eligible Free (Ages 5-17)\", \"FRPM Count (Ages 5-17)\", \"Percent (%) Eligible FRPM (Ages 5-17)\", \"2013-14 CALPADS Fall 1 Certification Status\" FROM \"frpm\") AS \"frpm\") [numPartitions=1] [CDSCode#34126,Enrollment (K-12)#34144,Enrollment (Ages 5-17)#34149] PushedFilters: [*IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,Enrollment (K-12):double,Enrollment (Ages 5-17):double>\n      :           :                       +- Sort [CDSCode#34155 ASC NULLS FIRST], false, 0\n      :           :                          +- Exchange hashpartitioning(CDSCode#34155, 200), ENSURE_REQUIREMENTS, [plan_id=57350]\n      :           :                             +- Scan JDBCRelation((SELECT \"CDSCode\", \"NCESDist\", \"NCESSchool\", \"StatusType\", \"County\", \"District\", \"School\", \"Street\", \"StreetAbr\", \"City\", \"Zip\", \"State\", \"MailStreet\", \"MailStrAbr\", \"MailCity\", \"MailZip\", \"MailState\", \"Phone\", \"Ext\", \"Website\", CAST(\"OpenDate\" AS TEXT) AS \"OpenDate\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"Charter\", \"CharterNum\", \"FundingType\", \"DOC\", \"DOCType\", \"SOC\", \"SOCType\", \"EdOpsCode\", \"EdOpsName\", \"EILCode\", \"EILName\", \"GSoffered\", \"GSserved\", \"Virtual\", \"Magnet\", \"Latitude\", \"Longitude\", \"AdmFName1\", \"AdmLName1\", \"AdmEmail1\", \"AdmFName2\", \"AdmLName2\", \"AdmEmail2\", \"AdmFName3\", \"AdmLName3\", \"AdmEmail3\", CAST(\"LastUpdate\" AS TEXT) AS \"LastUpdate\" FROM \"schools\") AS \"schools\") [numPartitions=1] [CDSCode#34155] PushedFilters: [*IsNotNull(FundingType), *EqualTo(FundingType,Locally funded), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string>\n      :           +- Scan JDBCRelation((SELECT \"CDSCode\", \"Academic Year\", \"County Code\", \"District Code\", \"School Code\", \"County Name\", \"District Name\", \"School Name\", \"District Type\", \"School Type\", \"Educational Option Type\", \"NSLP Provision Status\", \"Charter School (Y/N)\", \"Charter School Number\", \"Charter Funding Type\", \"IRC\", \"Low Grade\", \"High Grade\", \"Enrollment (K-12)\", \"Free Meal Count (K-12)\", \"Percent (%) Eligible Free (K-12)\", \"FRPM Count (K-12)\", \"Percent (%) Eligible FRPM (K-12)\", \"Enrollment (Ages 5-17)\", \"Free Meal Count (Ages 5-17)\", \"Percent (%) Eligible Free (Ages 5-17)\", \"FRPM Count (Ages 5-17)\", \"Percent (%) Eligible FRPM (Ages 5-17)\", \"2013-14 CALPADS Fall 1 Certification Status\" FROM \"frpm\") AS \"frpm\") [numPartitions=1] [CDSCode#34034,Enrollment (K-12)#34052,Enrollment (Ages 5-17)#34057] PushedFilters: [*IsNotNull(Enrollment (K-12)), *IsNotNull(Enrollment (Ages 5-17)), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,Enrollment (K-12):double,Enrollment (Ages 5-17):double>\n      +- Sort [CDSCode#34074 ASC NULLS FIRST], false, 0\n        +- Exchange hashpartitioning(CDSCode#34074, 200), ENSURE_REQUIREMENTS, [plan_id=57369]\n            +- Scan JDBCRelation((SELECT \"CDSCode\", \"NCESDist\", \"NCESSchool\", \"StatusType\", \"County\", \"District\", \"School\", \"Street\", \"StreetAbr\", \"City\", \"Zip\", \"State\", \"MailStreet\", \"MailStrAbr\", \"MailCity\", \"MailZip\", \"MailState\", \"Phone\", \"Ext\", \"Website\", CAST(\"OpenDate\" AS TEXT) AS \"OpenDate\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"Charter\", \"CharterNum\", \"FundingType\", \"DOC\", \"DOCType\", \"SOC\", \"SOCType\", \"EdOpsCode\", \"EdOpsName\", \"EILCode\", \"EILName\", \"GSoffered\", \"GSserved\", \"Virtual\", \"Magnet\", \"Latitude\", \"Longitude\", \"AdmFName1\", \"AdmLName1\", \"AdmEmail1\", \"AdmFName2\", \"AdmLName2\", \"AdmEmail2\", \"AdmFName3\", \"AdmLName3\", \"AdmEmail3\", CAST(\"LastUpdate\" AS TEXT) AS \"LastUpdate\" FROM \"schools\") AS \"schools\") [numPartitions=1] [CDSCode#34074,School#34080,DOC#34099] PushedFilters: [*IsNotNull(FundingType), *EqualTo(FundingType,Locally funded), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,School:string,DOC:string>\n\n4. Explain output:\n----------------------------------------\n\nPhysical Plan ==:\n-----------------\n  AdaptiveSparkPlan isFinalPlan=false\n  +- Project [School#34080, DOC#34099]\n  +- SortMergeJoin [CDSCode#34034], [CDSCode#34074], Inner\n  :- Sort [CDSCode#34034 ASC NULLS FIRST], false, 0\n  :  +- Exchange hashpartitioning(CDSCode#34034, 200), ENSURE_REQUIREMENTS, [plan_id=57440]\n  :     +- Project [CDSCode#34034]\n  :        +- Filter ((Enrollment (K-12)#34052 - Enrollment (Ages 5-17)#34057) > Subquery subquery#34208, [id=#57431])\n  :           :  +- Subquery subquery#34208, [id=#57431]\n  :           :     +- AdaptiveSparkPlan isFinalPlan=false\n  :           :        +- HashAggregate(keys=[], functions=[avg((Enrollment (K-12)#34233 - Enrollment (Ages 5-17)#34238))])\n  :           :           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=57429]\n  :           :              +- HashAggregate(keys=[], functions=[partial_avg((Enrollment (K-12)#34233 - Enrollment (Ages 5-17)#34238))])\n  :           :                 +- Project [Enrollment (K-12)#34233, Enrollment (Ages 5-17)#34238]\n  :           :                    +- SortMergeJoin [CDSCode#34215], [CDSCode#34244], Inner\n  :           :                       :- Sort [CDSCode#34215 ASC NULLS FIRST], false, 0\n  :           :                       :  +- Exchange hashpartitioning(CDSCode#34215, 200), ENSURE_REQUIREMENTS, [plan_id=57421]\n  :           :                       :     +- Scan JDBCRelation((SELECT \"CDSCode\", \"Academic Year\", \"County Code\", \"District Code\", \"School Code\", \"County Name\", \"District Name\", \"School Name\", \"District Type\", \"School Type\", \"Educational Option Type\", \"NSLP Provision Status\", \"Charter School (Y/N)\", \"Charter School Number\", \"Charter Funding Type\", \"IRC\", \"Low Grade\", \"High Grade\", \"Enrollment (K-12)\", \"Free Meal Count (K-12)\", \"Percent (%) Eligible Free (K-12)\", \"FRPM Count (K-12)\", \"Percent (%) Eligible FRPM (K-12)\", \"Enrollment (Ages 5-17)\", \"Free Meal Count (Ages 5-17)\", \"Percent (%) Eligible Free (Ages 5-17)\", \"FRPM Count (Ages 5-17)\", \"Percent (%) Eligible FRPM (Ages 5-17)\", \"2013-14 CALPADS Fall 1 Certification Status\" FROM \"frpm\") AS \"frpm\") [numPartitions=1] [CDSCode#34215,Enrollment (K-12)#34233,Enrollment (Ages 5-17)#34238] PushedFilters: [*IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,Enrollment (K-12):double,Enrollment (Ages 5-17):double>\n  :           :                       +- Sort [CDSCode#34244 ASC NULLS FIRST], false, 0\n  :           :                          +- Exchange hashpartitioning(CDSCode#34244, 200), ENSURE_REQUIREMENTS, [plan_id=57422]\n  :           :                             +- Scan JDBCRelation((SELECT \"CDSCode\", \"NCESDist\", \"NCESSchool\", \"StatusType\", \"County\", \"District\", \"School\", \"Street\", \"StreetAbr\", \"City\", \"Zip\", \"State\", \"MailStreet\", \"MailStrAbr\", \"MailCity\", \"MailZip\", \"MailState\", \"Phone\", \"Ext\", \"Website\", CAST(\"OpenDate\" AS TEXT) AS \"OpenDate\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"Charter\", \"CharterNum\", \"FundingType\", \"DOC\", \"DOCType\", \"SOC\", \"SOCType\", \"EdOpsCode\", \"EdOpsName\", \"EILCode\", \"EILName\", \"GSoffered\", \"GSserved\", \"Virtual\", \"Magnet\", \"Latitude\", \"Longitude\", \"AdmFName1\", \"AdmLName1\", \"AdmEmail1\", \"AdmFName2\", \"AdmLName2\", \"AdmEmail2\", \"AdmFName3\", \"AdmLName3\", \"AdmEmail3\", CAST(\"LastUpdate\" AS TEXT) AS \"LastUpdate\" FROM \"schools\") AS \"schools\") [numPartitions=1] [CDSCode#34244] PushedFilters: [*IsNotNull(FundingType), *EqualTo(FundingType,Locally funded), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string>\n  :           +- Scan JDBCRelation((SELECT \"CDSCode\", \"Academic Year\", \"County Code\", \"District Code\", \"School Code\", \"County Name\", \"District Name\", \"School Name\", \"District Type\", \"School Type\", \"Educational Option Type\", \"NSLP Provision Status\", \"Charter School (Y/N)\", \"Charter School Number\", \"Charter Funding Type\", \"IRC\", \"Low Grade\", \"High Grade\", \"Enrollment (K-12)\", \"Free Meal Count (K-12)\", \"Percent (%) Eligible Free (K-12)\", \"FRPM Count (K-12)\", \"Percent (%) Eligible FRPM (K-12)\", \"Enrollment (Ages 5-17)\", \"Free Meal Count (Ages 5-17)\", \"Percent (%) Eligible Free (Ages 5-17)\", \"FRPM Count (Ages 5-17)\", \"Percent (%) Eligible FRPM (Ages 5-17)\", \"2013-14 CALPADS Fall 1 Certification Status\" FROM \"frpm\") AS \"frpm\") [numPartitions=1] [CDSCode#34034,Enrollment (K-12)#34052,Enrollment (Ages 5-17)#34057] PushedFilters: [*IsNotNull(Enrollment (K-12)), *IsNotNull(Enrollment (Ages 5-17)), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,Enrollment (K-12):double,Enrollment (Ages 5-17):double>\n  +- Sort [CDSCode#34074 ASC NULLS FIRST], false, 0\n  +- Exchange hashpartitioning(CDSCode#34074, 200), ENSURE_REQUIREMENTS, [plan_id=57441]\n  +- Scan JDBCRelation((SELECT \"CDSCode\", \"NCESDist\", \"NCESSchool\", \"StatusType\", \"County\", \"District\", \"School\", \"Street\", \"StreetAbr\", \"City\", \"Zip\", \"State\", \"MailStreet\", \"MailStrAbr\", \"MailCity\", \"MailZip\", \"MailState\", \"Phone\", \"Ext\", \"Website\", CAST(\"OpenDate\" AS TEXT) AS \"OpenDate\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"Charter\", \"CharterNum\", \"FundingType\", \"DOC\", \"DOCType\", \"SOC\", \"SOCType\", \"EdOpsCode\", \"EdOpsName\", \"EILCode\", \"EILName\", \"GSoffered\", \"GSserved\", \"Virtual\", \"Magnet\", \"Latitude\", \"Longitude\", \"AdmFName1\", \"AdmLName1\", \"AdmEmail1\", \"AdmFName2\", \"AdmLName2\", \"AdmEmail2\", \"AdmFName3\", \"AdmLName3\", \"AdmEmail3\", CAST(\"LastUpdate\" AS TEXT) AS \"LastUpdate\" FROM \"schools\") AS \"schools\") [numPartitions=1] [CDSCode#34074,School#34080,DOC#34099] PushedFilters: [*IsNotNull(FundingType), *EqualTo(FundingType,Locally funded), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,School:string,DOC:string>\n================================================================================",
        "model_query": "\nExecution Plan for: Model Query ID 28...\n================================================================================\n\n1. Logical plan:\n----------------------------------------\n'Sort ['s.School ASC NULLS FIRST], true\n+- 'Project ['s.School, 's.DOCType]\n   +- 'Filter (('s.FundingType = Local) AND (('f.Enrollment (K-12) - 'f.Enrollment (Ages 5-17)) > scalar-subquery#34297 []))\n      :  +- 'Project [unresolvedalias('AVG(('f2.Enrollment (K-12) - 'f2.Enrollment (Ages 5-17))))]\n      :     +- 'Filter ('s2.FundingType = Local)\n      :        +- 'Join Inner, ('s2.CDSCode = 'f2.CDSCode)\n      :           :- 'SubqueryAlias s2\n      :           :  +- 'UnresolvedRelation [schools], [], false\n      :           +- 'SubqueryAlias f2\n      :              +- 'UnresolvedRelation [frpm], [], false\n      +- 'Join Inner, ('s.CDSCode = 'f.CDSCode)\n         :- 'SubqueryAlias s\n         :  +- 'UnresolvedRelation [schools], [], false\n         +- 'SubqueryAlias f\n            +- 'UnresolvedRelation [frpm], [], false\n\n\n2. Optimized logical plan (After Catalyst AFAIK):\n----------------------------------------\nSort [School#34080 ASC NULLS FIRST], true\n+- Project [School#34080, DOCType#34100]\n   +- Join Inner, (CDSCode#34074 = CDSCode#34034)\n      :- Project [CDSCode#34074, School#34080, DOCType#34100]\n      :  +- Filter ((isnotnull(FundingType#34098) AND (FundingType#34098 = Local)) AND isnotnull(CDSCode#34074))\n      :     +- Relation [CDSCode#34074,NCESDist#34075,NCESSchool#34076,StatusType#34077,County#34078,District#34079,School#34080,Street#34081,StreetAbr#34082,City#34083,Zip#34084,State#34085,MailStreet#34086,MailStrAbr#34087,MailCity#34088,MailZip#34089,MailState#34090,Phone#34091,Ext#34092,Website#34093,OpenDate#34094,ClosedDate#34095,Charter#34096,CharterNum#34097,FundingType#34098,... 24 more fields] JDBCRelation((SELECT \"CDSCode\", \"NCESDist\", \"NCESSchool\", \"StatusType\", \"County\", \"District\", \"School\", \"Street\", \"StreetAbr\", \"City\", \"Zip\", \"State\", \"MailStreet\", \"MailStrAbr\", \"MailCity\", \"MailZip\", \"MailState\", \"Phone\", \"Ext\", \"Website\", CAST(\"OpenDate\" AS TEXT) AS \"OpenDate\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"Charter\", \"CharterNum\", \"FundingType\", \"DOC\", \"DOCType\", \"SOC\", \"SOCType\", \"EdOpsCode\", \"EdOpsName\", \"EILCode\", \"EILName\", \"GSoffered\", \"GSserved\", \"Virtual\", \"Magnet\", \"Latitude\", \"Longitude\", \"AdmFName1\", \"AdmLName1\", \"AdmEmail1\", \"AdmFName2\", \"AdmLName2\", \"AdmEmail2\", \"AdmFName3\", \"AdmLName3\", \"AdmEmail3\", CAST(\"LastUpdate\" AS TEXT) AS \"LastUpdate\" FROM \"schools\") AS \"schools\") [numPartitions=1]\n      +- Project [CDSCode#34034]\n         +- Filter (((isnotnull(Enrollment (K-12)#34052) AND isnotnull(Enrollment (Ages 5-17)#34057)) AND ((Enrollment (K-12)#34052 - Enrollment (Ages 5-17)#34057) > scalar-subquery#34297 [])) AND isnotnull(CDSCode#34034))\n            :  +- Aggregate [avg((Enrollment (K-12)#34367 - Enrollment (Ages 5-17)#34372)) AS avg((Enrollment (K-12) - Enrollment (Ages 5-17)))#34299]\n            :     +- Project [Enrollment (K-12)#34367, Enrollment (Ages 5-17)#34372]\n            :        +- Join Inner, (CDSCode#34300 = CDSCode#34349)\n            :           :- Project [CDSCode#34300]\n            :           :  +- Filter ((isnotnull(FundingType#34324) AND (FundingType#34324 = Local)) AND isnotnull(CDSCode#34300))\n            :           :     +- Relation [CDSCode#34300,NCESDist#34301,NCESSchool#34302,StatusType#34303,County#34304,District#34305,School#34306,Street#34307,StreetAbr#34308,City#34309,Zip#34310,State#34311,MailStreet#34312,MailStrAbr#34313,MailCity#34314,MailZip#34315,MailState#34316,Phone#34317,Ext#34318,Website#34319,OpenDate#34320,ClosedDate#34321,Charter#34322,CharterNum#34323,FundingType#34324,... 24 more fields] JDBCRelation((SELECT \"CDSCode\", \"NCESDist\", \"NCESSchool\", \"StatusType\", \"County\", \"District\", \"School\", \"Street\", \"StreetAbr\", \"City\", \"Zip\", \"State\", \"MailStreet\", \"MailStrAbr\", \"MailCity\", \"MailZip\", \"MailState\", \"Phone\", \"Ext\", \"Website\", CAST(\"OpenDate\" AS TEXT) AS \"OpenDate\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"Charter\", \"CharterNum\", \"FundingType\", \"DOC\", \"DOCType\", \"SOC\", \"SOCType\", \"EdOpsCode\", \"EdOpsName\", \"EILCode\", \"EILName\", \"GSoffered\", \"GSserved\", \"Virtual\", \"Magnet\", \"Latitude\", \"Longitude\", \"AdmFName1\", \"AdmLName1\", \"AdmEmail1\", \"AdmFName2\", \"AdmLName2\", \"AdmEmail2\", \"AdmFName3\", \"AdmLName3\", \"AdmEmail3\", CAST(\"LastUpdate\" AS TEXT) AS \"LastUpdate\" FROM \"schools\") AS \"schools\") [numPartitions=1]\n            :           +- Project [CDSCode#34349, Enrollment (K-12)#34367, Enrollment (Ages 5-17)#34372]\n            :              +- Filter isnotnull(CDSCode#34349)\n            :                 +- Relation [CDSCode#34349,Academic Year#34350,County Code#34351,District Code#34352,School Code#34353,County Name#34354,District Name#34355,School Name#34356,District Type#34357,School Type#34358,Educational Option Type#34359,NSLP Provision Status#34360,Charter School (Y/N)#34361,Charter School Number#34362,Charter Funding Type#34363,IRC#34364,Low Grade#34365,High Grade#34366,Enrollment (K-12)#34367,Free Meal Count (K-12)#34368,Percent (%) Eligible Free (K-12)#34369,FRPM Count (K-12)#34370,Percent (%) Eligible FRPM (K-12)#34371,Enrollment (Ages 5-17)#34372,Free Meal Count (Ages 5-17)#34373,... 4 more fields] JDBCRelation((SELECT \"CDSCode\", \"Academic Year\", \"County Code\", \"District Code\", \"School Code\", \"County Name\", \"District Name\", \"School Name\", \"District Type\", \"School Type\", \"Educational Option Type\", \"NSLP Provision Status\", \"Charter School (Y/N)\", \"Charter School Number\", \"Charter Funding Type\", \"IRC\", \"Low Grade\", \"High Grade\", \"Enrollment (K-12)\", \"Free Meal Count (K-12)\", \"Percent (%) Eligible Free (K-12)\", \"FRPM Count (K-12)\", \"Percent (%) Eligible FRPM (K-12)\", \"Enrollment (Ages 5-17)\", \"Free Meal Count (Ages 5-17)\", \"Percent (%) Eligible Free (Ages 5-17)\", \"FRPM Count (Ages 5-17)\", \"Percent (%) Eligible FRPM (Ages 5-17)\", \"2013-14 CALPADS Fall 1 Certification Status\" FROM \"frpm\") AS \"frpm\") [numPartitions=1]\n            +- Relation [CDSCode#34034,Academic Year#34035,County Code#34036,District Code#34037,School Code#34038,County Name#34039,District Name#34040,School Name#34041,District Type#34042,School Type#34043,Educational Option Type#34044,NSLP Provision Status#34045,Charter School (Y/N)#34046,Charter School Number#34047,Charter Funding Type#34048,IRC#34049,Low Grade#34050,High Grade#34051,Enrollment (K-12)#34052,Free Meal Count (K-12)#34053,Percent (%) Eligible Free (K-12)#34054,FRPM Count (K-12)#34055,Percent (%) Eligible FRPM (K-12)#34056,Enrollment (Ages 5-17)#34057,Free Meal Count (Ages 5-17)#34058,... 4 more fields] JDBCRelation((SELECT \"CDSCode\", \"Academic Year\", \"County Code\", \"District Code\", \"School Code\", \"County Name\", \"District Name\", \"School Name\", \"District Type\", \"School Type\", \"Educational Option Type\", \"NSLP Provision Status\", \"Charter School (Y/N)\", \"Charter School Number\", \"Charter Funding Type\", \"IRC\", \"Low Grade\", \"High Grade\", \"Enrollment (K-12)\", \"Free Meal Count (K-12)\", \"Percent (%) Eligible Free (K-12)\", \"FRPM Count (K-12)\", \"Percent (%) Eligible FRPM (K-12)\", \"Enrollment (Ages 5-17)\", \"Free Meal Count (Ages 5-17)\", \"Percent (%) Eligible Free (Ages 5-17)\", \"FRPM Count (Ages 5-17)\", \"Percent (%) Eligible FRPM (Ages 5-17)\", \"2013-14 CALPADS Fall 1 Certification Status\" FROM \"frpm\") AS \"frpm\") [numPartitions=1]\n\n\n3. Physical plan:\n----------------------------------------\nAdaptiveSparkPlan isFinalPlan=false\n+- Sort [School#34080 ASC NULLS FIRST], true, 0\n  +- Exchange rangepartitioning(School#34080 ASC NULLS FIRST, 200), ENSURE_REQUIREMENTS, [plan_id=57525]\n      +- Project [School#34080, DOCType#34100]\n        +- SortMergeJoin [CDSCode#34074], [CDSCode#34034], Inner\n            :- Sort [CDSCode#34074 ASC NULLS FIRST], false, 0\n            :  +- Exchange hashpartitioning(CDSCode#34074, 200), ENSURE_REQUIREMENTS, [plan_id=57518]\n            :     +- Scan JDBCRelation((SELECT \"CDSCode\", \"NCESDist\", \"NCESSchool\", \"StatusType\", \"County\", \"District\", \"School\", \"Street\", \"StreetAbr\", \"City\", \"Zip\", \"State\", \"MailStreet\", \"MailStrAbr\", \"MailCity\", \"MailZip\", \"MailState\", \"Phone\", \"Ext\", \"Website\", CAST(\"OpenDate\" AS TEXT) AS \"OpenDate\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"Charter\", \"CharterNum\", \"FundingType\", \"DOC\", \"DOCType\", \"SOC\", \"SOCType\", \"EdOpsCode\", \"EdOpsName\", \"EILCode\", \"EILName\", \"GSoffered\", \"GSserved\", \"Virtual\", \"Magnet\", \"Latitude\", \"Longitude\", \"AdmFName1\", \"AdmLName1\", \"AdmEmail1\", \"AdmFName2\", \"AdmLName2\", \"AdmEmail2\", \"AdmFName3\", \"AdmLName3\", \"AdmEmail3\", CAST(\"LastUpdate\" AS TEXT) AS \"LastUpdate\" FROM \"schools\") AS \"schools\") [numPartitions=1] [CDSCode#34074,School#34080,DOCType#34100] PushedFilters: [*IsNotNull(FundingType), *EqualTo(FundingType,Local), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,School:string,DOCType:string>\n            +- Sort [CDSCode#34034 ASC NULLS FIRST], false, 0\n              +- Exchange hashpartitioning(CDSCode#34034, 200), ENSURE_REQUIREMENTS, [plan_id=57519]\n                  +- Project [CDSCode#34034]\n                    +- Filter ((Enrollment (K-12)#34052 - Enrollment (Ages 5-17)#34057) > Subquery subquery#34297, [id=#57507])\n                        :  +- Subquery subquery#34297, [id=#57507]\n                        :     +- AdaptiveSparkPlan isFinalPlan=false\n                        :        +- HashAggregate(keys=[], functions=[avg((Enrollment (K-12)#34367 - Enrollment (Ages 5-17)#34372))], output=[avg((Enrollment (K-12) - Enrollment (Ages 5-17)))#34299])\n                        :           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=57505]\n                        :              +- HashAggregate(keys=[], functions=[partial_avg((Enrollment (K-12)#34367 - Enrollment (Ages 5-17)#34372))], output=[sum#34380, count#34381L])\n                        :                 +- Project [Enrollment (K-12)#34367, Enrollment (Ages 5-17)#34372]\n                        :                    +- SortMergeJoin [CDSCode#34300], [CDSCode#34349], Inner\n                        :                       :- Sort [CDSCode#34300 ASC NULLS FIRST], false, 0\n                        :                       :  +- Exchange hashpartitioning(CDSCode#34300, 200), ENSURE_REQUIREMENTS, [plan_id=57497]\n                        :                       :     +- Scan JDBCRelation((SELECT \"CDSCode\", \"NCESDist\", \"NCESSchool\", \"StatusType\", \"County\", \"District\", \"School\", \"Street\", \"StreetAbr\", \"City\", \"Zip\", \"State\", \"MailStreet\", \"MailStrAbr\", \"MailCity\", \"MailZip\", \"MailState\", \"Phone\", \"Ext\", \"Website\", CAST(\"OpenDate\" AS TEXT) AS \"OpenDate\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"Charter\", \"CharterNum\", \"FundingType\", \"DOC\", \"DOCType\", \"SOC\", \"SOCType\", \"EdOpsCode\", \"EdOpsName\", \"EILCode\", \"EILName\", \"GSoffered\", \"GSserved\", \"Virtual\", \"Magnet\", \"Latitude\", \"Longitude\", \"AdmFName1\", \"AdmLName1\", \"AdmEmail1\", \"AdmFName2\", \"AdmLName2\", \"AdmEmail2\", \"AdmFName3\", \"AdmLName3\", \"AdmEmail3\", CAST(\"LastUpdate\" AS TEXT) AS \"LastUpdate\" FROM \"schools\") AS \"schools\") [numPartitions=1] [CDSCode#34300] PushedFilters: [*IsNotNull(FundingType), *EqualTo(FundingType,Local), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string>\n                        :                       +- Sort [CDSCode#34349 ASC NULLS FIRST], false, 0\n                        :                          +- Exchange hashpartitioning(CDSCode#34349, 200), ENSURE_REQUIREMENTS, [plan_id=57498]\n                        :                             +- Scan JDBCRelation((SELECT \"CDSCode\", \"Academic Year\", \"County Code\", \"District Code\", \"School Code\", \"County Name\", \"District Name\", \"School Name\", \"District Type\", \"School Type\", \"Educational Option Type\", \"NSLP Provision Status\", \"Charter School (Y/N)\", \"Charter School Number\", \"Charter Funding Type\", \"IRC\", \"Low Grade\", \"High Grade\", \"Enrollment (K-12)\", \"Free Meal Count (K-12)\", \"Percent (%) Eligible Free (K-12)\", \"FRPM Count (K-12)\", \"Percent (%) Eligible FRPM (K-12)\", \"Enrollment (Ages 5-17)\", \"Free Meal Count (Ages 5-17)\", \"Percent (%) Eligible Free (Ages 5-17)\", \"FRPM Count (Ages 5-17)\", \"Percent (%) Eligible FRPM (Ages 5-17)\", \"2013-14 CALPADS Fall 1 Certification Status\" FROM \"frpm\") AS \"frpm\") [numPartitions=1] [CDSCode#34349,Enrollment (K-12)#34367,Enrollment (Ages 5-17)#34372] PushedFilters: [*IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,Enrollment (K-12):double,Enrollment (Ages 5-17):double>\n                        +- Scan JDBCRelation((SELECT \"CDSCode\", \"Academic Year\", \"County Code\", \"District Code\", \"School Code\", \"County Name\", \"District Name\", \"School Name\", \"District Type\", \"School Type\", \"Educational Option Type\", \"NSLP Provision Status\", \"Charter School (Y/N)\", \"Charter School Number\", \"Charter Funding Type\", \"IRC\", \"Low Grade\", \"High Grade\", \"Enrollment (K-12)\", \"Free Meal Count (K-12)\", \"Percent (%) Eligible Free (K-12)\", \"FRPM Count (K-12)\", \"Percent (%) Eligible FRPM (K-12)\", \"Enrollment (Ages 5-17)\", \"Free Meal Count (Ages 5-17)\", \"Percent (%) Eligible Free (Ages 5-17)\", \"FRPM Count (Ages 5-17)\", \"Percent (%) Eligible FRPM (Ages 5-17)\", \"2013-14 CALPADS Fall 1 Certification Status\" FROM \"frpm\") AS \"frpm\") [numPartitions=1] [CDSCode#34034,Enrollment (K-12)#34052,Enrollment (Ages 5-17)#34057] PushedFilters: [*IsNotNull(Enrollment (K-12)), *IsNotNull(Enrollment (Ages 5-17)), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,Enrollment (K-12):double,Enrollment (Ages 5-17):double>\n\n4. Explain output:\n----------------------------------------\n\nPhysical Plan ==:\n-----------------\n  AdaptiveSparkPlan isFinalPlan=false\n  +- Sort [School#34080 ASC NULLS FIRST], true, 0\n  +- Exchange rangepartitioning(School#34080 ASC NULLS FIRST, 200), ENSURE_REQUIREMENTS, [plan_id=57606]\n  +- Project [School#34080, DOCType#34100]\n  +- SortMergeJoin [CDSCode#34074], [CDSCode#34034], Inner\n  :- Sort [CDSCode#34074 ASC NULLS FIRST], false, 0\n  :  +- Exchange hashpartitioning(CDSCode#34074, 200), ENSURE_REQUIREMENTS, [plan_id=57599]\n  :     +- Scan JDBCRelation((SELECT \"CDSCode\", \"NCESDist\", \"NCESSchool\", \"StatusType\", \"County\", \"District\", \"School\", \"Street\", \"StreetAbr\", \"City\", \"Zip\", \"State\", \"MailStreet\", \"MailStrAbr\", \"MailCity\", \"MailZip\", \"MailState\", \"Phone\", \"Ext\", \"Website\", CAST(\"OpenDate\" AS TEXT) AS \"OpenDate\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"Charter\", \"CharterNum\", \"FundingType\", \"DOC\", \"DOCType\", \"SOC\", \"SOCType\", \"EdOpsCode\", \"EdOpsName\", \"EILCode\", \"EILName\", \"GSoffered\", \"GSserved\", \"Virtual\", \"Magnet\", \"Latitude\", \"Longitude\", \"AdmFName1\", \"AdmLName1\", \"AdmEmail1\", \"AdmFName2\", \"AdmLName2\", \"AdmEmail2\", \"AdmFName3\", \"AdmLName3\", \"AdmEmail3\", CAST(\"LastUpdate\" AS TEXT) AS \"LastUpdate\" FROM \"schools\") AS \"schools\") [numPartitions=1] [CDSCode#34074,School#34080,DOCType#34100] PushedFilters: [*IsNotNull(FundingType), *EqualTo(FundingType,Local), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,School:string,DOCType:string>\n  +- Sort [CDSCode#34034 ASC NULLS FIRST], false, 0\n  +- Exchange hashpartitioning(CDSCode#34034, 200), ENSURE_REQUIREMENTS, [plan_id=57600]\n  +- Project [CDSCode#34034]\n  +- Filter ((Enrollment (K-12)#34052 - Enrollment (Ages 5-17)#34057) > Subquery subquery#34382, [id=#57588])\n  :  +- Subquery subquery#34382, [id=#57588]\n  :     +- AdaptiveSparkPlan isFinalPlan=false\n  :        +- HashAggregate(keys=[], functions=[avg((Enrollment (K-12)#34456 - Enrollment (Ages 5-17)#34461))])\n  :           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=57586]\n  :              +- HashAggregate(keys=[], functions=[partial_avg((Enrollment (K-12)#34456 - Enrollment (Ages 5-17)#34461))])\n  :                 +- Project [Enrollment (K-12)#34456, Enrollment (Ages 5-17)#34461]\n  :                    +- SortMergeJoin [CDSCode#34389], [CDSCode#34438], Inner\n  :                       :- Sort [CDSCode#34389 ASC NULLS FIRST], false, 0\n  :                       :  +- Exchange hashpartitioning(CDSCode#34389, 200), ENSURE_REQUIREMENTS, [plan_id=57578]\n  :                       :     +- Scan JDBCRelation((SELECT \"CDSCode\", \"NCESDist\", \"NCESSchool\", \"StatusType\", \"County\", \"District\", \"School\", \"Street\", \"StreetAbr\", \"City\", \"Zip\", \"State\", \"MailStreet\", \"MailStrAbr\", \"MailCity\", \"MailZip\", \"MailState\", \"Phone\", \"Ext\", \"Website\", CAST(\"OpenDate\" AS TEXT) AS \"OpenDate\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"Charter\", \"CharterNum\", \"FundingType\", \"DOC\", \"DOCType\", \"SOC\", \"SOCType\", \"EdOpsCode\", \"EdOpsName\", \"EILCode\", \"EILName\", \"GSoffered\", \"GSserved\", \"Virtual\", \"Magnet\", \"Latitude\", \"Longitude\", \"AdmFName1\", \"AdmLName1\", \"AdmEmail1\", \"AdmFName2\", \"AdmLName2\", \"AdmEmail2\", \"AdmFName3\", \"AdmLName3\", \"AdmEmail3\", CAST(\"LastUpdate\" AS TEXT) AS \"LastUpdate\" FROM \"schools\") AS \"schools\") [numPartitions=1] [CDSCode#34389] PushedFilters: [*IsNotNull(FundingType), *EqualTo(FundingType,Local), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string>\n  :                       +- Sort [CDSCode#34438 ASC NULLS FIRST], false, 0\n  :                          +- Exchange hashpartitioning(CDSCode#34438, 200), ENSURE_REQUIREMENTS, [plan_id=57579]\n  :                             +- Scan JDBCRelation((SELECT \"CDSCode\", \"Academic Year\", \"County Code\", \"District Code\", \"School Code\", \"County Name\", \"District Name\", \"School Name\", \"District Type\", \"School Type\", \"Educational Option Type\", \"NSLP Provision Status\", \"Charter School (Y/N)\", \"Charter School Number\", \"Charter Funding Type\", \"IRC\", \"Low Grade\", \"High Grade\", \"Enrollment (K-12)\", \"Free Meal Count (K-12)\", \"Percent (%) Eligible Free (K-12)\", \"FRPM Count (K-12)\", \"Percent (%) Eligible FRPM (K-12)\", \"Enrollment (Ages 5-17)\", \"Free Meal Count (Ages 5-17)\", \"Percent (%) Eligible Free (Ages 5-17)\", \"FRPM Count (Ages 5-17)\", \"Percent (%) Eligible FRPM (Ages 5-17)\", \"2013-14 CALPADS Fall 1 Certification Status\" FROM \"frpm\") AS \"frpm\") [numPartitions=1] [CDSCode#34438,Enrollment (K-12)#34456,Enrollment (Ages 5-17)#34461] PushedFilters: [*IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,Enrollment (K-12):double,Enrollment (Ages 5-17):double>\n  +- Scan JDBCRelation((SELECT \"CDSCode\", \"Academic Year\", \"County Code\", \"District Code\", \"School Code\", \"County Name\", \"District Name\", \"School Name\", \"District Type\", \"School Type\", \"Educational Option Type\", \"NSLP Provision Status\", \"Charter School (Y/N)\", \"Charter School Number\", \"Charter Funding Type\", \"IRC\", \"Low Grade\", \"High Grade\", \"Enrollment (K-12)\", \"Free Meal Count (K-12)\", \"Percent (%) Eligible Free (K-12)\", \"FRPM Count (K-12)\", \"Percent (%) Eligible FRPM (K-12)\", \"Enrollment (Ages 5-17)\", \"Free Meal Count (Ages 5-17)\", \"Percent (%) Eligible Free (Ages 5-17)\", \"FRPM Count (Ages 5-17)\", \"Percent (%) Eligible FRPM (Ages 5-17)\", \"2013-14 CALPADS Fall 1 Certification Status\" FROM \"frpm\") AS \"frpm\") [numPartitions=1] [CDSCode#34034,Enrollment (K-12)#34052,Enrollment (Ages 5-17)#34057] PushedFilters: [*IsNotNull(Enrollment (K-12)), *IsNotNull(Enrollment (Ages 5-17)), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,Enrollment (K-12):double,Enrollment (Ages 5-17):double>\n================================================================================"
    },
    "result_file_path": "/home/lars/Privat/RWTH/Auslandssemester/#KURSE/Safe Distributed Systems/Exercises/Practical_Exercise/NL2SQL2SPARK/RAW_RESULTS/benchmark_results_20260101_google_ce2b3070/28/20260101_125755_ID_28_ITER_3_6a9c44dd.json",
    "explainer_metrics": {
        "golden_query": {
            "shuffle_count": {
                "Exchange\\s+hashpartitioning\\(": 4,
                "Exchange\\s+rangepartitioning\\(": 0,
                "Exchange\\s+SinglePartition": 1,
                "ShuffleExchange": 0,
                "TOTAL": 5
            },
            "has_broadcast_join": false,
            "has_predicate_pushdown": true,
            "pushed_filters": [
                {
                    "scan_line": ":           :                       :     +- Scan JDBCRelation((SELECT \"CDSCode\", \"Academic Year\", \"County Code\", \"District Code\", \"School Code\", \"County Name\", \"District Name\", \"School Name\", \"District Type\", \"School Type\", \"Educational Option Type\", \"NSLP Provision Status\", \"Charter School (Y/N)\", \"Charter School Number\", \"Charter Funding Type\", \"IRC\", \"Low Grade\", \"High Grade\", \"Enrollment (K-12)\", \"Free Meal Count (K-12)\", \"Percent (%) Eligible Free (K-12)\", \"FRPM Count (K-12)\", \"Percent (%) Eligible FRPM (K-12)\", \"Enrollment (Ages 5-17)\", \"Free Meal Count (Ages 5-17)\", \"Percent (%) Eligible Free (Ages 5-17)\", \"FRPM Count (Ages 5-17)\", \"Percent (%) Eligible FRPM (Ages 5-17)\", \"2013-14 CALPADS Fall 1 Certification Status\" FROM \"frpm\") AS \"frpm\") [numPartitions=1] [CDSCode#34126,Enrollment (K-12)#34144,Enrollment (Ages 5-17)#34149] PushedFilters: [*IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,Enrollment (K-12):double,Enrollment (Ages 5-17):double>",
                    "filters": [
                        "*IsNotNull(CDSCode)"
                    ]
                },
                {
                    "scan_line": ":           :                             +- Scan JDBCRelation((SELECT \"CDSCode\", \"NCESDist\", \"NCESSchool\", \"StatusType\", \"County\", \"District\", \"School\", \"Street\", \"StreetAbr\", \"City\", \"Zip\", \"State\", \"MailStreet\", \"MailStrAbr\", \"MailCity\", \"MailZip\", \"MailState\", \"Phone\", \"Ext\", \"Website\", CAST(\"OpenDate\" AS TEXT) AS \"OpenDate\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"Charter\", \"CharterNum\", \"FundingType\", \"DOC\", \"DOCType\", \"SOC\", \"SOCType\", \"EdOpsCode\", \"EdOpsName\", \"EILCode\", \"EILName\", \"GSoffered\", \"GSserved\", \"Virtual\", \"Magnet\", \"Latitude\", \"Longitude\", \"AdmFName1\", \"AdmLName1\", \"AdmEmail1\", \"AdmFName2\", \"AdmLName2\", \"AdmEmail2\", \"AdmFName3\", \"AdmLName3\", \"AdmEmail3\", CAST(\"LastUpdate\" AS TEXT) AS \"LastUpdate\" FROM \"schools\") AS \"schools\") [numPartitions=1] [CDSCode#34155] PushedFilters: [*IsNotNull(FundingType), *EqualTo(FundingType,Locally funded), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string>",
                    "filters": [
                        "*IsNotNull(FundingType)",
                        "*EqualTo(FundingType",
                        "Locally funded)",
                        "*IsNotNull(CDSCode)"
                    ]
                },
                {
                    "scan_line": ":           +- Scan JDBCRelation((SELECT \"CDSCode\", \"Academic Year\", \"County Code\", \"District Code\", \"School Code\", \"County Name\", \"District Name\", \"School Name\", \"District Type\", \"School Type\", \"Educational Option Type\", \"NSLP Provision Status\", \"Charter School (Y/N)\", \"Charter School Number\", \"Charter Funding Type\", \"IRC\", \"Low Grade\", \"High Grade\", \"Enrollment (K-12)\", \"Free Meal Count (K-12)\", \"Percent (%) Eligible Free (K-12)\", \"FRPM Count (K-12)\", \"Percent (%) Eligible FRPM (K-12)\", \"Enrollment (Ages 5-17)\", \"Free Meal Count (Ages 5-17)\", \"Percent (%) Eligible Free (Ages 5-17)\", \"FRPM Count (Ages 5-17)\", \"Percent (%) Eligible FRPM (Ages 5-17)\", \"2013-14 CALPADS Fall 1 Certification Status\" FROM \"frpm\") AS \"frpm\") [numPartitions=1] [CDSCode#34034,Enrollment (K-12)#34052,Enrollment (Ages 5-17)#34057] PushedFilters: [*IsNotNull(Enrollment (K-12)), *IsNotNull(Enrollment (Ages 5-17)), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,Enrollment (K-12):double,Enrollment (Ages 5-17):double>",
                    "filters": [
                        "*IsNotNull(Enrollment (K-12))",
                        "*IsNotNull(Enrollment (Ages 5-17))",
                        "*IsNotNull(CDSCode)"
                    ]
                },
                {
                    "scan_line": "+- Scan JDBCRelation((SELECT \"CDSCode\", \"NCESDist\", \"NCESSchool\", \"StatusType\", \"County\", \"District\", \"School\", \"Street\", \"StreetAbr\", \"City\", \"Zip\", \"State\", \"MailStreet\", \"MailStrAbr\", \"MailCity\", \"MailZip\", \"MailState\", \"Phone\", \"Ext\", \"Website\", CAST(\"OpenDate\" AS TEXT) AS \"OpenDate\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"Charter\", \"CharterNum\", \"FundingType\", \"DOC\", \"DOCType\", \"SOC\", \"SOCType\", \"EdOpsCode\", \"EdOpsName\", \"EILCode\", \"EILName\", \"GSoffered\", \"GSserved\", \"Virtual\", \"Magnet\", \"Latitude\", \"Longitude\", \"AdmFName1\", \"AdmLName1\", \"AdmEmail1\", \"AdmFName2\", \"AdmLName2\", \"AdmEmail2\", \"AdmFName3\", \"AdmLName3\", \"AdmEmail3\", CAST(\"LastUpdate\" AS TEXT) AS \"LastUpdate\" FROM \"schools\") AS \"schools\") [numPartitions=1] [CDSCode#34074,School#34080,DOC#34099] PushedFilters: [*IsNotNull(FundingType), *EqualTo(FundingType,Locally funded), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,School:string,DOC:string>",
                    "filters": [
                        "*IsNotNull(FundingType)",
                        "*EqualTo(FundingType",
                        "Locally funded)",
                        "*IsNotNull(CDSCode)"
                    ]
                },
                {
                    "scan_line": ":           :                       :     +- Scan JDBCRelation((SELECT \"CDSCode\", \"Academic Year\", \"County Code\", \"District Code\", \"School Code\", \"County Name\", \"District Name\", \"School Name\", \"District Type\", \"School Type\", \"Educational Option Type\", \"NSLP Provision Status\", \"Charter School (Y/N)\", \"Charter School Number\", \"Charter Funding Type\", \"IRC\", \"Low Grade\", \"High Grade\", \"Enrollment (K-12)\", \"Free Meal Count (K-12)\", \"Percent (%) Eligible Free (K-12)\", \"FRPM Count (K-12)\", \"Percent (%) Eligible FRPM (K-12)\", \"Enrollment (Ages 5-17)\", \"Free Meal Count (Ages 5-17)\", \"Percent (%) Eligible Free (Ages 5-17)\", \"FRPM Count (Ages 5-17)\", \"Percent (%) Eligible FRPM (Ages 5-17)\", \"2013-14 CALPADS Fall 1 Certification Status\" FROM \"frpm\") AS \"frpm\") [numPartitions=1] [CDSCode#34215,Enrollment (K-12)#34233,Enrollment (Ages 5-17)#34238] PushedFilters: [*IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,Enrollment (K-12):double,Enrollment (Ages 5-17):double>",
                    "filters": [
                        "*IsNotNull(CDSCode)"
                    ]
                },
                {
                    "scan_line": ":           :                             +- Scan JDBCRelation((SELECT \"CDSCode\", \"NCESDist\", \"NCESSchool\", \"StatusType\", \"County\", \"District\", \"School\", \"Street\", \"StreetAbr\", \"City\", \"Zip\", \"State\", \"MailStreet\", \"MailStrAbr\", \"MailCity\", \"MailZip\", \"MailState\", \"Phone\", \"Ext\", \"Website\", CAST(\"OpenDate\" AS TEXT) AS \"OpenDate\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"Charter\", \"CharterNum\", \"FundingType\", \"DOC\", \"DOCType\", \"SOC\", \"SOCType\", \"EdOpsCode\", \"EdOpsName\", \"EILCode\", \"EILName\", \"GSoffered\", \"GSserved\", \"Virtual\", \"Magnet\", \"Latitude\", \"Longitude\", \"AdmFName1\", \"AdmLName1\", \"AdmEmail1\", \"AdmFName2\", \"AdmLName2\", \"AdmEmail2\", \"AdmFName3\", \"AdmLName3\", \"AdmEmail3\", CAST(\"LastUpdate\" AS TEXT) AS \"LastUpdate\" FROM \"schools\") AS \"schools\") [numPartitions=1] [CDSCode#34244] PushedFilters: [*IsNotNull(FundingType), *EqualTo(FundingType,Locally funded), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string>",
                    "filters": [
                        "*IsNotNull(FundingType)",
                        "*EqualTo(FundingType",
                        "Locally funded)",
                        "*IsNotNull(CDSCode)"
                    ]
                },
                {
                    "scan_line": ":           +- Scan JDBCRelation((SELECT \"CDSCode\", \"Academic Year\", \"County Code\", \"District Code\", \"School Code\", \"County Name\", \"District Name\", \"School Name\", \"District Type\", \"School Type\", \"Educational Option Type\", \"NSLP Provision Status\", \"Charter School (Y/N)\", \"Charter School Number\", \"Charter Funding Type\", \"IRC\", \"Low Grade\", \"High Grade\", \"Enrollment (K-12)\", \"Free Meal Count (K-12)\", \"Percent (%) Eligible Free (K-12)\", \"FRPM Count (K-12)\", \"Percent (%) Eligible FRPM (K-12)\", \"Enrollment (Ages 5-17)\", \"Free Meal Count (Ages 5-17)\", \"Percent (%) Eligible Free (Ages 5-17)\", \"FRPM Count (Ages 5-17)\", \"Percent (%) Eligible FRPM (Ages 5-17)\", \"2013-14 CALPADS Fall 1 Certification Status\" FROM \"frpm\") AS \"frpm\") [numPartitions=1] [CDSCode#34034,Enrollment (K-12)#34052,Enrollment (Ages 5-17)#34057] PushedFilters: [*IsNotNull(Enrollment (K-12)), *IsNotNull(Enrollment (Ages 5-17)), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,Enrollment (K-12):double,Enrollment (Ages 5-17):double>",
                    "filters": [
                        "*IsNotNull(Enrollment (K-12))",
                        "*IsNotNull(Enrollment (Ages 5-17))",
                        "*IsNotNull(CDSCode)"
                    ]
                },
                {
                    "scan_line": "+- Scan JDBCRelation((SELECT \"CDSCode\", \"NCESDist\", \"NCESSchool\", \"StatusType\", \"County\", \"District\", \"School\", \"Street\", \"StreetAbr\", \"City\", \"Zip\", \"State\", \"MailStreet\", \"MailStrAbr\", \"MailCity\", \"MailZip\", \"MailState\", \"Phone\", \"Ext\", \"Website\", CAST(\"OpenDate\" AS TEXT) AS \"OpenDate\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"Charter\", \"CharterNum\", \"FundingType\", \"DOC\", \"DOCType\", \"SOC\", \"SOCType\", \"EdOpsCode\", \"EdOpsName\", \"EILCode\", \"EILName\", \"GSoffered\", \"GSserved\", \"Virtual\", \"Magnet\", \"Latitude\", \"Longitude\", \"AdmFName1\", \"AdmLName1\", \"AdmEmail1\", \"AdmFName2\", \"AdmLName2\", \"AdmEmail2\", \"AdmFName3\", \"AdmLName3\", \"AdmEmail3\", CAST(\"LastUpdate\" AS TEXT) AS \"LastUpdate\" FROM \"schools\") AS \"schools\") [numPartitions=1] [CDSCode#34074,School#34080,DOC#34099] PushedFilters: [*IsNotNull(FundingType), *EqualTo(FundingType,Locally funded), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,School:string,DOC:string>",
                    "filters": [
                        "*IsNotNull(FundingType)",
                        "*EqualTo(FundingType",
                        "Locally funded)",
                        "*IsNotNull(CDSCode)"
                    ]
                }
            ],
            "filter_count_before_optimization": 0,
            "filter_count_after_optimization": 4
        },
        "model_query": {
            "shuffle_count": {
                "Exchange\\s+hashpartitioning\\(": 4,
                "Exchange\\s+rangepartitioning\\(": 1,
                "Exchange\\s+SinglePartition": 1,
                "ShuffleExchange": 0,
                "TOTAL": 6
            },
            "has_broadcast_join": false,
            "has_predicate_pushdown": true,
            "pushed_filters": [
                {
                    "scan_line": ":     +- Scan JDBCRelation((SELECT \"CDSCode\", \"NCESDist\", \"NCESSchool\", \"StatusType\", \"County\", \"District\", \"School\", \"Street\", \"StreetAbr\", \"City\", \"Zip\", \"State\", \"MailStreet\", \"MailStrAbr\", \"MailCity\", \"MailZip\", \"MailState\", \"Phone\", \"Ext\", \"Website\", CAST(\"OpenDate\" AS TEXT) AS \"OpenDate\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"Charter\", \"CharterNum\", \"FundingType\", \"DOC\", \"DOCType\", \"SOC\", \"SOCType\", \"EdOpsCode\", \"EdOpsName\", \"EILCode\", \"EILName\", \"GSoffered\", \"GSserved\", \"Virtual\", \"Magnet\", \"Latitude\", \"Longitude\", \"AdmFName1\", \"AdmLName1\", \"AdmEmail1\", \"AdmFName2\", \"AdmLName2\", \"AdmEmail2\", \"AdmFName3\", \"AdmLName3\", \"AdmEmail3\", CAST(\"LastUpdate\" AS TEXT) AS \"LastUpdate\" FROM \"schools\") AS \"schools\") [numPartitions=1] [CDSCode#34074,School#34080,DOCType#34100] PushedFilters: [*IsNotNull(FundingType), *EqualTo(FundingType,Local), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,School:string,DOCType:string>",
                    "filters": [
                        "*IsNotNull(FundingType)",
                        "*EqualTo(FundingType",
                        "Local)",
                        "*IsNotNull(CDSCode)"
                    ]
                },
                {
                    "scan_line": ":                       :     +- Scan JDBCRelation((SELECT \"CDSCode\", \"NCESDist\", \"NCESSchool\", \"StatusType\", \"County\", \"District\", \"School\", \"Street\", \"StreetAbr\", \"City\", \"Zip\", \"State\", \"MailStreet\", \"MailStrAbr\", \"MailCity\", \"MailZip\", \"MailState\", \"Phone\", \"Ext\", \"Website\", CAST(\"OpenDate\" AS TEXT) AS \"OpenDate\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"Charter\", \"CharterNum\", \"FundingType\", \"DOC\", \"DOCType\", \"SOC\", \"SOCType\", \"EdOpsCode\", \"EdOpsName\", \"EILCode\", \"EILName\", \"GSoffered\", \"GSserved\", \"Virtual\", \"Magnet\", \"Latitude\", \"Longitude\", \"AdmFName1\", \"AdmLName1\", \"AdmEmail1\", \"AdmFName2\", \"AdmLName2\", \"AdmEmail2\", \"AdmFName3\", \"AdmLName3\", \"AdmEmail3\", CAST(\"LastUpdate\" AS TEXT) AS \"LastUpdate\" FROM \"schools\") AS \"schools\") [numPartitions=1] [CDSCode#34300] PushedFilters: [*IsNotNull(FundingType), *EqualTo(FundingType,Local), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string>",
                    "filters": [
                        "*IsNotNull(FundingType)",
                        "*EqualTo(FundingType",
                        "Local)",
                        "*IsNotNull(CDSCode)"
                    ]
                },
                {
                    "scan_line": ":                             +- Scan JDBCRelation((SELECT \"CDSCode\", \"Academic Year\", \"County Code\", \"District Code\", \"School Code\", \"County Name\", \"District Name\", \"School Name\", \"District Type\", \"School Type\", \"Educational Option Type\", \"NSLP Provision Status\", \"Charter School (Y/N)\", \"Charter School Number\", \"Charter Funding Type\", \"IRC\", \"Low Grade\", \"High Grade\", \"Enrollment (K-12)\", \"Free Meal Count (K-12)\", \"Percent (%) Eligible Free (K-12)\", \"FRPM Count (K-12)\", \"Percent (%) Eligible FRPM (K-12)\", \"Enrollment (Ages 5-17)\", \"Free Meal Count (Ages 5-17)\", \"Percent (%) Eligible Free (Ages 5-17)\", \"FRPM Count (Ages 5-17)\", \"Percent (%) Eligible FRPM (Ages 5-17)\", \"2013-14 CALPADS Fall 1 Certification Status\" FROM \"frpm\") AS \"frpm\") [numPartitions=1] [CDSCode#34349,Enrollment (K-12)#34367,Enrollment (Ages 5-17)#34372] PushedFilters: [*IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,Enrollment (K-12):double,Enrollment (Ages 5-17):double>",
                    "filters": [
                        "*IsNotNull(CDSCode)"
                    ]
                },
                {
                    "scan_line": "+- Scan JDBCRelation((SELECT \"CDSCode\", \"Academic Year\", \"County Code\", \"District Code\", \"School Code\", \"County Name\", \"District Name\", \"School Name\", \"District Type\", \"School Type\", \"Educational Option Type\", \"NSLP Provision Status\", \"Charter School (Y/N)\", \"Charter School Number\", \"Charter Funding Type\", \"IRC\", \"Low Grade\", \"High Grade\", \"Enrollment (K-12)\", \"Free Meal Count (K-12)\", \"Percent (%) Eligible Free (K-12)\", \"FRPM Count (K-12)\", \"Percent (%) Eligible FRPM (K-12)\", \"Enrollment (Ages 5-17)\", \"Free Meal Count (Ages 5-17)\", \"Percent (%) Eligible Free (Ages 5-17)\", \"FRPM Count (Ages 5-17)\", \"Percent (%) Eligible FRPM (Ages 5-17)\", \"2013-14 CALPADS Fall 1 Certification Status\" FROM \"frpm\") AS \"frpm\") [numPartitions=1] [CDSCode#34034,Enrollment (K-12)#34052,Enrollment (Ages 5-17)#34057] PushedFilters: [*IsNotNull(Enrollment (K-12)), *IsNotNull(Enrollment (Ages 5-17)), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,Enrollment (K-12):double,Enrollment (Ages 5-17):double>",
                    "filters": [
                        "*IsNotNull(Enrollment (K-12))",
                        "*IsNotNull(Enrollment (Ages 5-17))",
                        "*IsNotNull(CDSCode)"
                    ]
                },
                {
                    "scan_line": ":     +- Scan JDBCRelation((SELECT \"CDSCode\", \"NCESDist\", \"NCESSchool\", \"StatusType\", \"County\", \"District\", \"School\", \"Street\", \"StreetAbr\", \"City\", \"Zip\", \"State\", \"MailStreet\", \"MailStrAbr\", \"MailCity\", \"MailZip\", \"MailState\", \"Phone\", \"Ext\", \"Website\", CAST(\"OpenDate\" AS TEXT) AS \"OpenDate\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"Charter\", \"CharterNum\", \"FundingType\", \"DOC\", \"DOCType\", \"SOC\", \"SOCType\", \"EdOpsCode\", \"EdOpsName\", \"EILCode\", \"EILName\", \"GSoffered\", \"GSserved\", \"Virtual\", \"Magnet\", \"Latitude\", \"Longitude\", \"AdmFName1\", \"AdmLName1\", \"AdmEmail1\", \"AdmFName2\", \"AdmLName2\", \"AdmEmail2\", \"AdmFName3\", \"AdmLName3\", \"AdmEmail3\", CAST(\"LastUpdate\" AS TEXT) AS \"LastUpdate\" FROM \"schools\") AS \"schools\") [numPartitions=1] [CDSCode#34074,School#34080,DOCType#34100] PushedFilters: [*IsNotNull(FundingType), *EqualTo(FundingType,Local), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,School:string,DOCType:string>",
                    "filters": [
                        "*IsNotNull(FundingType)",
                        "*EqualTo(FundingType",
                        "Local)",
                        "*IsNotNull(CDSCode)"
                    ]
                },
                {
                    "scan_line": ":                       :     +- Scan JDBCRelation((SELECT \"CDSCode\", \"NCESDist\", \"NCESSchool\", \"StatusType\", \"County\", \"District\", \"School\", \"Street\", \"StreetAbr\", \"City\", \"Zip\", \"State\", \"MailStreet\", \"MailStrAbr\", \"MailCity\", \"MailZip\", \"MailState\", \"Phone\", \"Ext\", \"Website\", CAST(\"OpenDate\" AS TEXT) AS \"OpenDate\", CAST(\"ClosedDate\" AS TEXT) AS \"ClosedDate\", \"Charter\", \"CharterNum\", \"FundingType\", \"DOC\", \"DOCType\", \"SOC\", \"SOCType\", \"EdOpsCode\", \"EdOpsName\", \"EILCode\", \"EILName\", \"GSoffered\", \"GSserved\", \"Virtual\", \"Magnet\", \"Latitude\", \"Longitude\", \"AdmFName1\", \"AdmLName1\", \"AdmEmail1\", \"AdmFName2\", \"AdmLName2\", \"AdmEmail2\", \"AdmFName3\", \"AdmLName3\", \"AdmEmail3\", CAST(\"LastUpdate\" AS TEXT) AS \"LastUpdate\" FROM \"schools\") AS \"schools\") [numPartitions=1] [CDSCode#34389] PushedFilters: [*IsNotNull(FundingType), *EqualTo(FundingType,Local), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string>",
                    "filters": [
                        "*IsNotNull(FundingType)",
                        "*EqualTo(FundingType",
                        "Local)",
                        "*IsNotNull(CDSCode)"
                    ]
                },
                {
                    "scan_line": ":                             +- Scan JDBCRelation((SELECT \"CDSCode\", \"Academic Year\", \"County Code\", \"District Code\", \"School Code\", \"County Name\", \"District Name\", \"School Name\", \"District Type\", \"School Type\", \"Educational Option Type\", \"NSLP Provision Status\", \"Charter School (Y/N)\", \"Charter School Number\", \"Charter Funding Type\", \"IRC\", \"Low Grade\", \"High Grade\", \"Enrollment (K-12)\", \"Free Meal Count (K-12)\", \"Percent (%) Eligible Free (K-12)\", \"FRPM Count (K-12)\", \"Percent (%) Eligible FRPM (K-12)\", \"Enrollment (Ages 5-17)\", \"Free Meal Count (Ages 5-17)\", \"Percent (%) Eligible Free (Ages 5-17)\", \"FRPM Count (Ages 5-17)\", \"Percent (%) Eligible FRPM (Ages 5-17)\", \"2013-14 CALPADS Fall 1 Certification Status\" FROM \"frpm\") AS \"frpm\") [numPartitions=1] [CDSCode#34438,Enrollment (K-12)#34456,Enrollment (Ages 5-17)#34461] PushedFilters: [*IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,Enrollment (K-12):double,Enrollment (Ages 5-17):double>",
                    "filters": [
                        "*IsNotNull(CDSCode)"
                    ]
                },
                {
                    "scan_line": "+- Scan JDBCRelation((SELECT \"CDSCode\", \"Academic Year\", \"County Code\", \"District Code\", \"School Code\", \"County Name\", \"District Name\", \"School Name\", \"District Type\", \"School Type\", \"Educational Option Type\", \"NSLP Provision Status\", \"Charter School (Y/N)\", \"Charter School Number\", \"Charter Funding Type\", \"IRC\", \"Low Grade\", \"High Grade\", \"Enrollment (K-12)\", \"Free Meal Count (K-12)\", \"Percent (%) Eligible Free (K-12)\", \"FRPM Count (K-12)\", \"Percent (%) Eligible FRPM (K-12)\", \"Enrollment (Ages 5-17)\", \"Free Meal Count (Ages 5-17)\", \"Percent (%) Eligible Free (Ages 5-17)\", \"FRPM Count (Ages 5-17)\", \"Percent (%) Eligible FRPM (Ages 5-17)\", \"2013-14 CALPADS Fall 1 Certification Status\" FROM \"frpm\") AS \"frpm\") [numPartitions=1] [CDSCode#34034,Enrollment (K-12)#34052,Enrollment (Ages 5-17)#34057] PushedFilters: [*IsNotNull(Enrollment (K-12)), *IsNotNull(Enrollment (Ages 5-17)), *IsNotNull(CDSCode)], ReadSchema: struct<CDSCode:string,Enrollment (K-12):double,Enrollment (Ages 5-17):double>",
                    "filters": [
                        "*IsNotNull(Enrollment (K-12))",
                        "*IsNotNull(Enrollment (Ages 5-17))",
                        "*IsNotNull(CDSCode)"
                    ]
                }
            ],
            "filter_count_before_optimization": 0,
            "filter_count_after_optimization": 4
        },
        "plan_equivalence": {
            "golden_vs_model_physical_equivalent": false
        }
    }
}